var UniqueID=function(){var id=0;return function(){return id++}}();var IsRealReference=function(obj){return function(){obj&&obj!=="null"&&obj!=="undefined"}}();function Lib(){}Lib.Rand=function(mod){return parseInt(Math.floor(Math.random()*mod))};Lib.radians=function(degrees){return degrees*Math.PI/180};Lib.degrees=function(radians){return radians*180/Math.PI};Lib.strReplace=function(str,search,replace){var str_split=str.split(search);var str_res=str_split.join(replace);return str_res};Lib.PadLeft=function(val,digits,pad){var ret=val.toString();return Lib.PadLeftString(ret,digits,pad)};Lib.PadLeftString=function(str,digits,pad){while(str.length<digits)str=pad+str;return str};Lib.ResetArray=function(arr,val){for(var i=0;i<arr.length;i++)arr[i]=val};var SObject_VERBOSE=false;var SObject=function(){this.ID=UniqueID();this.ServerData=null;this.ParseIndex=0;this.GPTimer=0};SObject.prototype.ArmaTimer=function(p_pTimer,p_MS){p_pTimer=p_MS;return p_pTimer};SObject.prototype.TimerDec=function(p_pTimer,p_ElapsedMS){if(p_pTimer>=p_ElapsedMS)p_pTimer-=p_ElapsedMS;else p_pTimer=0;return p_pTimer};SObject.prototype.TimerRefresh=function(p_ElapsedMS){this.GPTimer=this.TimerDec(this.GPTimer,p_ElapsedMS)};SObject.prototype.DeviceSteps=function(parm){return parseInt(parm/window.CPU_BENCH)};SObject.prototype.DeviceRotation=function(parm){return parm*window.CPU_BENCH};SObject.prototype.DeviceInc=function(parm){return parm*window.CPU_BENCH};SObject.prototype.DeviceEllapsedTime=function(parm){return parm/window.CPU_BENCH};SObject.prototype.ParseServer_Init=function(chunk_to_parse){this.ParseIndex=1;this.ServerData=chunk_to_parse.split(",");if(this.ServerData.length==0)return false;return true};SObject.prototype.ParseServer_EOF=function(){if(this.ParseIndex>=this.ServerData.length)return true;return false};SObject.prototype.ParseServer_SEEK=function(p_abs_Offset){if(p_abs_Offset>=this.ServerData.length)return false;this.ParseIndex=p_abs_Offset;return true};SObject.prototype.ParseServer_Dump_UINT=function(p_abs_Offset){var dump;if(p_abs_Offset==-1)dump=parseInt(this.ServerData[this.ParseIndex++]);else dump=parseInt(this.ServerData[p_abs_Offset]);return dump};SObject.prototype.ParseServer_Dump_STRING=function(p_abs_Offset){var dump_str;if(p_abs_Offset==-1)dump_str=this.ServerData[this.ParseIndex++];else dump_str=this.ServerData[p_abs_Offset];return dump_str};SObject.prototype.ASSERT=function(p_Assertion,p_pTrace){if(p_Assertion==false){console.log("ASSERTION fail "+this.ID);if(p_pTrace!=null){console.log(p_pTrace)}}};SObject.prototype.DEBUG_LOG=function(p_Log){if(SObject_VERBOSE==true)console.log(p_Log)};SoundGenerator.ENABLED=true;SoundGenerator.MAX_CHANNELS=20;SoundGenerator.MAX_BRANI=200;SoundGenerator.SMP_SAMPLE=0;SoundGenerator.SMP_MUSIC=1;SoundGenerator.SMP_LOOP=2;SoundGenerator.SMP_VOLUME_NORMAL=4;SoundGenerator.SMP_VOLUME_AMPLIFY=8;SoundGenerator.SMP_VOLUME_REDUCE=16;SoundGenerator.SMP_VOLUME_SUPER_REDUCE=32;SoundGenerator.SMP_VOLUME_MINIMAL_REDUCE=64;SoundGenerator.SMP_VOLUME_ZERO=128;SoundGenerator.SMP_PAUSE=256;SoundGenerator.SMP_PAUSE_MUTE=512;SoundGenerator.SMP_VOLUME_SUPER_AMPLIFY=1024;SoundGenerator.CLICK0=0;SoundGenerator.CLICK1=1;SoundGenerator.CLICK2=2;SoundGenerator.SPIN=3;SoundGenerator.BET=4;SoundGenerator.BET_LINES=5;SoundGenerator.MAX_BET=6;SoundGenerator.GAME_LOOP=7;SoundGenerator.INTRO=8;SoundGenerator.FREESPIN_LOOP=9;SoundGenerator.STOP_REEL=10;SoundGenerator.STOP_ALL_REELS=11;SoundGenerator.BIG_WIN=12;SoundGenerator.WIN_LO=13;SoundGenerator.WIN_MID=14;SoundGenerator.WIN_HI=15;SoundGenerator.WIN_SCATTER=16;SoundGenerator.WIN_BONUS=17;SoundGenerator.TURBO_BGND=18;SoundGenerator.SCATTER_1=19;SoundGenerator.SCATTER_2=20;SoundGenerator.SCATTER_3=21;SoundGenerator.WIN_LINE=22;SoundGenerator.CONGRATULATION=23;SoundGenerator.BONUS_JP=24;SoundGenerator.BONUS_LOOP=25;SoundGenerator.BONUS_PRIZE_OPEN=26;SoundGenerator.BONUS_PRIZE_GOOD=27;SoundGenerator.BONUS_PRIZE_BAD=28;SoundGenerator.BONUS_PRIZE_UP=29;SoundGenerator.LONG_WILD=30;SoundGenerator.WILD_EXPAND=31;SoundGenerator.MAGIC_INTRO=32;SoundGenerator.MAGIC_SELECTION=33;SoundGenerator.MAGIC_SYMBOL=34;var SoundGenerator_unlockSnd=null;function SoundGenerator(){SObject.call(this);this.ChannelsPlaying=new Array(SoundGenerator.MAX_CHANNELS);this.SamplesDB=new Array;this.SamplesPlaying=new Array(SoundGenerator.MAX_CHANNELS);this.FlagsPlaying=new Array(SoundGenerator.MAX_CHANNELS);this.IDPlaying=new Array(SoundGenerator.MAX_CHANNELS);this.PausedPositions=new Array(SoundGenerator.MAX_BRANI);this.PausedFlags=new Array(SoundGenerator.MAX_BRANI);this.AudioEnabled=false;this.SET_PlayMusic=1;this.SET_PlayFX=1;this.SET_Volume=100;this.FlagsPlaying.fill(0);this.PausedPositions.fill(0);this.PausedFlags.fill(0);for(var i=0;i<SoundGenerator.MAX_CHANNELS;i++){this.SamplesPlaying[i]=65535;this.ChannelsPlaying[i]=null;this.IDPlaying[i]=0}this.Initialized=false;this.startingIndex=1}SoundGenerator.prototype=Object.create(SObject.prototype);SoundGenerator.prototype.constructor=SoundGenerator;SoundGenerator.prototype.Init=function(){};function touchUnlock(){if(SoundGenerator_unlockSnd!=null)SoundGenerator_unlockSnd.play()}SoundGenerator.prototype.PlayBrano=function(p_Brano,p_Flags,gameLoop=false){var channel;var volume;var start_position=0;var finally_play=true;if(SoundGenerator.ENABLED==false)return;if(this.SamplesDB[p_Brano]==null)return;if(this.Initialized==false)return;this.Refresh();var empty_channel=gameLoop?0:this.GetEmptyChannel();if(this.AudioEnabled==false)p_Flags|=SoundGenerator.SMP_VOLUME_ZERO;if(empty_channel<SoundGenerator.MAX_CHANNELS){channel=this.SamplesDB[p_Brano];if(channel!=null){if((p_Flags&SoundGenerator.SMP_VOLUME_ZERO)!=0)volume=0;else if((p_Flags&SoundGenerator.SMP_VOLUME_NORMAL)!=0)volume=.5;else if((p_Flags&SoundGenerator.SMP_VOLUME_REDUCE)!=0)volume=.3;else if((p_Flags&SoundGenerator.SMP_VOLUME_MINIMAL_REDUCE)!=0)volume=.4;else if((p_Flags&SoundGenerator.SMP_VOLUME_SUPER_REDUCE)!=0)volume=.15;else if((p_Flags&SoundGenerator.SMP_VOLUME_AMPLIFY)!=0)volume=.8;else volume=.5;volume=volume*this.SET_Volume;channel.volume(volume/100);if((p_Flags&SoundGenerator.SMP_PAUSE)!=0){p_Flags&=~SoundGenerator.SMP_PAUSE;start_position=this.PausedPositions[p_Brano]}if((p_Flags&SoundGenerator.SMP_LOOP)!=0&&this.SET_PlayMusic==0)finally_play=false;if((p_Flags&SoundGenerator.SMP_LOOP)==0&&this.SET_PlayFX==0)finally_play=false;if(finally_play==true){if((p_Flags&SoundGenerator.SMP_LOOP)!=0)channel.loop(true);else channel.loop(false);this.IDPlaying[empty_channel]=channel.play();this.SamplesPlaying[empty_channel]=p_Brano;this.ChannelsPlaying[empty_channel]=channel;this.FlagsPlaying[empty_channel]=p_Flags}}}};SoundGenerator.prototype.UpdateVolume=function(){Howler.volume(this.SET_Volume/100)};SoundGenerator.prototype.ToggleMute=function(){var i,FLAGS,BRANO;if(this.Initialized==false){this.CreateDB();SoundGenerator_unlockSnd=new Howl({src:["resources/Audio/Sound_Click0.mp3"]});this.Initialized=true}this.Stop();this.AudioEnabled=!this.AudioEnabled;this.Refresh()};SoundGenerator.prototype.IsPlaying=function(p_Brano){for(var i=0;i<SoundGenerator.MAX_CHANNELS;i++){if(this.SamplesPlaying[i]==p_Brano){return true}}return false};SoundGenerator.prototype.StopChannel=function(p_Brano){var id_brano=this.SamplesPlaying[p_Brano];this.PausedPositions[id_brano]=0;this.PausedFlags[id_brano]=0;this.FlagsPlaying[p_Brano]=0;this.SamplesPlaying[p_Brano]=65535;if(this.Initialized==true){this.ChannelsPlaying[p_Brano].stop(this.IDPlaying[p_Brano])}};SoundGenerator.prototype.GetChannelIdx=function(id_brano){for(var i=0;i<SoundGenerator.MAX_CHANNELS;i++){if(this.SamplesPlaying[i]==id_brano){break}}return i};SoundGenerator.prototype.IsPaused=function(id_brano){if((this.PausedFlags[id_brano]&SoundGenerator.SMP_PAUSE)!=0)return true;return false};SoundGenerator.prototype.Pause=function(id_brano){var flags=0;var position=0;var channel_idx=this.GetChannelIdx(id_brano);if(channel_idx<SoundGenerator.MAX_CHANNELS){position=this.ChannelsPlaying[channel_idx].position;flags=SoundGenerator.SMP_PAUSE|this.FlagsPlaying[channel_idx];this.StopChannelByBrano(id_brano);this.PausedPositions[id_brano]=position;this.PausedFlags[id_brano]=SoundGenerator.SMP_PAUSE|flags}};SoundGenerator.prototype.Resume=function(id_brano,new_flags){if(new_flags!=0)this.PausedFlags[id_brano]=SoundGenerator.SMP_PAUSE|new_flags;this.PlayBrano(id_brano,this.PausedFlags[id_brano]);this.PausedFlags[id_brano]&=~SoundGenerator.SMP_PAUSE};SoundGenerator.prototype.Stop=function(){for(var i=0;i<SoundGenerator.MAX_CHANNELS;i++){if(this.SamplesPlaying[i]!=65535){this.StopChannel(i)}}};SoundGenerator.prototype.Refresh=function(){var i,FLAGS,BRANO;for(i=this.startingIndex;i<SoundGenerator.MAX_CHANNELS;i++){if(this.SamplesPlaying[i]!=65535){if(this.ChannelsPlaying[i].playing(this.IDPlaying[i])==false){this.StopChannel(i)}}}for(i=0;i<this.SamplesDB.length;i++){if((this.PausedFlags[i]&SoundGenerator.SMP_VOLUME_ZERO)!=0){this.PausedFlags[i]&=~SoundGenerator.SMP_VOLUME_ZERO;FLAGS=this.PausedFlags[i];this.Resume(i,FLAGS)}}};SoundGenerator.prototype.StopChannelByBrano=function(p_Brano){for(var i=0;i<SoundGenerator.MAX_CHANNELS;i++){if(this.SamplesPlaying[i]==p_Brano){this.StopChannel(i)}}};SoundGenerator.prototype.GetEmptyChannel=function(){let i=this.startingIndex;for(i=this.startingIndex;i<SoundGenerator.MAX_CHANNELS;++i)if(this.SamplesPlaying[i]==65535)break;return i};SoundGenerator.prototype.CreateDB=function(){this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Click0.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Click1.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Click0.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_spin_start.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Bet.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Bet.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_MaxBet.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_bonus_choice.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Intro.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_free_spins.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_spin_stop.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_StopAllReels.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_BigWin.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_symb_win2.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_symb_win2.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_symb_win2.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_symb_freespins.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_symb_choice.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_TurboBGND.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Scatter1.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Scatter2.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Scatter3.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_card_flip.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_congratulation.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Bonus_RunaLast.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_bonus_choice.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_totem_destroy.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Bonus_RunaWin.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Bonus_RunaLose.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_Bonus_RunaSelect.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_extrawild.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_extra_wild.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_bonus_sel.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/Sound_MagicSelection.mp3"]}));this.SamplesDB.push(new Howl({src:["resources/Audio/snd_card_win.mp3"]}))};function des(key,message,encrypt,mode,iv,padding){var spfunction1=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756);var spfunction2=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344);var spfunction3=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584);var spfunction4=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928);var spfunction5=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080);var spfunction6=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312);var spfunction7=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154);var spfunction8=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696);var keys=des_createKeys(key);var m=0,i,j,temp,temp2,right1,right2,left,right,looping;var cbcleft,cbcleft2,cbcright,cbcright2;var endloop,loopinc;var len=message.length;var chunk=0;var iterations=keys.length==32?3:9;if(iterations==3){looping=encrypt?new Array(0,32,2):new Array(30,-2,-2)}else{looping=encrypt?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2)}if(padding==2)message+="        ";else if(padding==1){temp=8-len%8;message+=String.fromCharCode(temp,temp,temp,temp,temp,temp,temp,temp);if(temp==8)len+=8}else if(!padding)message+="\0\0\0\0\0\0\0\0";result="";tempresult="";if(mode==1){cbcleft=iv.charCodeAt(m++)<<24|iv.charCodeAt(m++)<<16|iv.charCodeAt(m++)<<8|iv.charCodeAt(m++);cbcright=iv.charCodeAt(m++)<<24|iv.charCodeAt(m++)<<16|iv.charCodeAt(m++)<<8|iv.charCodeAt(m++);m=0}while(m<len){left=message.charCodeAt(m++)<<24|message.charCodeAt(m++)<<16|message.charCodeAt(m++)<<8|message.charCodeAt(m++);right=message.charCodeAt(m++)<<24|message.charCodeAt(m++)<<16|message.charCodeAt(m++)<<8|message.charCodeAt(m++);if(mode==1){if(encrypt){left^=cbcleft;right^=cbcright}else{cbcleft2=cbcleft;cbcright2=cbcright;cbcleft=left;cbcright=right}}temp=(left>>>4^right)&252645135;right^=temp;left^=temp<<4;temp=(left>>>16^right)&65535;right^=temp;left^=temp<<16;temp=(right>>>2^left)&858993459;left^=temp;right^=temp<<2;temp=(right>>>8^left)&16711935;left^=temp;right^=temp<<8;temp=(left>>>1^right)&1431655765;right^=temp;left^=temp<<1;left=left<<1|left>>>31;right=right<<1|right>>>31;for(j=0;j<iterations;j+=3){endloop=looping[j+1];loopinc=looping[j+2];for(i=looping[j];i!=endloop;i+=loopinc){right1=right^keys[i];right2=(right>>>4|right<<28)^keys[i+1];temp=left;left=right;right=temp^(spfunction2[right1>>>24&63]|spfunction4[right1>>>16&63]|spfunction6[right1>>>8&63]|spfunction8[right1&63]|spfunction1[right2>>>24&63]|spfunction3[right2>>>16&63]|spfunction5[right2>>>8&63]|spfunction7[right2&63])}temp=left;left=right;right=temp}left=left>>>1|left<<31;right=right>>>1|right<<31;temp=(left>>>1^right)&1431655765;right^=temp;left^=temp<<1;temp=(right>>>8^left)&16711935;left^=temp;right^=temp<<8;temp=(right>>>2^left)&858993459;left^=temp;right^=temp<<2;temp=(left>>>16^right)&65535;right^=temp;left^=temp<<16;temp=(left>>>4^right)&252645135;right^=temp;left^=temp<<4;if(mode==1){if(encrypt){cbcleft=left;cbcright=right}else{left^=cbcleft2;right^=cbcright2}}tempresult+=String.fromCharCode(left>>>24,left>>>16&255,left>>>8&255,left&255,right>>>24,right>>>16&255,right>>>8&255,right&255);chunk+=8;if(chunk==512){result+=tempresult;tempresult="";chunk=0}}return result+tempresult}function des_createKeys(key){pc2bytes0=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964);pc2bytes1=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697);pc2bytes2=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272);pc2bytes3=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144);pc2bytes4=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256);pc2bytes5=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488);pc2bytes6=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746);pc2bytes7=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568);pc2bytes8=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578);pc2bytes9=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488);pc2bytes10=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800);pc2bytes11=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744);pc2bytes12=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128);pc2bytes13=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261);var iterations=key.length>8?3:1;var keys=new Array(32*iterations);var shifts=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0);var lefttemp,righttemp,m=0,n=0,temp;for(var j=0;j<iterations;j++){left=key.charCodeAt(m++)<<24|key.charCodeAt(m++)<<16|key.charCodeAt(m++)<<8|key.charCodeAt(m++);right=key.charCodeAt(m++)<<24|key.charCodeAt(m++)<<16|key.charCodeAt(m++)<<8|key.charCodeAt(m++);temp=(left>>>4^right)&252645135;right^=temp;left^=temp<<4;temp=(right>>>-16^left)&65535;left^=temp;right^=temp<<-16;temp=(left>>>2^right)&858993459;right^=temp;left^=temp<<2;temp=(right>>>-16^left)&65535;left^=temp;right^=temp<<-16;temp=(left>>>1^right)&1431655765;right^=temp;left^=temp<<1;temp=(right>>>8^left)&16711935;left^=temp;right^=temp<<8;temp=(left>>>1^right)&1431655765;right^=temp;left^=temp<<1;temp=left<<8|right>>>20&240;left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240;right=temp;for(var i=0;i<shifts.length;i++){if(shifts[i]){left=left<<2|left>>>26;right=right<<2|right>>>26}else{left=left<<1|left>>>27;right=right<<1|right>>>27}left&=-15;right&=-15;lefttemp=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15];righttemp=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15];temp=(righttemp>>>16^lefttemp)&65535;keys[n++]=lefttemp^temp;keys[n++]=righttemp^temp<<16}}return keys}function stringToHex(s){var r="";var hexes=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");for(var i=0;i<s.length;i++){r+=hexes[s.charCodeAt(i)>>4]+hexes[s.charCodeAt(i)&15]}return r}function hexToString(h){var r="";for(var i=h.substr(0,2)=="0x"?2:0;i<h.length;i+=2){r+=String.fromCharCode(parseInt(h.substr(i,2),16))}return r}function trimNull(a){var c=a.indexOf("\0");if(c>-1){return a.substr(0,c)}return a}var DES_key=null;DEFAULT_KEY="6721zO71bSAXIU3S4NBQeb1a";function toUTF8Array(str){var utf8=[];for(var i=0;i<str.length;i++){var charcode=str.charCodeAt(i);if(charcode<128)utf8.push(charcode);else if(charcode<2048){utf8.push(192|charcode>>6,128|charcode&63)}else if(charcode<55296||charcode>=57344){utf8.push(224|charcode>>12,128|charcode>>6&63,128|charcode&63)}else{i++;charcode=(charcode&1023)<<10|str.charCodeAt(i)&1023;utf8.push(240|charcode>>18,128|charcode>>12&63,128|charcode>>6&63,128|charcode&63)}}return utf8}function DES_UpdateKey(new_key){DES_key=new_key}function DES_Encrypt(plain){var ciphertext3;if(window.ENCRYPTION==true){DES_key=DEFAULT_KEY;var ciphertext=des(DES_key,plain,1,0,null,0);var ciphertext2=stringToHex(ciphertext);ciphertext3=ciphertext2.toUpperCase()}else ciphertext3=plain;return ciphertext3}function DES_Decrypt(encrypted){var deciphertext;if(window.ENCRYPTION==true){DES_key=DEFAULT_KEY;var ciphertext=hexToString(encrypted);deciphertext=des(DES_key,ciphertext,0,0,null,0);deciphertext=trimNull(deciphertext)}else deciphertext=encrypted;return deciphertext}function DES_EncryptSignature(ip_address,ip_port,session_id){var plain_message=session_id+";"+ip_address+";"+ip_port;var enc=DES_Encrypt(plain_message);console.log("DES Test: "+enc);return enc}var DES_Signature_IP=null;var DES_Signature_PORT=null;var DES_Signature_SESSION=null;function DES_DecryptSignature(signature){var dec;if(window.SIGNATURE_ENCRYPTION==true){var keyHex=CryptoJS.enc.Utf8.parse(DEFAULT_KEY);var decrypted=CryptoJS.DES.decrypt({ciphertext:CryptoJS.enc.Base64.parse(signature)},keyHex,{mode:CryptoJS.mode.ECB});dec=decrypted.toString(CryptoJS.enc.Utf8)}else dec=signature;var spl=dec.split(";");DES_Signature_SESSION=spl[0];DES_Signature_PORT=spl[1];DES_Signature_IP=spl[2]}function DES_SelfCheck(){var plain_message="InitGame,123456;\n";var enc=DES_Encrypt(plain_message);console.log("DES Test: "+enc);var dec=DES_Decrypt(enc);console.log("DES Test: "+dec);plain_message="PlayStatus,123456;\n";enc=DES_Encrypt(plain_message);console.log("DES Test: "+enc);dec=DES_Decrypt(enc);console.log("DES Test: "+dec);enc=DES_Encrypt(plain_message);console.log("DES Test: "+enc);dec=DES_Decrypt(enc);console.log("DES Test: "+dec)}GameProxyMessage.MSG_OFFSET_TYPE=0;GameProxyMessage.MSG_TYPE_STATIC=0;GameProxyMessage.MSG_TYPE_SCROLL=1;GameProxyMessage.MSG_TYPE_EXTERN=2;GameProxyMessage.MSG_TYPE_CONFIG=3;GameProxyMessage.MSG_OFFSET_SUBTYPE=1;GameProxyMessage.MSG_SUBTYPE_DC=0;GameProxyMessage.MSG_SUBTYPE_BLOCK=1;GameProxyMessage.MSG_SUBTYPE_MODAL=2;GameProxyMessage.MSG_SUBTYPE_QUEUE=4;GameProxyMessage.MSG_SUBTYPE_CFG_ONSPIN=100;GameProxyMessage.MSG_SUBTYPE_CFG_VALUTA=101;GameProxyMessage.MSG_SUBTYPE_CFG_VALUTA_AUX1=102;GameProxyMessage.MSG_SUBTYPE_CFG_VALUTA_AUX2=103;GameProxyMessage.MSG_SUBTYPE_CFG_VALUTA_AUX3=104;GameProxyMessage.MSG_SUBTYPE_CFG_VALUTA_AUX4=105;GameProxyMessage.MSG_SUBTYPE_CFG_CREDITO=106;GameProxyMessage.MSG_SUBTYPE_CFG_CONTO=107;GameProxyMessage.MSG_SUBTYPE_CFG_EXIT_YN=108;GameProxyMessage.MSG_SUBTYPE_CFG_YES=109;GameProxyMessage.MSG_SUBTYPE_CFG_NO=110;GameProxyMessage.MSG_SUBTYPE_CFG_OK=111;GameProxyMessage.MSG_SUBTYPE_CFG_CANCEL=112;GameProxyMessage.MSG_SUBTYPE_CFG_FREESPINS=113;GameProxyMessage.MSG_SUBTYPE_CFG_AUTOSPINS=114;GameProxyMessage.MSG_SUBTYPE_CFG_PORTRAIT=115;GameProxyMessage.MSG_OFFSET_TEXT=2;function GameProxyMessage(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.IncomingMessage=null;this.OnSpin_String="";this.Credito_String="";this.Valuta_String="";this.Conto_String=null;this.OnExit_String=null;this.YES_String=null;this.NO_String=null;this.OK_String="OK";this.CANCEL_String="ANNULLA";this.ON_FREESPINS_String="FREE SPINS LEFT: ";this.ON_AUTOSPINS_String="AUTO SPINS: ";this.ON_PORTRAIT_String="Gira il tuo dispositivo!"}GameProxyMessage.prototype=Object.create(SObject.prototype);GameProxyMessage.prototype.constructor=GameProxyMessage;GameProxyMessage.prototype.ON_SPIN_MESSAGE=function(){return this.OnSpin_String};GameProxyMessage.prototype.ON_FREESPIN_MESSAGE=function(){return this.ON_FREESPINS_String};GameProxyMessage.prototype.ON_AUTOSPIN_MESSAGE=function(){return this.ON_AUTOSPINS_String};GameProxyMessage.prototype.ON_PORTRAIT_MESSAGE=function(){return this.ON_PORTRAIT_String};GameProxyMessage.prototype.CREDITO_STRING=function(){return this.Credito_String};GameProxyMessage.prototype.CONTO_STRING=function(){return this.Conto_String};GameProxyMessage.prototype.VALUTA_STRING=function(){return this.Valuta_String};GameProxyMessage.prototype.ON_EXIT_MESSAGE=function(){return this.OnExit_String};GameProxyMessage.prototype.YES_MESSAGE=function(){return this.YES_String};GameProxyMessage.prototype.NO_MESSAGE=function(){return this.NO_String};GameProxyMessage.prototype.OK_MESSAGE=function(){return this.OK_String};GameProxyMessage.prototype.CANCEL_MESSAGE=function(){return this.CANCEL_String};GameProxyMessage.prototype.Parse_SERVER_MESSAGE=function(chunk_to_parse){var esito=true;var type=0;var sub_type=0;esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){type=this.ParseServer_Dump_UINT(-1);sub_type=this.ParseServer_Dump_UINT(-1);this.IncomingMessage=this.ParseServer_Dump_STRING(-1);this.IncomingMessage=Lib.strReplace(this.IncomingMessage,"|",",");this.IncomingMessage=Lib.strReplace(this.IncomingMessage,"-","\n");if(type==GameProxyMessage.MSG_TYPE_STATIC)this.ApplicationRef.SLOT().CONSOLE().SetStaticDisplay(this.IncomingMessage,(sub_type&GameProxyMessage.MSG_SUBTYPE_QUEUE)!=0);else if(type==GameProxyMessage.MSG_TYPE_EXTERN)this.ApplicationRef.PROGRAMMA().GetALLARMI().AddAllarmeServer(this.IncomingMessage,(sub_type&GameProxyMessage.MSG_SUBTYPE_MODAL)!=0);else if(type==GameProxyMessage.MSG_TYPE_CONFIG){switch(sub_type){case GameProxyMessage.MSG_SUBTYPE_CFG_ONSPIN:{this.OnSpin_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_CREDITO:{this.Credito_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_CONTO:{this.Conto_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_VALUTA:{this.Valuta_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_EXIT_YN:{this.OnExit_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_YES:{this.YES_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_NO:{this.NO_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_OK:{this.OK_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_CANCEL:{this.CANCEL_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_FREESPINS:{this.ON_FREESPINS_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_AUTOSPINS:{this.ON_AUTOSPINS_String=this.IncomingMessage}break;case GameProxyMessage.MSG_SUBTYPE_CFG_PORTRAIT:{this.ON_PORTRAIT_String=this.IncomingMessage}break;default:break}}}return true};function GameProxyData(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.ProxyMessage=new GameProxyMessage(app_reference);this.PICK_BONUS=0;this.USER_SETTING_ID=0;this.USER_SETTING_VALUE=0;this.ID_BONUS=0;this.ACTION_BONUS=0;this.PARSER_ERROR_Description="";this.PARSED_DATA=null;this.ReelsSplash=true}GameProxyData.prototype=Object.create(SObject.prototype);GameProxyData.prototype.constructor=GameProxyData;GameProxyData.prototype.Init=function(){};GameProxyData.prototype.Reset=function(){this.ID_BONUS=0;this.ACTION_BONUS=0;this.PARSER_ERROR_Description=""};GameProxyData.prototype.CheckConnectionParms=function(){if(DES_Signature_SESSION==null)return false;if(DES_Signature_IP==null)return false;if(DES_Signature_PORT==null)return false;return true};GameProxyData.prototype.ParseIncomingData=function(datastring){if(datastring==null){this.PARSER_ERROR_Description="Incoming data null";return false}var pure_data=datastring.split(/\n/);if(pure_data==null){this.PARSER_ERROR_Description="Split newline data null";return false}this.PARSED_DATA=pure_data[0].split(";");if(this.PARSED_DATA==null){this.PARSER_ERROR_Description="Split dot-comma data null";return false}return this.ParseChunks()};GameProxyData.prototype.ParseChunks=function(){var ok=true;var i=0;while(i<this.PARSED_DATA.length-1){ok=this.ParseChunk(this.PARSED_DATA[i++]);if(ok==false)break}return ok};GameProxyData.prototype.ParseChunk=function(chunk){var chunk_parms=null;var esito=false;chunk_parms=chunk.split(",");if(chunk_parms==null)return false;if(chunk_parms.length==0)return false;if(chunk_parms[0].indexOf("\n")!=-1)return true;if(chunk_parms[0]=="PS")esito=this.ApplicationRef.PLAYER().Parse_PLAYER_STATUS(chunk);else if(chunk_parms[0]=="CS")esito=this.Parse_CONFIG_STATUS(chunk);else if(chunk_parms[0]=="CVT")esito=this.ApplicationRef.PLAYER().Parse_COIN_VALUES(chunk);else if(chunk_parms[0]=="RS"){esito=this.ApplicationRef.SLOT().Parse_REEL_STATUS(chunk);if(this.ReelsSplash==true)this.ApplicationRef.SLOT().REEL_HOLDER().Splash();this.ReelsSplash=false}else if(chunk_parms[0]=="BS")esito=this.ApplicationRef.SLOT().Parse_BONUS_STATUS(chunk);else if(chunk_parms[0]=="PT"){esito=this.ApplicationRef.SLOT().SLOT_COMBO().Parse_PAY_TABLE(chunk)
}else if(chunk_parms[0]=="WP")esito=this.ApplicationRef.SLOT().SLOT_COMBO().Parse_WIN_PATTERN(chunk);else if(chunk_parms[0]=="MSG")esito=this.ProxyMessage.Parse_SERVER_MESSAGE(chunk);else if(chunk_parms[0]=="KEY")esito=this.Parse_AES_KEY(chunk);else if(chunk_parms[0]=="CAR")esito=this.Parse_CARATTERIZZAZIONE(chunk);else if(chunk_parms[0]=="LOGOUT")esito=this.ApplicationRef.PROGRAMMA().Parse_SERVER_LOGOUT(chunk);else esito=false;return esito};GameProxyData.prototype.Parse_CONFIG_STATUS=function(chunk_to_parse){var esito=false;var type=0;esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){type=this.ParseServer_Dump_UINT(-1);switch(type){case StateCashBox.CMD_VERSAMENTO_CASSA:{esito=this.ApplicationRef.PROGRAMMA().GetVERSAMENTO_CASSA().Parse_Status(chunk_to_parse)}break;default:{esito=false}break}}return esito};GameProxyData.prototype.Parse_AES_KEY=function(chunk_to_parse){var esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){var STRING_KEY=this.ParseServer_Dump_STRING(-1);if(STRING_KEY==null)esito=false;else DES_UpdateKey(STRING_KEY)}return esito};GameProxyData.prototype.Parse_CARATTERIZZAZIONE=function(chunk_to_parse){var esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){window.DEMO_PLAY=this.ParseServer_Dump_UINT(-1);window.LANG=this.ParseServer_Dump_UINT(-1)}return esito};GameProxyData.prototype.GET_MESSAGES=function(){return this.ProxyMessage};function GameProxySocket(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.Socket=null;this.Connected=false;this.Closing=false;this.ReplyReceived=false}GameProxySocket.prototype=Object.create(SObject.prototype);GameProxySocket.prototype.constructor=GameProxySocket;GameProxySocket.prototype.Close_Connection=function(){if(this.Connected==true){this.Closing=true}};GameProxySocket.prototype.Setup_Connection=function(){var url="wss://"+window.SERVER_URL+":"+window.SERVER_PORT;this.Socket=new WebSocket(url);this.Socket.onopen=this.onOpenCallback.bind(this);this.Socket.onmessage=this.onMessageCallback.bind(this);this.Socket.onclose=this.onCloseCallback.bind(this);this.Socket.onerror=this.onErrorCallback.bind(this)};GameProxySocket.prototype.onMessageCallback=function(event){this.ServerReply=event.data;this.ReplyReceived=true};GameProxySocket.prototype.onOpenCallback=function(event){this.Connected=true};GameProxySocket.prototype.onCloseCallback=function(event){this.Connected=false;if(this.Closing==false)this.Goto_Error(StateAlarm.ID_ALARM_SERVER_CLOSE_COMM);else this.Goto_Error(StateAlarm.ID_ALARM_SESSION_CLOSED)};GameProxySocket.prototype.onErrorCallback=function(event){this.Connected=false;this.Goto_Error(StateAlarm.ID_ALARM_COMM_ERROR)};GameProxySocket.prototype.SendService=function(srvc){this.DEBUG_LOG(">> To Server: "+srvc);this.ReplyReceived=false;this.ServerReply=null;if(window.ENCRYPTION==false)this.Socket.send(srvc);else this.Socket.send(DES_Encrypt(srvc))};GameProxySocket.prototype.IsConnected=function(){return this.Connected};GameProxySocket.prototype.Goto_Error=function(alarm_to_raise){this.ApplicationRef.GAMEPROXY().Goto_Error(alarm_to_raise)};GameProxySocket.prototype.SERVER_REPLY=function(){if(window.ENCRYPTION==false)return this.ServerReply;return DES_Decrypt(this.ServerReply)};GameProxySocket.prototype.REPLY_RECEIVED=function(){return this.ReplyReceived};GameProxySocket.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms)};GameProxy.PROXY_TIME_OUT=30*1e3;GameProxy.STATE_BOOT=0;GameProxy.STATE_SETUP=10;GameProxy.STATE_TO_INITIALIZE=20;GameProxy.STATE_CONNECTION=30;GameProxy.STATE_INIT_GAME=40;GameProxy.STATE_PLAY_BET=50;GameProxy.STATE_PLAY_BONUS=60;GameProxy.STATE_PLAY_FREESPIN=70;GameProxy.STATE_PLAY_STATUS=80;GameProxy.STATE_USER_SETTING=90;GameProxy.STATE_USER_SETTING_REQ=100;GameProxy.STATE_USER_BET_VALIDATE=105;GameProxy.STATE_LOGOUT=106;GameProxy.STATE_WAIT_REPLY=110;GameProxy.STATE_IDLE=200;GameProxy.STATE_ERROR=210;function GameProxy(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.PlayerRef=null;this.Socket=new GameProxySocket(app_reference);this.Data=new GameProxyData(app_reference);this.DemoFeature=-1;this.Stato=0;this.Last_Request="";this.WhyError="";this.Retry=1;this.ConnectionTimeOut=false;this.ContentLoaded=false}GameProxy.prototype=Object.create(SObject.prototype);GameProxy.prototype.constructor=GameProxy;GameProxy.prototype.Init=function(){this.PlayerRef=this.ApplicationRef.PLAYER();this.Data.Init()};GameProxy.prototype.Reset=function(){this.Data.Reset()};GameProxy.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);if(this.IsOffline()==true){this.Goto_State(GameProxy.STATE_IDLE)}else{switch(this.Stato){case GameProxy.STATE_BOOT:{this.Goto_State(GameProxy.STATE_SETUP)}break;case GameProxy.STATE_SETUP:{this.Setup_Parms();this.Goto_State(GameProxy.STATE_CONNECTION)}break;case GameProxy.STATE_TO_INITIALIZE:{if(this.ContentLoaded==true)this.Goto_State(GameProxy.STATE_INIT_GAME+1)}break;case GameProxy.STATE_CONNECTION:{this.Socket.Setup_Connection();this.GPTimer=this.ArmaTimer(this.GPTimer,GameProxy.PROXY_TIME_OUT);this.Goto_State(GameProxy.STATE_INIT_GAME)}break;case GameProxy.STATE_INIT_GAME:{if(this.Socket.IsConnected()==true){this.Init_Game();this.Goto_State(GameProxy.STATE_TO_INITIALIZE)}else{if(this.GPTimer==0){this.Goto_Error(StateAlarm.ID_ALARM_SERVER_TIMEOUT)}}}break;case GameProxy.STATE_INIT_GAME+1:{if(this.CheckForReply()==true){if(this.Parse()==false){this.Goto_Error(StateAlarm.ID_ALARM_SERVER_PARSER)}else{this.ApplicationRef.Recover();this.Goto_State(GameProxy.STATE_IDLE)}}}break;case GameProxy.STATE_PLAY_BET:{this.Play_Bet();this.Goto_State(GameProxy.STATE_WAIT_REPLY)}break;case GameProxy.STATE_PLAY_BONUS:{this.Play_Bonus();this.Goto_State(GameProxy.STATE_WAIT_REPLY)}break;case GameProxy.STATE_PLAY_FREESPIN:{this.Play_Freespin();this.Goto_State(GameProxy.STATE_WAIT_REPLY)}break;case GameProxy.STATE_PLAY_STATUS:{this.Play_Status();this.Goto_State(GameProxy.STATE_WAIT_REPLY)}break;case GameProxy.STATE_USER_SETTING:{this.User_Setup();this.Goto_State(GameProxy.STATE_WAIT_REPLY)}break;case GameProxy.STATE_USER_SETTING_REQ:{this.User_Setup_Request();this.Goto_State(GameProxy.STATE_WAIT_REPLY)}break;case GameProxy.STATE_USER_BET_VALIDATE:{this.User_Bet_Validate();this.Goto_State(GameProxy.STATE_WAIT_REPLY)}break;case GameProxy.STATE_LOGOUT:{this.LogOut();this.Goto_State(GameProxy.STATE_WAIT_REPLY)}break;case GameProxy.STATE_WAIT_REPLY:{if(this.CheckForReply()==true){if(this.Parse()==false){this.Goto_Error(StateAlarm.ID_ALARM_SERVER_PARSER)}else{this.Goto_State(GameProxy.STATE_IDLE)}}}break;case GameProxy.STATE_IDLE:{}break;case GameProxy.STATE_ERROR:{}break;default:break}}};GameProxy.prototype.NOTIFY_LOADED_EVENT=function(){this.ContentLoaded=true};GameProxy.prototype.NOTIFY_PLAY_BET=function(){this.Goto_State(GameProxy.STATE_PLAY_BET)};GameProxy.prototype.NOTIFY_PLAY_BONUS=function(id_bonus,id_action,id_pick){this.Data.ID_BONUS=id_bonus;this.Data.ACTION_BONUS=id_action;this.Data.PICK_BONUS=id_pick;this.Goto_State(GameProxy.STATE_PLAY_BONUS)};GameProxy.prototype.NOTIFY_PLAY_FREESPIN=function(id_bonus,id_action){this.Data.ID_BONUS=id_bonus;this.Data.ACTION_BONUS=id_action;this.Goto_State(GameProxy.STATE_PLAY_FREESPIN)};GameProxy.prototype.CMD_PLAY_STATUS=function(){this.Goto_State(GameProxy.STATE_PLAY_STATUS)};GameProxy.prototype.CMD_CREDIT_STATUS=function(){this.PlayerRef.REFRESH_COINS(true);this.Goto_State(GameProxy.STATE_PLAY_STATUS)};GameProxy.prototype.CMD_LOGOUT=function(){this.Goto_State(GameProxy.STATE_LOGOUT)};GameProxy.prototype.GET_DATA=function(){return this.Data};GameProxy.prototype.STATO=function(){return this.Stato};GameProxy.prototype.WHY_ERROR=function(){return this.WhyError};GameProxy.prototype.DEMO_FEATURE_GET=function(){return this.DemoFeature};GameProxy.prototype.DEMO_FEATURE_SET=function(val){this.DemoFeature=val};GameProxy.prototype.CMD_USER_BET_VALIDATE=function(bet_value){this.Data.USER_SETTING_ID=StateCashBox.CFG_PLAYER_BET;this.Data.USER_SETTING_VALUE=bet_value;this.Goto_State(GameProxy.STATE_USER_BET_VALIDATE)};GameProxy.prototype.Setup_Parms=function(){var alarm=false;if(window.CONNECT2SERVER==true){if(this.Data.CheckConnectionParms()==false){alarm=true}if(alarm==true){this.Goto_Error(StateAlarm.ID_ALARM_PARAMETERS,external_parameter)}}};GameProxy.prototype.CheckForReply=function(){if(this.WaitForReply()==false&&this.ConnectionTimeOut==false){return true}else{if(this.TimeOut()==true){if(--this.Retry==0)this.Goto_Error(StateAlarm.ID_ALARM_SERVER_TIMEOUT);else this.Socket.SendService(this.Last_Request)}}return false};GameProxy.prototype.Goto_State=function(goto){if(this.Stato!=GameProxy.STATE_ERROR)this.Stato=goto};GameProxy.prototype.Goto_Error=function(alarm_to_raise){this.ApplicationRef.PROGRAMMA().GetALLARMI().AddAllarme(alarm_to_raise);this.Stato=GameProxy.STATE_ERROR};GameProxy.prototype.TimeOut=function(){return this.ConnectionTimeOut};GameProxy.prototype.Job_Done=function(){return this.Stato==GameProxy.STATE_IDLE};GameProxy.prototype.IsIdle=function(){return this.Stato==GameProxy.STATE_IDLE||this.Stato==GameProxy.STATE_ERROR};GameProxy.prototype.Init_Game=function(){this.SendServerRequest("InitGame",null)};GameProxy.prototype.Play_Bet=function(){if(this.DemoFeature!=-1){this.SendServerRequest("PlayBet",this.PlayerRef.LINES()+","+this.PlayerRef.BET_LINE()+","+this.PlayerRef.COIN_VALUE_GET()+","+this.DemoFeature+";\n");this.DemoFeature=-1}else this.SendServerRequest("PlayBet",this.PlayerRef.LINES()+","+this.PlayerRef.BET_LINE()+","+this.PlayerRef.COIN_VALUE_GET()+";\n")};GameProxy.prototype.Play_Bonus=function(){this.SendServerRequest("PlayBonus",this.PlayerRef.LINES()+","+this.PlayerRef.BET_LINE()+","+this.PlayerRef.COIN_VALUE_GET()+","+this.Data.ID_BONUS+","+this.Data.ACTION_BONUS+","+this.Data.PICK_BONUS+";\n")};GameProxy.prototype.Play_Freespin=function(){this.SendServerRequest("PlayBonus",this.PlayerRef.LINES()+","+this.PlayerRef.BET_LINE()+","+this.PlayerRef.COIN_VALUE_GET()+","+this.Data.ID_BONUS+","+this.Data.ACTION_BONUS+";\n")};GameProxy.prototype.Play_Status=function(){this.SendServerRequest("PlayStatus",null)};GameProxy.prototype.User_Setup=function(){this.SendServerRequest("UserSetting",this.Data.USER_SETTING_ID+","+this.Data.USER_SETTING_VALUE+";\n")};GameProxy.prototype.User_Setup_Request=function(){this.SendServerRequest("UserSetting",this.Data.USER_SETTING_ID()+";\n")};GameProxy.prototype.LogOut=function(){this.SendServerRequest("LogOut",null);this.Socket.Close_Connection()};GameProxy.prototype.IsOffline=function(){if(window.CONNECT2SERVER==false){return true}return false};GameProxy.prototype.Parse=function(){var incoming_data=this.Socket.SERVER_REPLY();if(this.Data.ParseIncomingData(incoming_data)==false)return false;return true};GameProxy.prototype.WaitForReply=function(){if(this.Socket.REPLY_RECEIVED()==true)return false;if(window.LOCAL_TEST==false){if(this.GPTimer==0){this.ConnectionTimeOut=true;return false}}return true};GameProxy.prototype.SendServerRequest=function(service,service_parms){var body_message_string;if(service_parms!=null)body_message_string=service+","+window.TOKEN+","+service_parms+";\n";else body_message_string=service+","+window.TOKEN+";\n";this.Last_Request=body_message_string;this.Socket.SendService(this.Last_Request);this.GPTimer=this.ArmaTimer(this.GPTimer,GameProxy.PROXY_TIME_OUT);this.ConnectionTimeOut=false};GameProxy.prototype.User_Bet_Validate=function(){var lines,line_bet,total_bet;total_bet=this.Data.USER_SETTING_VALUE;lines=this.ApplicationRef.SLOT().LINES();line_bet=parseInt(total_bet/lines);this.SendServerRequest("UserSetting",this.Data.USER_SETTING_ID+","+lines+","+line_bet+","+this.PlayerRef.COIN_VALUE_GET()+";\n")};WinDescriptor.WP_OFFSET_WIN_TYPE=0;WinDescriptor.WIN_TYPE_LINE_SX=1;WinDescriptor.WIN_TYPE_LINE_DX=2;WinDescriptor.WIN_TYPE_SCATTER=3;WinDescriptor.WIN_TYPE_BONUS=4;WinDescriptor.WP_OFFSET_WIN_SUBTYPE=1;WinDescriptor.WP_OFFSET_WIN_VALUE=2;WinDescriptor.WP_OFFSET_ID_SYMBOL=3;WinDescriptor.WP_OFFSET_SYMBOL_OCC=4;WinDescriptor.WP_OFFSET_SYMBOL_POS_0=5;WinDescriptor.WP_OFFSET_SYMBOL_POS_1=6;WinDescriptor.WP_OFFSET_SYMBOL_POS_2=7;WinDescriptor.WP_OFFSET_SYMBOL_POS_3=8;WinDescriptor.WP_OFFSET_SYMBOL_POS_4=9;function WinDescriptor(){SObject.call(this)}WinDescriptor.prototype=Object.create(SObject.prototype);WinDescriptor.prototype.constructor=WinDescriptor;SlotCombo.MASK_WIN_NONE=0;SlotCombo.MASK_WIN_COMBINAZIONE=1;SlotCombo.MASK_WIN_BONUS_TOPLAY=2;SlotCombo.MASK_WIN_BONUS_PLAYED=4;SlotCombo.MASK_WIN_SCATTER=8;SlotCombo.MASK_WIN_FREESPIN=16;SlotCombo.ID_SLOT_NULLA=0;SlotCombo.ID_2_SIMBOLO_0=1;SlotCombo.ID_2_SIMBOLO_1=2;SlotCombo.ID_2_SIMBOLO_2=3;SlotCombo.ID_2_SIMBOLO_3=4;SlotCombo.ID_2_SIMBOLO_4=5;SlotCombo.ID_2_SIMBOLO_5=6;SlotCombo.ID_2_SIMBOLO_6=7;SlotCombo.ID_2_SIMBOLO_7=8;SlotCombo.ID_2_SIMBOLO_8=9;SlotCombo.ID_2_SIMBOLO_9=10;SlotCombo.ID_2_SIMBOLO_JOLLY=11;SlotCombo.ID_2_SIMBOLO_SCATTER=12;SlotCombo.ID_2_SIMBOLO_BONUS=13;SlotCombo.ID_3_SIMBOLO_0=14;SlotCombo.ID_3_SIMBOLO_1=15;SlotCombo.ID_3_SIMBOLO_2=16;SlotCombo.ID_3_SIMBOLO_3=17;SlotCombo.ID_3_SIMBOLO_4=18;SlotCombo.ID_3_SIMBOLO_5=19;SlotCombo.ID_3_SIMBOLO_6=20;SlotCombo.ID_3_SIMBOLO_7=21;SlotCombo.ID_3_SIMBOLO_8=22;SlotCombo.ID_3_SIMBOLO_9=23;SlotCombo.ID_3_SIMBOLO_JOLLY=24;SlotCombo.ID_3_SIMBOLO_SCATTER=25;SlotCombo.ID_3_SIMBOLO_BONUS=26;SlotCombo.ID_4_SIMBOLO_0=14+13*1;SlotCombo.ID_4_SIMBOLO_1=15+13*1;SlotCombo.ID_4_SIMBOLO_2=16+13*1;SlotCombo.ID_4_SIMBOLO_3=17+13*1;SlotCombo.ID_4_SIMBOLO_4=18+13*1;SlotCombo.ID_4_SIMBOLO_5=19+13*1;SlotCombo.ID_4_SIMBOLO_6=20+13*1;SlotCombo.ID_4_SIMBOLO_7=21+13*1;SlotCombo.ID_4_SIMBOLO_8=22+13*1;SlotCombo.ID_4_SIMBOLO_9=23+13*1;SlotCombo.ID_4_SIMBOLO_JOLLY=24+13*1;SlotCombo.ID_4_SIMBOLO_SCATTER=25+13*1;SlotCombo.ID_4_SIMBOLO_BONUS=26+13*1;SlotCombo.ID_5_SIMBOLO_0=14+13*2;SlotCombo.ID_5_SIMBOLO_1=15+13*2;SlotCombo.ID_5_SIMBOLO_2=16+13*2;SlotCombo.ID_5_SIMBOLO_3=17+13*2;SlotCombo.ID_5_SIMBOLO_4=18+13*2;SlotCombo.ID_5_SIMBOLO_5=19+13*2;SlotCombo.ID_5_SIMBOLO_6=20+13*2;SlotCombo.ID_5_SIMBOLO_7=21+13*2;SlotCombo.ID_5_SIMBOLO_8=22+13*2;SlotCombo.ID_5_SIMBOLO_9=23+13*2;SlotCombo.ID_5_SIMBOLO_JOLLY=24+13*2;SlotCombo.ID_5_SIMBOLO_SCATTER=25+13*2;SlotCombo.ID_5_SIMBOLO_BONUS=26+13*2;SlotCombo.ID_SCATTER_2=53;SlotCombo.ID_SCATTER_3=54;SlotCombo.ID_SCATTER_4=55;SlotCombo.ID_SCATTER_5=56;SlotCombo.TAB_COMBO=[[SlotCombo.ID_2_SIMBOLO_0,SlotCombo.ID_3_SIMBOLO_0,SlotCombo.ID_4_SIMBOLO_0,SlotCombo.ID_5_SIMBOLO_0],[SlotCombo.ID_2_SIMBOLO_1,SlotCombo.ID_3_SIMBOLO_1,SlotCombo.ID_4_SIMBOLO_1,SlotCombo.ID_5_SIMBOLO_1],[SlotCombo.ID_2_SIMBOLO_2,SlotCombo.ID_3_SIMBOLO_2,SlotCombo.ID_4_SIMBOLO_2,SlotCombo.ID_5_SIMBOLO_2],[SlotCombo.ID_2_SIMBOLO_3,SlotCombo.ID_3_SIMBOLO_3,SlotCombo.ID_4_SIMBOLO_3,SlotCombo.ID_5_SIMBOLO_3],[SlotCombo.ID_2_SIMBOLO_4,SlotCombo.ID_3_SIMBOLO_4,SlotCombo.ID_4_SIMBOLO_4,SlotCombo.ID_5_SIMBOLO_4],[SlotCombo.ID_2_SIMBOLO_5,SlotCombo.ID_3_SIMBOLO_5,SlotCombo.ID_4_SIMBOLO_5,SlotCombo.ID_5_SIMBOLO_5],[SlotCombo.ID_2_SIMBOLO_6,SlotCombo.ID_3_SIMBOLO_6,SlotCombo.ID_4_SIMBOLO_6,SlotCombo.ID_5_SIMBOLO_6],[SlotCombo.ID_2_SIMBOLO_7,SlotCombo.ID_3_SIMBOLO_7,SlotCombo.ID_4_SIMBOLO_7,SlotCombo.ID_5_SIMBOLO_7],[SlotCombo.ID_2_SIMBOLO_8,SlotCombo.ID_3_SIMBOLO_8,SlotCombo.ID_4_SIMBOLO_8,SlotCombo.ID_5_SIMBOLO_8],[SlotCombo.ID_2_SIMBOLO_9,SlotCombo.ID_3_SIMBOLO_9,SlotCombo.ID_4_SIMBOLO_9,SlotCombo.ID_5_SIMBOLO_9],[SlotCombo.ID_2_SIMBOLO_JOLLY,SlotCombo.ID_3_SIMBOLO_JOLLY,SlotCombo.ID_4_SIMBOLO_JOLLY,SlotCombo.ID_5_SIMBOLO_JOLLY],[SlotCombo.ID_2_SIMBOLO_SCATTER,SlotCombo.ID_3_SIMBOLO_SCATTER,SlotCombo.ID_4_SIMBOLO_SCATTER,SlotCombo.ID_5_SIMBOLO_SCATTER],[SlotCombo.ID_2_SIMBOLO_BONUS,SlotCombo.ID_3_SIMBOLO_BONUS,SlotCombo.ID_4_SIMBOLO_BONUS,SlotCombo.ID_5_SIMBOLO_BONUS]];SlotCombo.TAB_LINES=[[5,6,7,8,9],[0,1,2,3,4],[10,11,12,13,14],[0,6,12,8,4],[10,6,2,8,14],[5,1,7,3,9],[5,11,7,13,9],[0,1,7,13,14],[10,11,7,3,4],[5,11,7,3,9],[5,1,7,13,9],[0,6,7,8,4],[10,6,7,8,14],[0,6,2,8,4],[10,6,12,8,14]];function SlotCombo(app_reference,slot_ref){SObject.call(this);this.ApplicationRef=app_reference;this.SlotReference=slot_ref;this.SimboliEstratti=null;this.ValoreVincitaAssegnata=0;this.MaskEventoVincita=0;this.VettoreIndiciRullo=new Array(window.NUM_SIMBOLI_RUOTA);this.VettoreIndiciLinea=new Array(window.NUM_REELS);this.DirettriciVincenti=new Array(window.NUM_LINEE);this.DirettriciVincite=new Array(window.NUM_LINEE);this.DirettriciDescriptor=new Array(window.NUM_LINEE);this.DirettriciMoltiplicatore=new Array(window.NUM_LINEE);this.CombinazioniPresenti=new Array(window.NUM_COMBINAZIONI_SLOT);this.SimboliVincenti=new Array(window.NUM_LINEE);for(var i=0;i<this.SimboliVincenti.length;i++)this.SimboliVincenti[i]=new Array(window.NUM_REELS);this.PatternScattered=new Array(window.PATTERN_SIMBOLI);this.PatternSimboliVincenti=new Array(window.PATTERN_SIMBOLI);this.TAB_WINS=new Array(window.NUM_COMBINAZIONI_SLOT);this.TAB_WINS.fill(0)}SlotCombo.prototype=Object.create(SObject.prototype);SlotCombo.prototype.constructor=SlotCombo;SlotCombo.prototype.Init=function(){this.SimboliEstratti=this.SlotReference.GetSimboliEstratti()};SlotCombo.prototype.Reset=function(){this.ResetWinPattern()};SlotCombo.prototype.ResetWinPattern=function(){this.ValoreVincitaAssegnata=0;this.MaskEventoVincita=SlotCombo.MASK_WIN_NONE;for(var i=0;i<window.NUM_LINEE;i++)this.SimboliVincenti[i].fill(0);this.CombinazioniPresenti.fill(0);this.DirettriciVincenti.fill(0);this.DirettriciDescriptor.fill(0);this.DirettriciVincite.fill(0);this.DirettriciMoltiplicatore.fill(0);this.PatternSimboliVincenti.fill(0);this.PatternScattered.fill(0)};SlotCombo.prototype.MaskEventoVincita_GET=function(){return this.MaskEventoVincitaa};SlotCombo.prototype.MaskEventoVincita_SET=function(msk){this.MaskEventoVincita=msk};SlotCombo.prototype.MaskEventoVincita_CHECK=function(msk){return(this.MaskEventoVincita&msk)!=0};SlotCombo.prototype.GetVettoreIndiciRullo=function(p_IdRullo){for(var i=0;i<window.NUM_SIMBOLI_RUOTA;i++)this.VettoreIndiciRullo[i]=p_IdRullo+window.NUM_REELS*i};SlotCombo.prototype.GetIdxRullo=function(p_IdxSimbolo){return parseInt(p_IdxSimbolo%window.NUM_REELS)};SlotCombo.prototype.GetPosizioneInRullo=function(p_IdxSimbolo){return parseInt(p_IdxSimbolo/window.NUM_REELS)};SlotCombo.prototype.GetOccorrenzaSimboloInPattern=function(p_IDSimbolo){var i;var l_Occ=0;for(i=0;i<window.PATTERN_SIMBOLI;i++)if(this.SimboliEstratti[i]==p_IDSimbolo){l_Occ++}return l_Occ};SlotCombo.prototype.GetOccorrenzaSimboloInRullo=function(p_IDSimbolo,p_IDRullo){var i,l_Indice;var l_Occ=0;for(i=0;i<window.NUM_SIMBOLI_RUOTA;i++){l_Indice=p_IDRullo+window.NUM_REELS*i;if(this.SimboliEstratti[l_Indice]==p_IDSimbolo){l_Occ++;break}}return l_Occ};SlotCombo.prototype.IsSimboloCombinazione=function(p_IDCombinazione,p_Simbolo){if(this.IsSimboloJolly(p_Simbolo))return true;if(p_Simbolo!=this.GetSimboloCombinazione(p_IDCombinazione))return false;return true};SlotCombo.prototype.GetNumDirettriciVincenti=function(){var num=0;for(var i=0;i<window.NUM_LINEE;i++)if(this.DirettriciVincenti[i]!=0)num++;return num};SlotCombo.prototype.GetQuotazioneSimbolo=function(sym,nn){return this.GetQuotazioneCombinazione(1+(sym-1)+window.SLICE_COMBINAZIONI_SLOT*(nn-2))};SlotCombo.prototype.GetQuotazioneOrigine=function(id_combo){return this.TAB_WINS[id_combo]};SlotCombo.prototype.GetVincitaAssegnata=function(id_combo){return this.ValoreVincitaAssegnata};SlotCombo.prototype.Parse_PAY_TABLE=function(chunk_to_parse){var esito=false;var i=0;esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){if(this.ServerData.length!=window.NUM_COMBINAZIONI_SLOT){esito=false}else{for(i=0;i<window.NUM_COMBINAZIONI_SLOT-1;i++){this.TAB_WINS[i+1]=this.ParseServer_Dump_UINT(-1)}}}return esito};SlotCombo.prototype.Parse_WIN_PATTERN=function(chunk_to_parse){var i,win_type,win_subtype,win_value,win_sym,sym_occ,id_combo;var l_VettoreSimboliVincenti=Array(window.NUM_REELS);esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){win_type=this.ParseServer_Dump_UINT(-1);win_subtype=this.ParseServer_Dump_UINT(-1);switch(win_type){case WinDescriptor.WIN_TYPE_LINE_SX:case WinDescriptor.WIN_TYPE_LINE_DX:case WinDescriptor.WIN_TYPE_BONUS:{win_multiplier=this.ParseServer_Dump_UINT(-1);win_value=this.ParseServer_Dump_UINT(-1);win_sym=this.ParseServer_Dump_UINT(-1);sym_occ=this.ParseServer_Dump_UINT(-1);id_combo=this.IdentifyCombo(win_sym,sym_occ);if(id_combo==0||id_combo>window.NUM_COMBINAZIONI_SLOT){esito=false}else{this.GetVettoreIndiciLinea(win_subtype);this.DirettriciVincenti[win_subtype]=id_combo;this.DirettriciDescriptor[win_subtype]=win_type;l_VettoreSimboliVincenti.fill(0);for(i=0;i<sym_occ;i++){l_VettoreSimboliVincenti[this.ParseServer_Dump_UINT(-1)]=1}for(i=0;i<window.NUM_REELS;i++){this.SimboliVincenti[win_subtype][i]=l_VettoreSimboliVincenti[i];this.PatternSimboliVincenti[this.VettoreIndiciLinea[i]]|=l_VettoreSimboliVincenti[i]}this.CombinazioniPresenti[id_combo]++;if(win_type==WinDescriptor.WIN_TYPE_BONUS){this.DirettriciMoltiplicatore[win_subtype]=1;this.MaskEventoVincita|=SlotCombo.MASK_WIN_BONUS_TOPLAY}else{this.DirettriciVincite[win_subtype]=win_value;this.ValoreVincitaAssegnata+=win_value;this.DirettriciMoltiplicatore[win_subtype]=win_multiplier;this.MaskEventoVincita|=SlotCombo.MASK_WIN_COMBINAZIONE}}}break;case WinDescriptor.WIN_TYPE_SCATTER:{win_value=this.ParseServer_Dump_UINT(-1);win_sym=this.ParseServer_Dump_UINT(-1);sym_occ=this.ParseServer_Dump_UINT(-1);id_combo=this.IdentifyCombo(win_sym,sym_occ);if(id_combo==0||id_combo>window.NUM_COMBINAZIONI_SLOT)esito=false;else{for(i=0;i<window.PATTERN_SIMBOLI;i++){if(this.SimboliEstratti[i]==window.ID_SIMBOLO_SCATTER){this.PatternScattered[i]=1;this.PatternSimboliVincenti[i]=1;if(--sym_occ==0)break}}this.CombinazioniPresenti[id_combo]=1;this.MaskEventoVincita|=SlotCombo.MASK_WIN_SCATTER;if(win_subtype!=0){this.ApplicationRef.SLOT().FREESPIN().Parse_FREESPIN_ACTIVATE(win_subtype,win_value);this.MaskEventoVincita|=SlotCombo.MASK_WIN_FREESPIN}}}break;default:break}}return esito};SlotCombo.prototype.IsHold=function(index){return false};SlotCombo.prototype.GetQuotazioneCombinazione=function(p_IDCombinazione){this.ASSERT(p_IDCombinazione<window.NUM_COMBINAZIONI_SLOT,"INVALID COMBO DETECTED!"+p_IDCombinazione);var quot=this.TAB_WINS[p_IDCombinazione]*this.ApplicationRef.SLOT().BET_LINE()*this.ApplicationRef.PLAYER().COIN_VALUE_GET();return quot};SlotCombo.prototype.IsSimboloJolly=function(p_Simbolo){if(p_Simbolo==window.ID_SIMBOLO_JOLLY)return true;return false};SlotCombo.prototype.GetSimboloCombinazione=function(p_IDCombinazione){var l_Simbolo;l_Simbolo=window.ID_DUMMY;switch(p_IDCombinazione){case SlotCombo.ID_2_SIMBOLO_0:case SlotCombo.ID_3_SIMBOLO_0:case SlotCombo.ID_4_SIMBOLO_0:case SlotCombo.ID_5_SIMBOLO_0:{l_Simbolo=window.ID_SIMBOLO_0}break;case SlotCombo.ID_2_SIMBOLO_1:case SlotCombo.ID_3_SIMBOLO_1:case SlotCombo.ID_4_SIMBOLO_1:case SlotCombo.ID_5_SIMBOLO_1:{l_Simbolo=window.ID_SIMBOLO_1}break;case SlotCombo.ID_2_SIMBOLO_2:case SlotCombo.ID_3_SIMBOLO_2:case SlotCombo.ID_4_SIMBOLO_2:case SlotCombo.ID_5_SIMBOLO_2:{l_Simbolo=window.ID_SIMBOLO_2}break;case SlotCombo.ID_2_SIMBOLO_3:case SlotCombo.ID_3_SIMBOLO_3:case SlotCombo.ID_4_SIMBOLO_3:case SlotCombo.ID_5_SIMBOLO_3:{l_Simbolo=window.ID_SIMBOLO_3}break;case SlotCombo.ID_2_SIMBOLO_4:case SlotCombo.ID_3_SIMBOLO_4:case SlotCombo.ID_4_SIMBOLO_4:case SlotCombo.ID_5_SIMBOLO_4:{l_Simbolo=window.ID_SIMBOLO_4}break;case SlotCombo.ID_2_SIMBOLO_5:case SlotCombo.ID_3_SIMBOLO_5:case SlotCombo.ID_4_SIMBOLO_5:case SlotCombo.ID_5_SIMBOLO_5:{l_Simbolo=window.ID_SIMBOLO_5}break;case SlotCombo.ID_2_SIMBOLO_6:case SlotCombo.ID_3_SIMBOLO_6:case SlotCombo.ID_4_SIMBOLO_6:case SlotCombo.ID_5_SIMBOLO_6:{l_Simbolo=window.ID_SIMBOLO_6}break;case SlotCombo.ID_2_SIMBOLO_7:case SlotCombo.ID_3_SIMBOLO_7:case SlotCombo.ID_4_SIMBOLO_7:case SlotCombo.ID_5_SIMBOLO_7:{l_Simbolo=window.ID_SIMBOLO_7}break;case SlotCombo.ID_2_SIMBOLO_8:case SlotCombo.ID_3_SIMBOLO_8:case SlotCombo.ID_4_SIMBOLO_8:case SlotCombo.ID_5_SIMBOLO_8:{l_Simbolo=window.ID_SIMBOLO_8}break;case SlotCombo.ID_2_SIMBOLO_9:case SlotCombo.ID_3_SIMBOLO_9:case SlotCombo.ID_4_SIMBOLO_9:case SlotCombo.ID_5_SIMBOLO_9:{l_Simbolo=window.ID_SIMBOLO_9}break;case SlotCombo.ID_2_SIMBOLO_JOLLY:case SlotCombo.ID_3_SIMBOLO_JOLLY:case SlotCombo.ID_4_SIMBOLO_JOLLY:case SlotCombo.ID_5_SIMBOLO_JOLLY:{l_Simbolo=window.ID_SIMBOLO_JOLLY}break;case SlotCombo.ID_2_SIMBOLO_SCATTER:case SlotCombo.ID_3_SIMBOLO_SCATTER:case SlotCombo.ID_4_SIMBOLO_SCATTER:case SlotCombo.ID_5_SIMBOLO_SCATTER:case SlotCombo.ID_SCATTER_2:case SlotCombo.ID_SCATTER_3:case SlotCombo.ID_SCATTER_4:case SlotCombo.ID_SCATTER_5:{l_Simbolo=window.ID_SIMBOLO_SCATTER}break;case SlotCombo.ID_2_SIMBOLO_BONUS:case SlotCombo.ID_3_SIMBOLO_BONUS:case SlotCombo.ID_4_SIMBOLO_BONUS:case SlotCombo.ID_5_SIMBOLO_BONUS:{l_Simbolo=window.ID_SIMBOLO_BONUS}break;default:break}return l_Simbolo};SlotCombo.prototype.GetNumSimboliCombinazione=function(p_IDCombinazione){if(p_IDCombinazione>=SlotCombo.ID_2_SIMBOLO_0&&p_IDCombinazione<=SlotCombo.ID_2_SIMBOLO_JOLLY)return 2;if(p_IDCombinazione>=SlotCombo.ID_3_SIMBOLO_0&&p_IDCombinazione<=SlotCombo.ID_3_SIMBOLO_JOLLY)return 3;if(p_IDCombinazione>=SlotCombo.ID_4_SIMBOLO_0&&p_IDCombinazione<=SlotCombo.ID_4_SIMBOLO_JOLLY)return 4;return 5};SlotCombo.prototype.GetVettoreIndiciLinea=function(p_IdLinea){for(var i=0;i<window.NUM_REELS;i++)this.VettoreIndiciLinea[i]=SlotCombo.TAB_LINES[p_IdLinea][i]};SlotCombo.prototype.GetRandSimboloSlot=function(){var l_Simbolo;var re_do;do{re_do=false;l_Simbolo=window.ID_SIMBOLO_0+Lib.Rand(window.NUM_SIMBOLI);if(this.IsSimboloJolly(l_Simbolo)==true)re_do=true;else if(l_Simbolo==window.ID_SIMBOLO_SCATTER)re_do=true;else if(l_Simbolo==window.ID_SIMBOLO_BONUS)re_do=true;else if(l_Simbolo==window.ID_SIMBOLO_SUPER)re_do=true}while(re_do==true)return l_Simbolo};SlotCombo.prototype.IdentifyCombo=function(p_IDSym,p_IDOcc){return SlotCombo.TAB_COMBO[p_IDSym-1][p_IDOcc-2]};function SpriteTransformerInfo(host_sprite){SObject.call(this);this.Host=host_sprite;this.colorMatrix=null;this.colorFilter=null;this.Starting_xx=0;this.Starting_yy=0;this.Starting_WW=0;this.Starting_HH=0;this.ResetCoords=false;this.Target_xx=0;this.Target_yy=0;this.Delta_xx=0;this.Delta_yy=0;this.Alpha_Tgt=0;this.Alpha_Org=0;this.Alpha_Tmp=0;this.Alpha_Step=0;this.Anim_Frame_Tgt=0;this.Anim_Frame_Tgt_Org=0;this.Anim_Flags=0;this.Scale_Min=0;this.Scale_Max=0;this.ScaleX_Org=0;this.ScaleY_Org=0;this.ScaleX_Tgt=0;this.ScaleX_Delta=0;this.ScaleY_Tgt=0;this.ScaleY_Delta=0;this.Bright_Cur=0;this.Bright_Tgt=0;this.Bright_Tgt_Org=0;this.Bright_Step=0;this.AnchorSet=false;this.Rotation_Target=0;this.Rotation_Delta=0;this.End_Visible=0;this.End_Frame=0;this.End_Abs_Scale=0;this.End_Abs_Alpha=0;this.End_Rel_X=0;this.End_Rel_Y=0;this.Org_Anchor=0;this.TimerMoving=0;this.TimeMoving=0;this.TimerAnimation=0;this.TimeAnimation=0;this.TimerFade=0;this.TimeFade=0;this.TimerLight=0;this.TimeLight=0;this.TimerScale=0;this.TimeScale=0;this.TimerRotation=0;this.TimeRotation=0;this.TimerPause=0;this.Loops=0;this.StatusFlag=0;this.Reset()}SpriteTransformerInfo.prototype=Object.create(SObject.prototype);SpriteTransformerInfo.prototype.constructor=SpriteTransformerInfo;SpriteTransformerInfo.prototype.Init=function(){};SpriteTransformerInfo.prototype.ResetColorFilter=function(){this.colorMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];this.colorFilter=new PIXI.filters.ColorMatrixFilter;this.colorFilter.matrix=this.colorMatrix;this.Bright_Cur=1};SpriteTransformerInfo.prototype.Reset=function(){this.StatusFlag=0;this.Anim_Flags=0;this.TimerAnimation=0;this.TimerMoving=0;this.TimerFade=0;this.TimerLight=0;this.TimerRotation=0;this.Loops=0;this.ResetColorFilter()};SpriteTransformerInfo.prototype.RefreshTimers=function(ellapsed_ms){ellapsed_ms=this.DeviceEllapsedTime(ellapsed_ms);this.TimerRefresh(ellapsed_ms);this.TimerAnimation=this.TimerDec(this.TimerAnimation,ellapsed_ms);this.TimerMoving=this.TimerDec(this.TimerMoving,ellapsed_ms);this.TimerFade=this.TimerDec(this.TimerFade,ellapsed_ms);this.TimerScale=this.TimerDec(this.TimerScale,ellapsed_ms);this.TimerLight=this.TimerDec(this.TimerLight,ellapsed_ms);this.TimerRotation=this.TimerDec(this.TimerRotation,ellapsed_ms);this.TimerPause=this.TimerDec(this.TimerPause,ellapsed_ms)};SpriteTransformerInfo.prototype.ApplyColorFilter=function(){this.colorFilter.brightness(this.Bright_Cur,false);this.Host.Sprite.filters=[this.colorFilter]};SpriteTransformerInfo.prototype.RemoveColorFilter=function(){this.ResetColorFilter();this.Host.Sprite.filters=null};SpriteTransformer.ACTION_NONE=0;SpriteTransformer.ACTION_MOVE_REL=1;SpriteTransformer.ACTION_MOVE_TOW=2;SpriteTransformer.ACTION_MOVE_ABS=3;SpriteTransformer.ACTION_MOVE_BACK=4;SpriteTransformer.ACTION_FADE_ABS=5;SpriteTransformer.ACTION_FADE_BACK=6;SpriteTransformer.ACTION_FADE_LOOP=7;SpriteTransformer.ACTION_SCALE_ABS=8;SpriteTransformer.ACTION_SCALE_BACK=9;SpriteTransformer.ACTION_SCALE_LOOP=10;SpriteTransformer.ACTION_ANI_REL=11;SpriteTransformer.ACTION_ANI_TOW=12;SpriteTransformer.ACTION_ANI_ABS=13;SpriteTransformer.ACTION_LIGHT_ABS=14;SpriteTransformer.ACTION_LIGHT_BACK=15;SpriteTransformer.ACTION_LIGHT_LOOP=16;SpriteTransformer.ACTION_RESET_END=17;SpriteTransformer.ACTION_ROTATE_ABS=32;SpriteTransformer.ACTION_ROTATE_REL=64;SpriteTransformer.ACTION_ROTATE_LOOP=128;SpriteTransformer.ACTION_DEFORMATE=256;SpriteTransformer.ACTION_PAUSE=512;SpriteTransformer.MASK_NONE=0;SpriteTransformer.MASK_OFF=2;SpriteTransformer.MASK_ON=4;SpriteTransformer.MASK_FADING_1=8;SpriteTransformer.MASK_FADING_2=16;SpriteTransformer.MASK_FADING_3=32;SpriteTransformer.MASK_FADING=SpriteTransformer.MASK_FADING_1|SpriteTransformer.MASK_FADING_2|SpriteTransformer.MASK_FADING_3;SpriteTransformer.MASK_ANIMATING=128;SpriteTransformer.MASK_CLIPPING=256;SpriteTransformer.MASK_REDRAW=512;SpriteTransformer.MASK_SCALING_1=1024;SpriteTransformer.MASK_SCALING_2=2048;SpriteTransformer.MASK_SCALING_3=4096;SpriteTransformer.MASK_SCALING=SpriteTransformer.MASK_SCALING_1|SpriteTransformer.MASK_SCALING_2|SpriteTransformer.MASK_SCALING_3;SpriteTransformer.MASK_LIGHTING_1=8192;SpriteTransformer.MASK_LIGHTING_2=16384;SpriteTransformer.MASK_LIGHTING_3=32768;SpriteTransformer.MASK_LIGHTING=SpriteTransformer.MASK_LIGHTING_1|SpriteTransformer.MASK_LIGHTING_2|SpriteTransformer.MASK_LIGHTING_3;SpriteTransformer.MASK_ROTATING_A=65536;SpriteTransformer.MASK_ROTATING_R=131072;SpriteTransformer.MASK_ROTATING_L=262144;SpriteTransformer.MASK_ROTATING=SpriteTransformer.MASK_ROTATING_A|SpriteTransformer.MASK_ROTATING_R|SpriteTransformer.MASK_ROTATING_L;SpriteTransformer.MASK_MOVING_1=524288;SpriteTransformer.MASK_MOVING_2=1048576;SpriteTransformer.MASK_MOVING_3=2097152;SpriteTransformer.MASK_MOVING=SpriteTransformer.MASK_MOVING_1|SpriteTransformer.MASK_MOVING_2|SpriteTransformer.MASK_MOVING_3;SpriteTransformer.MASK_DEFORMATING=4194304;SpriteTransformer.MASK_PAUSE=8388608;SpriteTransformer.MASK_RESET_END=16777216;SpriteTransformer.MASK_REMOVE_END=33554432;SpriteTransformer.MASK_BACK_TO_ORG=67108864;SpriteTransformer.ANIMATION_NONE=0;SpriteTransformer.ANIMATION_LOOP=256;SpriteTransformer.ANIMATION_CLRE=512;SpriteTransformer.ANIMATION_DELT=2048;SpriteTransformer.ANIMATION_LOOPBACK=4096;SpriteTransformer.SCALE_FLAG_H=8192;function SpriteTransformer(host_sprite){SObject.call(this);this.Host=host_sprite;this.Transform=new SpriteTransformerInfo(host_sprite)}SpriteTransformer.prototype=Object.create(SObject.prototype);SpriteTransformer.prototype.constructor=SpriteTransformer;SpriteTransformer.prototype.Init=function(){};SpriteTransformer.prototype.RunAction=function(action,float_parms,uint_parms){switch(action){case SpriteTransformer.ACTION_MOVE_REL:{this.MoveRel(float_parms[0],float_parms[1],uint_parms[0],float_parms[2])}break;case SpriteTransformer.ACTION_MOVE_TOW:{this.MoveTow(float_parms[0],float_parms[1],uint_parms[0],float_parms[2])}break;case SpriteTransformer.ACTION_MOVE_ABS:{this.MoveAbs(float_parms[0],float_parms[1])}break;case SpriteTransformer.ACTION_FADE_ABS:{
this.FadeAbs(float_parms[0],uint_parms[0],float_parms[1])}break;case SpriteTransformer.ACTION_FADE_BACK:{this.FadeAndBack(float_parms[0],uint_parms[0],float_parms[1])}break;case SpriteTransformer.ACTION_FADE_LOOP:{this.FadeLoop(float_parms[0],uint_parms[0],float_parms[1])}break;case SpriteTransformer.ACTION_LIGHT_ABS:{this.LightAbs(uint_parms[0],uint_parms[1],float_parms[0])}break;case SpriteTransformer.ACTION_LIGHT_BACK:{this.LightAndBack(uint_parms[0],uint_parms[1],float_parms[0])}break;case SpriteTransformer.ACTION_LIGHT_LOOP:{this.LightLoop(uint_parms[0],uint_parms[1],float_parms[0])}break;case SpriteTransformer.ACTION_SCALE_ABS:{this.ScaleAbs(float_parms[0],float_parms[1],uint_parms[0],float_parms[2])}break;case SpriteTransformer.ACTION_SCALE_BACK:{this.ScaleAndBack(float_parms[0],uint_parms[0],float_parms[1],SpriteTransformer.MASK_BACK_TO_ORG)}break;case SpriteTransformer.ACTION_SCALE_LOOP:{this.ScaleLoop(float_parms[0],float_parms[1],uint_parms[0],float_parms[2])}break;case SpriteTransformer.ACTION_ANI_REL:{this.AnimateRel(uint_parms[0],uint_parms[1],float_parms[0])}break;case SpriteTransformer.ACTION_ANI_TOW:{this.AnimateTow(uint_parms[0],uint_parms[1],float_parms[0])}break;case SpriteTransformer.ACTION_ANI_ABS:{this.AnimateAbs(uint_parms[0],uint_parms[1],uint_parms[2],float_parms[0])}break;case SpriteTransformer.ACTION_RESET_END:{this.ResetAtEnd(uint_parms[0],uint_parms[1],float_parms[0],float_parms[1],float_parms[2],float_parms[3])}break;case SpriteTransformer.ACTION_ROTATE_ABS:{this.RotateAbs(float_parms[0],uint_parms[0],float_parms[1])}break;case SpriteTransformer.ACTION_ROTATE_REL:{this.RotateRel(float_parms[0],uint_parms[0],float_parms[1])}break;case SpriteTransformer.ACTION_ROTATE_LOOP:{this.RotateLoop(float_parms[0],uint_parms[0],float_parms[1])}break;case SpriteTransformer.ACTION_DEFORMATE:{this.Deformate(float_parms[0],float_parms[1],uint_parms[0])}break;case SpriteTransformer.ACTION_PAUSE:{this.Pause(float_parms[0])}break;default:break}};SpriteTransformer.prototype.Pause=function(time){this.Transform.TimerPause=time;this.Transform.StatusFlag|=SpriteTransformer.MASK_PAUSE};SpriteTransformer.prototype.RotateAbs=function(degrees,steps,time){var radians=Lib.radians(degrees);steps=this.DeviceSteps(steps);this.Transform.Rotation_Delta=(radians-this.Host.Sprite.rotation)/Number(steps);this.Transform.Rotation_Target=radians;this.Transform.TimeRotation=time;this.Transform.TimerRotation=0;this.AnchorPoint_ON();this.Transform.StatusFlag|=SpriteTransformer.MASK_ROTATING_A};SpriteTransformer.prototype.RotateRel=function(degrees,steps,time){var radians=Lib.radians(degrees);steps=this.DeviceSteps(steps);this.Transform.Rotation_Delta=radians/Number(steps);this.Transform.Rotation_Target=Lib.radians(this.Host.Sprite.rotation+radians);this.Transform.TimeRotation=time;this.Transform.TimerRotation=0;this.AnchorPoint_ON();this.Transform.StatusFlag|=SpriteTransformer.MASK_ROTATING_R};SpriteTransformer.prototype.RotateLoop=function(loops,steps,time){var radians=Lib.radians(360);steps=this.DeviceSteps(steps);this.Transform.Rotation_Delta=radians/Number(steps);if(loops==0)this.Transform.Rotation_Target=255;else this.Transform.Rotation_Target=loops;this.Transform.TimeRotation=time;this.Transform.TimerRotation=0;this.AnchorPoint_ON();this.Transform.StatusFlag|=SpriteTransformer.MASK_ROTATING_L};SpriteTransformer.prototype.Deformate=function(step_x,step_y,time){this.Transform.ScaleX_Org=this.Host.Sprite.scale.x;this.Transform.ScaleY_Org=this.Host.Sprite.scale.y;this.Transform.Starting_xx=this.Host.Sprite.x;this.Transform.Starting_yy=this.Host.Sprite.y;this.Transform.ScaleX_Delta=this.DeviceEllapsedTime(step_x);this.Transform.ScaleY_Delta=this.DeviceEllapsedTime(step_y);this.ScaleX_Tgt=0;this.Transform.TimeScale=time;this.Transform.TimerScale=0;this.Transform.Loops=0;this.AnchorPoint_ON();this.Transform.StatusFlag|=SpriteTransformer.MASK_DEFORMATING;this.Transform.ResetCoords=true};SpriteTransformer.prototype.ACTION_Deformate=function(){var loops;if(this.Transform.TimerScale!=0)return;this.Host.Sprite.scale.x=1+Math.sin(this.ScaleX_Tgt)*this.Transform.ScaleX_Delta;this.Host.Sprite.scale.y=1+Math.cos(this.ScaleX_Tgt)*this.Transform.ScaleY_Delta;this.ScaleX_Tgt+=.1;loops=parseInt(this.ScaleX_Tgt/3.14);if(loops!=this.Transform.Loops)this.Transform.Loops++;this.Transform.TimerScale=this.Transform.TimeScale};SpriteTransformer.prototype.GetLoops=function(){return this.Transform.Loops};SpriteTransformer.prototype.MoveEx=function(rel_xx,rel_yy,steps,time){steps=this.DeviceSteps(steps);this.Transform.Starting_xx=this.Host.Sprite.x;this.Transform.Starting_yy=this.Host.Sprite.y;this.Transform.Target_xx=this.Host.Sprite.x+rel_xx;this.Transform.Target_yy=this.Host.Sprite.y+rel_yy;this.Transform.Delta_xx=(this.Transform.Target_xx-this.Host.Sprite.x)/steps;if(this.Transform.Delta_xx==0&&this.Transform.Target_xx!=this.Host.Sprite.x){if(this.Transform.Target_xx<this.Host.Sprite.x)this.Transform.Delta_xx=-1;else this.Transform.Delta_xx=1}this.Transform.Delta_yy=(this.Transform.Target_yy-this.Host.Sprite.y)/steps;if(this.Transform.Delta_yy==0&&this.Transform.Target_yy!=this.Host.Sprite.y){if(this.Transform.Target_yy<this.Host.Sprite.y)this.Transform.Delta_yy=-1;else this.Transform.Delta_yy=1}this.Transform.TimeMoving=time;this.Transform.TimerMoving=0;this.Transform.StatusFlag|=SpriteTransformer.MASK_MOVING_1|SpriteTransformer.MASK_MOVING_3};SpriteTransformer.prototype.MoveRel=function(rel_xx,rel_yy,steps,time){steps=this.DeviceSteps(steps);this.Transform.Starting_xx=this.Host.Sprite.x;this.Transform.Starting_yy=this.Host.Sprite.y;this.Transform.Target_xx=this.Host.Sprite.x+rel_xx;this.Transform.Target_yy=this.Host.Sprite.y+rel_yy;this.Transform.Delta_xx=(this.Transform.Target_xx-this.Host.Sprite.x)/steps;if(this.Transform.Delta_xx==0&&this.Transform.Target_xx!=this.Host.Sprite.x){if(this.Transform.Target_xx<this.Host.Sprite.x)this.Transform.Delta_xx=-1;else this.Transform.Delta_xx=1}this.Transform.Delta_yy=(this.Transform.Target_yy-this.Host.Sprite.y)/steps;if(this.Transform.Delta_yy==0&&this.Transform.Target_yy!=this.Host.Sprite.y){if(this.Transform.Target_yy<this.Host.Sprite.y)this.Transform.Delta_yy=-1;else this.Transform.Delta_yy=1}this.Transform.TimeMoving=time;this.Transform.TimerMoving=0;this.Transform.StatusFlag|=SpriteTransformer.MASK_MOVING_1};SpriteTransformer.prototype.MoveTow=function(tgt_xx,tgt_yy,steps,time){steps=this.DeviceSteps(steps);this.Transform.Starting_xx=this.Host.Sprite.x;this.Transform.Starting_yy=this.Host.Sprite.y;this.Transform.Target_xx=tgt_xx;this.Transform.Target_yy=tgt_yy;this.Transform.Delta_xx=(this.Transform.Target_xx-this.Host.Sprite.x)/steps;if(this.Transform.Delta_xx==0&&this.Transform.Target_xx!=this.Host.Sprite.x){if(this.Transform.Target_xx<this.Host.Sprite.x)this.Transform.Delta_xx=-1;else this.Transform.Delta_xx=1}this.Transform.Delta_yy=(this.Transform.Target_yy-this.Host.Sprite.y)/steps;if(this.Transform.Delta_yy==0&&this.Transform.Target_yy!=this.Host.Sprite.y){if(this.Transform.Target_yy<this.Host.Sprite.y)this.Transform.Delta_yy=-1;else this.Transform.Delta_yy=1}this.Transform.TimeMoving=time;this.Transform.TimerMoving=0;this.Transform.StatusFlag|=SpriteTransformer.MASK_MOVING_1};SpriteTransformer.prototype.MoveAbs=function(abs_xx,abs_yy){this.Transform.Starting_xx=this.Host.Sprite.x;this.Transform.Starting_yy=this.Host.Sprite.y;this.Transform.Target_xx=abs_xx;this.Transform.Target_yy=abs_yy;this.Transform.Delta_xx=(this.Transform.Target_xx-this.Host.Sprite.x)/1;this.Transform.Delta_yy=(this.Transform.Target_yy-this.Host.Sprite.y)/1;this.Transform.TimerMoving=0;this.Transform.StatusFlag|=SpriteTransformer.MASK_MOVING_1};SpriteTransformer.prototype.FadeAbs=function(TgtAlphaLevel,steps,time){steps=this.DeviceSteps(steps);this.Transform.TimeFade=time;this.Transform.TimerFade=0;this.Transform.Alpha_Org=this.Host.Sprite.alpha;this.Transform.Alpha_Tgt=TgtAlphaLevel;var pp=(TgtAlphaLevel-this.Host.Sprite.alpha)/steps;this.Transform.Alpha_Step=pp;if(this.Transform.Alpha_Step==0&&TgtAlphaLevel!=this.Host.Sprite.alpha){if(TgtAlphaLevel<this.Host.Sprite.alpha)this.Transform.Alpha_Step=-.01;else this.Transform.Alpha_Step=.01}this.Transform.StatusFlag|=SpriteTransformer.MASK_FADING_1};SpriteTransformer.prototype.FadeAndBack=function(TgtAlphaLevel,steps,time){steps=this.DeviceSteps(steps);this.FadeAbs(TgtAlphaLevel,steps,time);this.Transform.StatusFlag|=SpriteTransformer.MASK_FADING_2};SpriteTransformer.prototype.FadeLoop=function(TgtAlphaLevel,steps,time){steps=this.DeviceSteps(steps);this.FadeAbs(TgtAlphaLevel,steps,time);this.Transform.StatusFlag|=SpriteTransformer.MASK_FADING_1|SpriteTransformer.MASK_FADING_3};SpriteTransformer.prototype.LightAbs=function(TgtBrightnessLevel,steps,time){steps=this.DeviceSteps(steps);this.Transform.TimeLight=time;this.Transform.TimerLight=0;if(TgtBrightnessLevel>10)TgtBrightnessLevel=10;this.Transform.Bright_Tgt=TgtBrightnessLevel;this.Transform.Bright_Step=TgtBrightnessLevel/steps;if(this.Transform.Bright_Step==0&&TgtBrightnessLevel!=0){if(TgtBrightnessLevel<0)this.Transform.Bright_Step=-.01;else this.Transform.Bright_Step=.01}this.DEBUG_LOG("LIGHTING "+this.Transform.Bright_Tgt+" "+this.Transform.Bright_Step);this.Transform.StatusFlag|=SpriteTransformer.MASK_LIGHTING_1};SpriteTransformer.prototype.LightAndBack=function(TgtBrightnessLevel,steps,time){this.LightAbs(TgtBrightnessLevel,steps,time);this.Transform.StatusFlag|=SpriteTransformer.MASK_LIGHTING_2};SpriteTransformer.prototype.LightLoop=function(TgtBrightnessLevel,steps,time){this.LightAbs(TgtBrightnessLevel,steps,time);this.Transform.Bright_Tgt_Org=TgtBrightnessLevel;this.Transform.StatusFlag|=SpriteTransformer.MASK_LIGHTING_1|SpriteTransformer.MASK_LIGHTING_3};SpriteTransformer.prototype.ScaleAbs=function(scaleX_tgt,scaleY_tgt,steps,time,flags){steps=this.DeviceSteps(steps);this.Transform.Anim_Flags=flags;this.Transform.ScaleX_Org=this.Host.Sprite.scale.x;this.Transform.ScaleY_Org=this.Host.Sprite.scale.y;this.Transform.Starting_WW=this.Host.FrameW*this.Host.Sprite.scale.x;this.Transform.Starting_HH=this.Host.FrameH*this.Host.Sprite.scale.y;this.Transform.Starting_xx=this.Host.Sprite.x;this.Transform.Starting_yy=this.Host.Sprite.y;this.Transform.TimeScale=time;this.Transform.TimerScale=0;this.Transform.ScaleX_Tgt=scaleX_tgt;this.Transform.ScaleX_Delta=(scaleX_tgt-this.Host.Sprite.scale.x)/steps;if(this.Transform.ScaleX_Delta==0&&scaleX_tgt!=this.Host.Sprite.scale.x){if(scaleX_tgt<this.Host.Sprite.scale.x)this.Transform.ScaleX_Delta=-.1;else this.Transform.ScaleX_Delta=.1}this.Transform.ScaleY_Tgt=scaleY_tgt;this.Transform.ScaleY_Delta=(scaleY_tgt-this.Host.Sprite.scale.y)/steps;if(this.Transform.ScaleY_Delta==0&&scaleY_tgt!=this.Host.Sprite.scale.y){if(scaleY_tgt<this.Host.Sprite.scale.y)this.Transform.ScaleY_Delta=-.1;else this.Transform.ScaleY_Delta=.1}this.Transform.StatusFlag|=SpriteTransformer.MASK_SCALING_1;this.Transform.ResetCoords=false};SpriteTransformer.prototype.ScaleAndBack=function(scale_tgt,steps,time,flags){this.Transform.Scale_Min=this.Host.Sprite.scale.x;this.Transform.Scale_Max=scale_tgt;this.ScaleAbs(scale_tgt,scale_tgt,steps,time,flags);this.Transform.StatusFlag|=SpriteTransformer.MASK_SCALING_2;if((flags&SpriteTransformer.MASK_BACK_TO_ORG)!=0)this.Transform.ResetCoords=true};SpriteTransformer.prototype.ScaleAndGoto=function(scale_tgt,scale_bck,steps,time,flags){this.Transform.Scale_Min=scale_bck;this.Transform.Scale_Max=scale_tgt;this.ScaleAbs(scale_tgt,scale_tgt,steps,time,SpriteTransformer.MASK_NONE);this.Transform.StatusFlag|=SpriteTransformer.MASK_SCALING_2;if((flags&SpriteTransformer.MASK_BACK_TO_ORG)!=0)this.Transform.ResetCoords=true};SpriteTransformer.prototype.ScaleLoop=function(scale_min,scale_max,steps,time,flags){this.Transform.Scale_Min=scale_min;this.Transform.Scale_Max=scale_max;this.ScaleAbs(scale_max,scale_max,steps,time,flags);this.Transform.StatusFlag|=SpriteTransformer.MASK_SCALING_1|SpriteTransformer.MASK_SCALING_3;if((flags&SpriteTransformer.MASK_BACK_TO_ORG)!=0)this.Transform.ResetCoords=true};SpriteTransformer.prototype.AnimateRel=function(num_frames,ani_flags,time){this.Transform.Anim_Frame_Tgt=this.Host.CurFrame+num_frames;this.Transform.TimeAnimation=time;this.Transform.TimerAnimation=0;this.Transform.Anim_Flags=ani_flags;this.Transform.StatusFlag|=SpriteTransformer.MASK_ANIMATING};SpriteTransformer.prototype.AnimateRel=function(to_frame,ani_flags,time){this.Transform.Anim_Frame_Tgt=to_frame;this.Transform.TimeAnimation=time;this.Transform.TimerAnimation=0;this.Transform.Anim_Flags=ani_flags;this.Transform.StatusFlag|=SpriteTransformer.MASK_ANIMATING};SpriteTransformer.prototype.AnimateAbs=function(from_frame,to_frame,ani_flags,time){this.Host.SetFrame(from_frame);this.Transform.Anim_Frame_Tgt=to_frame;this.Transform.TimeAnimation=time;this.Transform.TimerAnimation=0;this.Transform.Anim_Flags=ani_flags;this.Transform.StatusFlag|=SpriteTransformer.MASK_ANIMATING};SpriteTransformer.prototype.ResetAtEnd=function(set_visible,set_frame,rel_x,rel_y,abs_alpha,abs_scale){this.Transform.End_Visible=set_visible;this.Transform.End_Frame=set_frame;this.Transform.End_Abs_Scale=abs_scale;this.Transform.End_Abs_Alpha=abs_alpha;this.Transform.End_Rel_X=rel_x;this.Transform.End_Rel_Y=rel_y;this.Transform.StatusFlag|=SpriteTransformer.MASK_RESET_END};SpriteTransformer.prototype.RemoveAtEnd=function(){this.Transform.StatusFlag|=SpriteTransformer.MASK_REMOVE_END};SpriteTransformer.prototype.GetStatus=function(){return this.Transform.StatusFlag&~SpriteTransformer.MASK_ROTATING};SpriteTransformer.prototype.CheckStatus=function(msk){return(this.Transform.StatusFlag&msk)!=0};SpriteTransformer.prototype.Stop=function(){if((this.Transform.StatusFlag&(SpriteTransformer.MASK_ROTATING|SpriteTransformer.MASK_DEFORMATING))!=0){this.AnchorPoint_OFF()}if(this.Transform.ResetCoords==true){if(this.Transform.StatusFlag&(SpriteTransformer.MASK_SCALING|SpriteTransformer.MASK_DEFORMATING)!=0){this.Host.Sprite.scale.x=this.Transform.ScaleX_Org;this.Host.Sprite.scale.y=this.Transform.ScaleY_Org}this.Host.Sprite.x=this.Transform.Starting_xx;this.Host.Sprite.y=this.Transform.Starting_yy;this.Transform.ResetCoords=false}this.Transform.RemoveColorFilter();this.Transform.StatusFlag=SpriteTransformer.MASK_NONE};SpriteTransformer.prototype.Refresh=function(ellapsed_ms){this.Transform.RefreshTimers(ellapsed_ms);if((this.Transform.StatusFlag&SpriteTransformer.MASK_PAUSE)!=0){if(this.Transform.TimerPause!=0)return;this.Transform.StatusFlag&=~SpriteTransformer.MASK_PAUSE}if((this.Transform.StatusFlag&SpriteTransformer.MASK_ANIMATING)!=0){this.ACTION_Animate()}if((this.Transform.StatusFlag&SpriteTransformer.MASK_MOVING_3)==SpriteTransformer.MASK_MOVING_3){this.ACTION_MoveEx()}else if((this.Transform.StatusFlag&SpriteTransformer.MASK_MOVING_1)!=0){this.ACTION_Move()}if((this.Transform.StatusFlag&SpriteTransformer.MASK_FADING)!=0){this.ACTION_Fade()}if((this.Transform.StatusFlag&SpriteTransformer.MASK_SCALING)!=0){this.ACTION_Scale()}if((this.Transform.StatusFlag&SpriteTransformer.MASK_LIGHTING)!=0){this.ACTION_Light()}if((this.Transform.StatusFlag&SpriteTransformer.MASK_ROTATING)!=0){this.ACTION_Rotate()}if((this.Transform.StatusFlag&SpriteTransformer.MASK_DEFORMATING)!=0){this.ACTION_Deformate()}if((this.Transform.StatusFlag&SpriteTransformer.MASK_RESET_END)!=0){this.ACTION_ResetAtEnd()}};SpriteTransformer.prototype.ACTION_Animate=function(){var Update=false;if(this.Transform.TimerAnimation!=0)return;if(this.Transform.Anim_Frame_Tgt>this.Host.CurFrame){this.Host.SetFrame(++this.Host.CurFrame);Update=true}else if(this.Transform.Anim_Frame_Tgt<this.Host.CurFrame){this.Host.SetFrame(--this.Host.CurFrame);Update=true}else{if((this.Transform.Anim_Flags&SpriteTransformer.ANIMATION_LOOP)!=0){this.Host.CurFrame=this.Transform.Anim_Flags&~SpriteTransformer.ANIMATION_LOOP;this.Host.SetFrame(this.Host.CurFrame);Update=true}else if((this.Transform.Anim_Flags&SpriteTransformer.ANIMATION_LOOPBACK)!=0){if(this.Host.CurFrame==(this.Transform.Anim_Flags&~SpriteTransformer.ANIMATION_LOOPBACK)){this.Host.CurFrame++;this.Transform.Anim_Frame_Tgt=this.Transform.Anim_Frame_Tgt_Org}else{this.Host.CurFrame--;this.Transform.Anim_Frame_Tgt_Org=this.Transform.Anim_Frame_Tgt;this.Transform.Anim_Frame_Tgt=this.Transform.Anim_Flags&~SpriteTransformer.ANIMATION_LOOPBACK}Update=true}else{if((this.Transform.Anim_Flags&SpriteTransformer.ANIMATION_CLRE)!=0){this.Host.Visible(false)}else if((this.Transform.Anim_Flags&SpriteTransformer.ANIMATION_DELT)!=0&&this.Host.Sprite.alpha==0){this.Host.Visible(false)}}}if(Update==true){this.Host.SetFrame(this.Host.CurFrame);this.Transform.TimerAnimation=this.ArmaTimer(this.Transform.TimerAnimation,this.Transform.TimeAnimation)}else{this.Transform.TimerAnimation=0;this.Transform.StatusFlag&=~SpriteTransformer.MASK_ANIMATING}};SpriteTransformer.prototype.ACTION_Rotate=function(){var Rotating=true;if(this.Transform.TimerRotation!=0)return;if((this.Transform.StatusFlag&SpriteTransformer.MASK_ROTATING_L)!=0){this.Host.Sprite.rotation+=this.Transform.Rotation_Delta;if(this.Transform.Rotation_Target!=255){if(this.Host.Sprite.rotation>=Lib.radians(360)){this.Host.Sprite.rotation-=Lib.radians(360);if(this.Transform.Rotation_Target!=0)this.Transform.Rotation_Target--;if(this.Transform.Rotation_Target==0)Rotating=false}}}else{this.Host.Sprite.rotation+=this.Transform.Rotation_Delta;if(this.Transform.Rotation_Delta<0&&this.Host.Sprite.rotation<=this.Transform.Rotation_Target){Rotating=false}else if(this.Transform.Rotation_Delta>0&&this.Host.Sprite.rotation>=this.Transform.Rotation_Target){Rotating=false}}if(Rotating==true){this.Transform.TimerRotating=this.ArmaTimer(this.Transform.TimerRotating,this.Transform.TimeRotating)}else{this.Transform.TimerMoving=0;this.Transform.StatusFlag&=~SpriteTransformer.MASK_ROTATING;this.AnchorPoint_OFF()}};SpriteTransformer.prototype.ACTION_MoveEx=function(){var MoveX,MoveY;var old_xx,old_yy;if(this.Transform.TimerMoving!=0)return;MoveX=false;MoveY=false;old_xx=this.Host.Sprite.x;old_yy=this.Host.Sprite.y;if(this.Host.Sprite.x!=this.Transform.Target_xx&&this.Transform.Delta_xx!=0){this.Host.Sprite.x+=this.Transform.Delta_xx;if(this.Transform.Delta_xx<0){if(this.Host.Sprite.x<this.Transform.Target_xx)this.Host.Sprite.x=this.Transform.Target_xx}else{if(this.Host.Sprite.x>this.Transform.Target_xx)this.Host.Sprite.x=this.Transform.Target_xx}MoveX=true}if(this.Host.Sprite.y!=this.Transform.Target_yy&&this.Transform.Delta_yy!=0){this.Host.Sprite.y+=this.Transform.Delta_yy;if(this.Transform.Delta_yy<0){if(this.Host.Sprite.y<this.Transform.Target_yy)this.Host.Sprite.y=this.Transform.Target_yy}else{if(this.Host.Sprite.y>this.Transform.Target_yy)this.Host.Sprite.y=this.Transform.Target_yy}MoveY=true}if(MoveX==false&&MoveY==false){if((this.Transform.StatusFlag&SpriteTransformer.MASK_MOVING_1)!=0){this.Transform.StatusFlag&=~SpriteTransformer.MASK_MOVING_1;this.Transform.StatusFlag|=SpriteTransformer.MASK_MOVING_2;this.End_Rel_X=this.Transform.Target_xx;this.End_Rel_Y=this.Transform.Target_yy;this.Transform.Target_xx=this.Transform.Starting_xx;this.Transform.Target_yy=this.Transform.Starting_yy}else{this.Transform.StatusFlag&=~SpriteTransformer.MASK_MOVING_2;this.Transform.StatusFlag|=SpriteTransformer.MASK_MOVING_1;this.Host.Sprite.x=this.Transform.Target_xx;this.Host.Sprite.y=this.Transform.Target_yy;this.Transform.Target_xx=this.End_Rel_X;this.Transform.Target_yy=this.End_Rel_Y}this.Transform.Delta_xx*=-1;this.Transform.Delta_yy*=-1}this.Transform.TimerMoving=this.ArmaTimer(this.Transform.TimerMoving,this.Transform.TimeMoving)};SpriteTransformer.prototype.ACTION_Move=function(){var MoveX,MoveY;var old_xx,old_yy;if(this.Transform.TimerMoving!=0)return;MoveX=false;MoveY=false;old_xx=this.Host.Sprite.x;old_yy=this.Host.Sprite.y;if(this.Host.Sprite.x!=this.Transform.Target_xx&&this.Transform.Delta_xx!=0){this.Host.Sprite.x+=this.Transform.Delta_xx;if(this.Transform.Delta_xx<0){if(this.Host.Sprite.x<this.Transform.Target_xx)this.Host.Sprite.x=this.Transform.Target_xx}else{if(this.Host.Sprite.x>this.Transform.Target_xx)this.Host.Sprite.x=this.Transform.Target_xx}MoveX=true}if(this.Host.Sprite.y!=this.Transform.Target_yy&&this.Transform.Delta_yy!=0){this.Host.Sprite.y+=this.Transform.Delta_yy;if(this.Transform.Delta_yy<0){if(this.Host.Sprite.y<this.Transform.Target_yy)this.Host.Sprite.y=this.Transform.Target_yy}else{if(this.Host.Sprite.y>this.Transform.Target_yy)this.Host.Sprite.y=this.Transform.Target_yy}MoveY=true}if(MoveX==true||MoveY==true){this.Transform.TimerMoving=this.ArmaTimer(this.Transform.TimerMoving,this.Transform.TimeMoving)}else{this.Transform.TimerMoving=0;this.Transform.StatusFlag&=~SpriteTransformer.MASK_MOVING}};SpriteTransformer.prototype.ACTION_Fade=function(){var Update=false;if(this.Transform.TimerFade!=0)return;if(this.Transform.Alpha_Tgt!=this.Host.Sprite.alpha){Update=true;this.Host.Sprite.alpha+=this.Transform.Alpha_Step;if(this.Transform.Alpha_Step<0){if(this.Host.Sprite.alpha<this.Transform.Alpha_Tgt)this.Host.Sprite.alpha=this.Transform.Alpha_Tgt}else{if(this.Host.Sprite.alpha>this.Transform.Alpha_Tgt)this.Host.Sprite.alpha=this.Transform.Alpha_Tgt}if(this.Host.Sprite.alpha>1){this.Host.Sprite.alpha=1;this.Transform.Alpha_Tgt=1}else if(this.Host.Sprite.alpha<0){this.Host.Sprite.alpha=0;this.Transform.Alpha_Tgt=0}}if(Update==false){if((this.Transform.StatusFlag&SpriteTransformer.MASK_FADING_3)!=0){if((this.Transform.StatusFlag&SpriteTransformer.MASK_FADING_1)!=0){this.Transform.StatusFlag&=~SpriteTransformer.MASK_FADING_1;this.Transform.Alpha_Tmp=this.Transform.Alpha_Tgt;this.Transform.Alpha_Tgt=this.Transform.Alpha_Org;this.Transform.StatusFlag|=SpriteTransformer.MASK_FADING_2}else{this.Host.Sprite.alpha=this.Transform.Alpha_Tgt;this.Transform.Alpha_Tgt=this.Transform.Alpha_Tmp;this.Transform.StatusFlag&=~SpriteTransformer.MASK_FADING_2;this.Transform.StatusFlag|=SpriteTransformer.MASK_FADING_1}this.Transform.Alpha_Step*=-1}else if(this.Transform.StatusFlag&SpriteTransformer.MASK_FADING_2){this.Host.Sprite.alpha=this.Transform.Alpha_Tgt;this.Transform.Alpha_Tgt=this.Transform.Alpha_Tmp;this.Transform.StatusFlag&=~SpriteTransformer.MASK_FADING_2;this.Transform.StatusFlag|=SpriteTransformer.MASK_FADING_1;this.Transform.Alpha_Step*=-1}else{this.Transform.TimerFade=0;this.Transform.StatusFlag&=~SpriteTransformer.MASK_FADING}}this.Transform.TimerFade=this.ArmaTimer(this.Transform.TimerFade,this.Transform.TimeFade)};SpriteTransformer.prototype.ACTION_Scale=function(){var Update=false;var old_W,old_H;if(this.Transform.TimerScale!=0)return;old_H=this.Host.FrameH*this.Host.Sprite.scale.y;old_W=this.Host.FrameW*this.Host.Sprite.scale.x;if(this.Transform.ScaleX_Tgt!=this.Host.Sprite.scale.x){Update=true;this.Host.Sprite.scale.x+=this.Transform.ScaleX_Delta;if(this.Transform.ScaleX_Delta<0){if(this.Host.Sprite.scale.x<this.Transform.ScaleX_Tgt)this.Host.Sprite.scale.x=this.Transform.ScaleX_Tgt}else{if(this.Host.Sprite.scale.x>this.Transform.ScaleX_Tgt)this.Host.Sprite.scale.x=this.Transform.ScaleX_Tgt}this.RecenterX(old_W)}if(this.Transform.ScaleY_Tgt!=this.Host.Sprite.scale.y){Update=true;this.Host.Sprite.scale.y+=this.Transform.ScaleY_Delta;if(this.Transform.ScaleY_Delta<0){if(this.Host.Sprite.scale.y<this.Transform.ScaleY_Tgt)this.Host.Sprite.scale.y=this.Transform.ScaleY_Tgt}else{if(this.Host.Sprite.scale.y>this.Transform.ScaleY_Tgt)this.Host.Sprite.scale.y=this.Transform.ScaleY_Tgt}this.RecenterY(old_H)}if(Update==true){this.Transform.TimerScale=this.ArmaTimer(this.Transform.TimerScale,this.Transform.TimeScale)}else{this.Transform.TimerScale=0;if(this.Transform.StatusFlag&SpriteTransformer.MASK_SCALING_3){this.Transform.ScaleX_Delta*=-1;this.Transform.ScaleY_Delta*=-1;if((this.Transform.StatusFlag&SpriteTransformer.MASK_SCALING_1)!=0){this.Transform.ScaleX_Tgt=this.Transform.Scale_Min;this.Transform.ScaleY_Tgt=this.Transform.Scale_Min;this.Transform.StatusFlag&=~SpriteTransformer.MASK_SCALING_1;this.Transform.StatusFlag|=SpriteTransformer.MASK_SCALING_2}else{this.Transform.ScaleX_Tgt=this.Transform.Scale_Max;this.Transform.ScaleY_Tgt=this.Transform.Scale_Max;this.Transform.StatusFlag&=~SpriteTransformer.MASK_SCALING_2;this.Transform.StatusFlag|=SpriteTransformer.MASK_SCALING_1}}else if(this.Transform.StatusFlag&SpriteTransformer.MASK_SCALING_2){this.Transform.ScaleX_Tgt=this.Transform.Scale_Min;this.Transform.ScaleY_Tgt=this.Transform.Scale_Min;this.Transform.ScaleX_Delta*=-1;this.Transform.ScaleY_Delta*=-1;this.Transform.StatusFlag&=~SpriteTransformer.MASK_SCALING;this.Transform.StatusFlag|=SpriteTransformer.MASK_SCALING_1}else{if(this.Transform.ResetCoords==true){this.Host.Sprite.x=this.Transform.Starting_xx;this.Host.Sprite.y=this.Transform.Starting_yy}this.Transform.StatusFlag&=~SpriteTransformer.MASK_SCALING}}};SpriteTransformer.prototype.ACTION_Light=function(){var Update=false;if(this.Transform.TimerLight!=0)return;if(this.Transform.Bright_Tgt!=this.Transform.Bright_Cur){Update=true;this.Transform.Bright_Cur+=this.Transform.Bright_Step;if(this.Transform.Bright_Step<0){if(this.Transform.Bright_Cur<this.Transform.Bright_Tgt)this.Transform.Bright_Cur=this.Transform.Bright_Tgt}else{if(this.Transform.Bright_Cur>this.Transform.Bright_Tgt)this.Transform.Bright_Cur=this.Transform.Bright_Tgt}}if(Update==true){this.Transform.TimerLight=this.ArmaTimer(this.Transform.TimerLight,this.Transform.TimeLight);this.Transform.ApplyColorFilter()}else{if((this.Transform.StatusFlag&SpriteTransformer.MASK_LIGHTING_3)!=0){this.Transform.Bright_Step=this.Transform.Bright_Step*-1;if((this.Transform.StatusFlag&SpriteTransformer.MASK_LIGHTING_1)!=0){this.Transform.Bright_Tgt=1;this.Transform.StatusFlag&=~SpriteTransformer.MASK_LIGHTING_1;this.Transform.StatusFlag|=SpriteTransformer.MASK_LIGHTING_2}else{this.Transform.Bright_Tgt=this.Transform.Bright_Tgt_Org;this.Transform.StatusFlag&=~SpriteTransformer.MASK_LIGHTING_2;this.Transform.StatusFlag|=SpriteTransformer.MASK_LIGHTING_1}}else if(this.Transform.StatusFlag&SpriteTransformer.MASK_LIGHTING_2){this.Transform.Bright_Tgt=1;this.Transform.Bright_Step=this.Transform.Bright_Step*-1;this.Transform.StatusFlag&=~SpriteTransformer.MASK_LIGHTING_2;this.Transform.StatusFlag|=SpriteTransformer.MASK_LIGHTING_1}else{this.Transform.TimerLight=0;this.Transform.StatusFlag&=~SpriteTransformer.MASK_LIGHTING;this.Transform.RemoveColorFilter()}}};SpriteTransformer.prototype.RecenterX=function(old_width){var new_width,delta_x;if(this.Transform.AnchorSet==false){new_width=this.Host.FrameW*this.Host.Sprite.scale.x;delta_x=(new_width-old_width)/2;this.Host.Sprite.x-=delta_x}};SpriteTransformer.prototype.RecenterY=function(old_height){var new_height,delta_y;if(this.Transform.AnchorSet==false){new_height=this.Host.FrameH*this.Host.Sprite.scale.y;delta_y=(new_height-old_height)/2;this.Host.Sprite.y-=delta_y}};SpriteTransformer.prototype.ACTION_ResetAtEnd=function(){};SpriteTransformer.prototype.AnchorPoint_ON=function(){this.Host.Sprite.anchor.set(.5);this.Host.Sprite.x+=this.Host.FrameW*this.Host.Sprite.scale.x/2;this.Host.Sprite.y+=this.Host.FrameH*this.Host.Sprite.scale.y/2;this.Transform.AnchorSet=true};SpriteTransformer.prototype.AnchorPoint_OFF=function(){this.Host.Sprite.rotation=0;this.Host.Sprite.anchor.set(0);this.Host.Sprite.x-=this.Host.FrameW*this.Host.Sprite.scale.x/2;this.Host.Sprite.y-=this.Host.FrameH*this.Host.Sprite.scale.y/2;this.Transform.AnchorSet=false};TiledSprite.MASK_STAT_NONE=0;TiledSprite.MASK_STAT_GRAY=1;TiledSprite.MASK_STAT_HIGHLIGHT=2;TiledSprite.MASK_STAT_DARKEN=4;TiledSprite.MASK_STAT_SEPIA=8;TiledSprite.MASK_STAT_OUTLINE_BORD=16;TiledSprite.MASK_STAT_OUTLINE_GLOW=32;TiledSprite.MASK_STAT_GREEN=64;TiledSprite.MASK_BUTT_NONE=0;TiledSprite.MASK_BUTT_ENABLED=2;TiledSprite.MASK_BUTT_PUSHED=4;TiledSprite.MASK_BUTT_OVER=8;TiledSprite.MASK_BUTT_OUT=16;TiledSprite.OutlineFilterBorder=null;TiledSprite.OutlineFilterGlow=null;function TiledSprite(res_name,tot_frames,start_visible,parent_container,extension=".png"){SObject.call(this);this.ResName=res_name;this.CurFrame=0;this.TotFrames=tot_frames;this.StartVisible=start_visible;this.Texture=null;this.Sprite=null;this.Frames=[];this.FrameW=0;this.FrameH=0;this.ScaleX=1;this.ScaleY=1;this.MaskButton=TiledSprite.MASK_BUTT_NONE;this.MaskStatus=TiledSprite.MASK_STAT_NONE;this.MaskStatus=TiledSprite.MASK_STAT_NONE;this.ParentContainer=parent_container;this.SpriteTransformer=null;this.extension=extension}TiledSprite.prototype=Object.create(SObject.prototype);TiledSprite.prototype.constructor=TiledSprite;TiledSprite.prototype.BuildSprite=function(){this.Frames=new Array;if(this.TotFrames==1){this.Frames.push(PIXI.Texture.fromFrame(this.ResName+this.extension))}else{for(var i=0;i<this.TotFrames;i++){var val=i<10?"0"+i:i;this.Frames.push(PIXI.Texture.fromFrame(this.ResName+val+this.extension))}}this.Sprite=new PIXI.extras.AnimatedSprite(this.Frames);this.ASSERT(this.Sprite!=null,"Sprite instance fail.");this.SetFrame(0)};TiledSprite.prototype.Setup=function(){this.BuildSprite();this.Sprite.visible=this.StartVisible;this.SetFrame(0);this.SpriteTransformer=new SpriteTransformer(this);if(this.ParentContainer!=null)this.ParentContainer.addChild(this.Sprite)};TiledSprite.prototype.SetNewTile=function(res_name,tot_frames,extension=".png"){this.ResName=res_name;this.TotFrames=tot_frames;this.extension=extension;if(this.contains(this.Sprite)==true)this.ParentContainer.removeChild(this.Sprite);this.BuildSprite();this.ParentContainer.addChild(this.Sprite)};TiledSprite.prototype.SetNewTileAt=function(res_name,tot_frames,child_pos,extension=".png"){this.ResName=res_name;this.TotFrames=tot_frames;this.extension=extension;if(this.contains(this.Sprite)==true)this.ParentContainer.removeChild(this.Sprite);this.BuildSprite();this.ParentContainer.addChildAt(this.Sprite,child_pos)};TiledSprite.prototype.GetSprite=function(){return this.Sprite};TiledSprite.prototype.Visible=function(vsb){this.Sprite.visible=vsb};TiledSprite.prototype.IsVisible=function(vsb){return this.Sprite.visible};TiledSprite.prototype.SetContainer=function(parent_container){this.ParentContainer=parent_container};TiledSprite.prototype.GetContainer=function(){return this.ParentContainer};TiledSprite.prototype.SetFrame=function(frame_index){this.CurFrame=frame_index;this.Sprite.gotoAndStop(frame_index);this.FrameW=this.Frames[frame_index].width;this.FrameH=this.Frames[frame_index].height};TiledSprite.prototype.ChangeFrame=function(frame_index,res_name){if(this.TotFrames==1){this.Frames[frame_index]=PIXI.Texture.fromFrame(res_name+this.extension)}else{var val=frame_index<10?"0"+frame_index:frame_index;this.Frames[frame_index]=PIXI.Texture.fromFrame(res_name+val+this.extension)}this.Sprite.textures[frame_index]=this.Frames[frame_index]};TiledSprite.prototype.ResetProperties=function(visible_set,alpha_set,scale_set){if(this.Sprite!=null){this.Sprite.visible=visible_set;this.Sprite.alpha=alpha_set;this.SCALE(scale_set)}this.MaskButton=TiledSprite.MASK_BUTT_NONE};TiledSprite.prototype.XX=function(xx,offs){this.Sprite.x=xx+offs};TiledSprite.prototype.YY=function(yy,offs){this.Sprite.y=yy+offs};TiledSprite.prototype.ScaleApply=function(){if(this.Sprite!=null)this.Sprite.scale=new PIXI.Point(this.ScaleX,this.ScaleY)};TiledSprite.prototype.SCALE=function(scale){this.ScaleX=scale;this.ScaleY=scale;this.ScaleApply()};TiledSprite.prototype.SCALE_X=function(scale){this.ScaleX=scale;this.ScaleApply()};TiledSprite.prototype.SCALE_Y=function(scale){this.ScaleY=scale;this.ScaleApply()};TiledSprite.prototype.ACTUAL_W=function(){return this.Sprite.width};TiledSprite.prototype.ACTUAL_H=function(){return this.Sprite.height};TiledSprite.prototype.contains=function(child){if(this.ParentContainer==null)return false;return this.ParentContainer.children.indexOf(child)!==-1};TiledSprite.prototype.IsChildOf=function(father){return father.children.indexOf(this.Sprite)!==-1};TiledSprite.prototype.LinkTo=function(parent_container){
if(this.contains(this.Sprite)==true)this.StopUnlink();this.ParentContainer=parent_container;this.ParentContainer.addChild(this.Sprite)};TiledSprite.prototype.Animate=function(start_frame,ani_speed,loop_back){this.Stop();this.Sprite.animationSpeed=ani_speed;this.Sprite.loop=loop_back;this.Sprite.gotoAndPlay(start_frame)};TiledSprite.prototype.Stop=function(){this.Sprite.gotoAndStop(0)};TiledSprite.prototype.ResetToTop=function(){if(this.ParentStage!=null){this.ParentStage.removeChild(this.Container);this.ParentStage.addChild(this.Container)}};TiledSprite.prototype.StopUnlink=function(){this.Stop();this.StopTransform();if(this.contains(this.Sprite)==true)this.ParentContainer.removeChild(this.Sprite)};TiledSprite.prototype.LinkToParent=function(){this.Stop();this.StopTransform();if(this.contains(this.Sprite)==false)this.ParentContainer.addChild(this.Sprite)};TiledSprite.prototype.CenterBox=function(width_box,height_box,use_actual_scale){var offs_X,offs_Y,ww,hh;this.Sprite.x=0;this.Sprite.y=0;if(use_actual_scale==true)ww=this.Sprite.width;else ww=this.FrameW;if(width_box!=0)offs_X=(width_box-ww)/2;else offs_X=0;if(use_actual_scale==true)hh=this.Sprite.height;else hh=this.FrameH;if(height_box!=0)offs_Y=(height_box-hh)/2;else offs_Y=0;this.Sprite.x+=parseInt(offs_X);this.Sprite.y+=parseInt(offs_Y)};TiledSprite.prototype.CenterBoxOnSprite=function(container_sprite){var offs_X,offs_Y,ww,hh;var width_box=container_sprite.GetSprite().width;var height_box=container_sprite.GetSprite().height;this.Sprite.x=0;this.Sprite.y=0;ww=this.FrameW*this.Sprite.scale.x;hh=this.FrameH*this.Sprite.scale.y;if(width_box!=0)offs_X=(width_box-ww)/2;else offs_X=0;if(height_box!=0)offs_Y=(height_box-hh)/2;else offs_Y=0;this.Sprite.x=container_sprite.Sprite.x+parseInt(offs_X);this.Sprite.y=container_sprite.Sprite.y+parseInt(offs_Y)};TiledSprite.prototype.GetButtStatus=function(){return this.MaskButton};TiledSprite.prototype.GetMaskStatus=function(){return this.MaskStatus};TiledSprite.prototype.CheckButtStatus=function(flag){if((this.MaskButton&flag)!=0){this.MaskButton&=~flag;return true}return false};TiledSprite.prototype.SetButton=function(enable){var self=this;if(enable==true){this.Sprite.mousedown=function(data){if(self.MaskButton&TiledSprite.MASK_BUTT_ENABLED){self.MaskButton|=TiledSprite.MASK_BUTT_PUSHED}};this.Sprite.touchend=function(data){if(self.MaskButton&TiledSprite.MASK_BUTT_ENABLED){self.MaskButton|=TiledSprite.MASK_BUTT_PUSHED}};this.Sprite.mouseover=function(data){if(self.MaskButton&TiledSprite.MASK_BUTT_ENABLED){self.MaskButton|=TiledSprite.MASK_BUTT_OVER}};this.Sprite.mouseout=function(data){if(self.MaskButton&TiledSprite.MASK_BUTT_ENABLED){self.MaskButton|=TiledSprite.MASK_BUTT_OUT}};this.Sprite.interactive=true;this.Sprite.buttonMode=true;this.MaskButton=TiledSprite.MASK_BUTT_ENABLED}else{this.Sprite.mousedown=null;this.Sprite.touchend=null;this.Sprite.mouseover=null;this.Sprite.mouseout=null;this.Sprite.interactive=false;this.Sprite.buttonMode=false;this.MaskButton=TiledSprite.MASK_BUTT_NONE}};TiledSprite.prototype.Refresh=function(ellapsed_ms){if(this.SpriteTransformer!=null)this.SpriteTransformer.Refresh(ellapsed_ms)};TiledSprite.prototype.StopTransform=function(){if(this.SpriteTransformer!=null)this.SpriteTransformer.Stop()};TiledSprite.prototype.TransformOver=function(){if(this.SpriteTransformer!=null){if(this.SpriteTransformer.GetStatus()==SpriteTransformer.MASK_NONE)return true;return false}return true};TiledSprite.prototype.SPRITE_TRANSFORMER=function(){return this.SpriteTransformer};TiledSprite.prototype.SetMaskFilter=function(mask_type){var colorMatrix=null;var unityMatrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];if(this.MaskStatus!=0||mask_type==TiledSprite.MASK_STAT_NONE){this.Sprite.filters=null;this.MaskStatus=TiledSprite.MASK_STAT_NONE}switch(mask_type){case TiledSprite.MASK_STAT_GRAY:{colorMatrix=new PIXI.filters.ColorMatrixFilter;colorMatrix.greyscale(.5,false)}break;case TiledSprite.MASK_STAT_RED:{colorMatrix=new PIXI.filters.ColorMatrixFilter;unityMatrix[4]=1;colorMatrix.matrix=unityMatrix}break;case TiledSprite.MASK_STAT_GREEN:{colorMatrix=new PIXI.filters.ColorMatrixFilter;unityMatrix[9]=1;colorMatrix.matrix=unityMatrix}break;case TiledSprite.MASK_STAT_HIGHLIGHT:{colorMatrix=new PIXI.filters.ColorMatrixFilter;colorMatrix.saturate(2,false)}break;case TiledSprite.MASK_STAT_DARKEN:{colorMatrix=new PIXI.filters.ColorMatrixFilter;colorMatrix.brightness(.4,false)}break;case TiledSprite.MASK_STAT_SEPIA:{colorMatrix=new PIXI.filters.ColorMatrixFilter;colorMatrix.sepia(false)}break;case TiledSprite.MASK_STAT_OUTLINE_BORD:{}break;case TiledSprite.MASK_STAT_OUTLINE_GLOW:{}break;default:{}break}if(colorMatrix!=null)this.Sprite.filters=[colorMatrix];this.MaskStatus|=mask_type};SlotLine.SourceID=0;SlotLine.LINES_X=174;SlotLine.TAB_LINES_Y=[489,239,749,154,175,174,399,210,210,253,199,128,568,150,410,223,486,258,260,159];SlotLine.TAB_CAPTIONS=[["LINE ","LINEA "],[" WINS BONUS"," VINCE BONUS"],[" WINS "," VINCE "],[" COINS"," GETTONI"]];function SlotLine(parent_container,app_reference){var str;SObject.call(this);this.ApplicationRef=app_reference;this.ParentStage=parent_container;this.LineContainer=new PIXI.Container;this.SlotComboRef=null;this.ID=SlotLine.SourceID++;this.DisplayWinRef=null;this.DisplayLineRef=null;this.SymbolsWinRef=null;str="PayLine"+(this.ID<10?"A":"B");str+="0"+parseInt(this.ID%10);this.LineSprite=new TiledSprite(str,1,false,this.ApplicationRef.SLOT().REEL_HOLDER().CONTAINER(),".webp")}SlotLine.prototype=Object.create(SObject.prototype);SlotLine.prototype.constructor=SlotLine;SlotLine.prototype.Init=function(p_pDisplayWin,p_pDisplayLine,p_pSpriteDisplayLine,p_pSymbols){this.SlotComboRef=this.ApplicationRef.SLOT().SLOT_COMBO();this.DisplayWinRef=p_pDisplayWin;this.SpriteWinLineRef=p_pSpriteDisplayLine;this.DisplayLineRef=p_pDisplayLine;this.SymbolsWinRef=p_pSymbols;this.LineSprite.Setup();this.LineSprite.SCALE_X(1.1);this.LineSprite.XX(SlotLine.LINES_X,0);this.LineSprite.YY(SlotLine.TAB_LINES_Y[this.ID],0)};SlotLine.prototype.Draw=function(win){this.SetupLineWinDisplay(win);this.ReelsHighlight(true);this.OnLineWin(win);this.LineSprite.Visible(true)};SlotLine.prototype.Clear=function(){this.DisplayWinRef.Visible(false);this.DisplayLineRef.Visible(false);this.DisplayLineRef.StopTransform();if(this.SpriteWinLineRef!=null){this.SpriteWinLineRef.StopTransform();this.SpriteWinLineRef.Visible(false)}this.ReelsHighlight(false);this.LineSprite.Visible(false)};SlotLine.prototype.ReelsHighlight=function(enb){var i,j,sym_ID;if(enb==true){for(i=0;i<window.NUM_REELS;i++){this.SymbolsWinRef[i].Visible(false)}for(i=window.NUM_REELS-1,j=0;i>=0;i--){if(this.SlotComboRef.SimboliVincenti[this.ID][i]!=0){this.ApplicationRef.SLOT().REEL_HOLDER().RulloOut(SlotCombo.TAB_LINES[this.ID][i]);sym_ID=this.SlotComboRef.SimboliEstratti[SlotCombo.TAB_LINES[this.ID][i]];this.SymbolsWinRef[j].SetFrame(parseInt(sym_ID-window.ID_SIMBOLO_0));this.SymbolsWinRef[j].Visible(true);j++}}}else{for(i=0;i<window.NUM_REELS;i++){if(this.SlotComboRef.SimboliVincenti[this.ID][i]!=0){this.ApplicationRef.SLOT().REEL_HOLDER().RulloIn(SlotCombo.TAB_LINES[this.ID][i]);this.SymbolsWinRef[i].Visible(false)}}}if(enb==true){}};SlotLine.prototype.SetupLineWinDisplay=function(win){var xx,yy,idx_reel,multy,win_base;var bonus_line;this.DisplayWinRef.ResetCaption();bonus_line=this.ApplicationRef.SLOT().SLOT_COMBO().GetSimboloCombinazione(this.ApplicationRef.SLOT().SLOT_COMBO().DirettriciVincenti[this.ID])==window.ID_SIMBOLO_BONUS;if(bonus_line==true){this.DisplayWinRef.SetCaption(SlotLine.TAB_CAPTIONS[0][window.LANG]+(this.ID+1)+SlotLine.TAB_CAPTIONS[1][window.LANG])}else{multy=this.ApplicationRef.SLOT().SLOT_COMBO().DirettriciMoltiplicatore[this.ID];if(multy>1){win_base=win/multy;this.DisplayWinRef.SetCaption(SlotLine.TAB_CAPTIONS[0][window.LANG]+(this.ID+1)+SlotLine.TAB_CAPTIONS[2][window.LANG]+win_base.toString()+" X"+multy.toString()+" = "+win.toString()+SlotLine.TAB_CAPTIONS[3][window.LANG])}else this.DisplayWinRef.SetCaption(SlotLine.TAB_CAPTIONS[0][window.LANG]+(this.ID+1)+SlotLine.TAB_CAPTIONS[2][window.LANG]+win.toString()+SlotLine.TAB_CAPTIONS[3][window.LANG])}this.DisplayWinRef.Visible(true);if(this.DisplayLineRef!=null){if(win==0){this.DisplayLineRef.Visible(false)}else{this.SpriteWinLineRef.StopTransform();this.SpriteWinLineRef.ResetToTop();this.SpriteWinLineRef.ResetProperties(true,1,.2);this.DisplayLineRef.StopTransform();this.DisplayLineRef.ResetToTop();this.DisplayLineRef.ResetCaption();this.DisplayLineRef.SetCaption(win.toString());this.DisplayLineRef.Visible(true);idx_reel=SlotCombo.TAB_LINES[this.ID][0];xx=this.ApplicationRef.SLOT().REEL(idx_reel).GetXX();yy=this.ApplicationRef.SLOT().REEL(idx_reel).GetYY();offs=-(this.DisplayLineRef.ACTUAL_W()+40);if(xx+offs<0)offs=-1*xx;this.DisplayLineRef.XX(xx,offs);this.DisplayLineRef.YY(yy,80);this.DisplayLineRef.MoveEx(0,20,30,10);this.SpriteWinLineRef.CenterBox(this.DisplayLineRef.ACTUAL_W(),this.DisplayLineRef.ACTUAL_H(),true);this.SpriteWinLineRef.Sprite.x+=this.DisplayLineRef.XX_GET();this.SpriteWinLineRef.Sprite.y+=this.DisplayLineRef.YY_GET();this.SpriteWinLineRef.SPRITE_TRANSFORMER().ScaleLoop(.2,.6,30,10,0);this.SpriteWinLineRef.SPRITE_TRANSFORMER().RotateLoop(0,180,10)}}};SlotLine.prototype.OnLineWin=function(win_value){};SlotLine.prototype.VisualizzaPuntatore=function(p_Stato){};SlotLine.prototype.InitializeCoords=function(xx,yy){};SlotLine.prototype.Refresh=function(ellapsed_ms){};function SlotLiner(parent_container,app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.ParentStage=parent_container;this.Container=new PIXI.Container;this.Lines=new Array(window.NUM_LINEE);this.DisplayWin=null;this.DisplayWinLine=null;this.DEBUG_LOG("*** CREATING LINER FOR "+this.Lines.length+" LINES ****");for(var i=0;i<this.Lines.length;i++)this.Lines[i]=new SlotLine(this.ParentStage,this.ApplicationRef);this.SymbolsLineSet=null;this.CurLinesCount=0;this.OldLinesCount=0;this.Stato=0;this.PreviewLinea=0;this.Enabled=false}SlotLiner.prototype=Object.create(SObject.prototype);SlotLiner.prototype.constructor=SlotLiner;SlotLiner.prototype.Init=function(){this.DisplayWin=new DisplayStyle(0,820,126,"left",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:32,fontStyle:"normal",fontWeight:"bold",fill:["#ffffff","#ffaa00"]}));this.DisplayWin.Init();this.DisplayWin.SetCaption("0");this.DisplayWin.Visible(false);this.SpriteWinLine=new TiledSprite("FX02",1,false,this.ApplicationRef.SLOT().CONTAINER(),".webp");this.SpriteWinLine.Setup();this.DisplayWinLine=new DisplaySprite(8,0,0,"GFXFontA","left",DisplaySprite.NUMERIC_DISPLAY,this.ApplicationRef.SLOT().CONTAINER(),".webp");this.DisplayWinLine.Init();this.DisplayWinLine.SetCaption("0");this.DisplayWinLine.SCALE(1);this.DisplayWinLine.Visible(false);this.SymbolsLineSet=new Array(window.NUM_REELS);for(var i=0;i<this.SymbolsLineSet.length;i++){this.SymbolsLineSet[i]=new TiledSprite("SYM",window.NUM_SIMBOLI,true,this.Container,".webp");this.SymbolsLineSet[i].Setup();this.SymbolsLineSet[i].ResetProperties(false,1,.15);this.SymbolsLineSet[i].YY(125,0);this.SymbolsLineSet[i].XX(this.DisplayWin.DisplayText.x,-((i+2)*42))}for(var i=0;i<this.Lines.length;i++){this.Lines[i].Init(this.DisplayWin,this.DisplayWinLine,this.SpriteWinLine,this.SymbolsLineSet)}this.Reset()};SlotLiner.prototype.Reset=function(){this.OldLinesCount=window.DEFAULT_LINES;this.CurLinesCount=window.DEFAULT_LINES;this.Stato=0;this.PreviewLinea=255};SlotLiner.prototype.CheckLinePreview=function(){};SlotLiner.prototype.PreviewLineaSet=function(linea){};SlotLiner.prototype.Stop=function(){this.GPTimer=0;this.Refresh()};SlotLiner.prototype.NotifyPower=function(p_Linee){this.OldLinesCount=this.CurLinesCount;this.CurLinesCount=p_Linee;if(this.Stato==1){this.OldLinesCount=65535;this.GPTimer=0}};SlotLiner.prototype.VisualizzaLinee=function(){};SlotLiner.prototype.CancellaLinee=function(){for(var i=0;i<this.Lines.length;i++)this.Lines[i].Clear();if(this.ParentStage.children.indexOf(this.Container)!=-1)this.ParentStage.removeChild(this.Container)};SlotLiner.prototype.VisualizzaPuntatori=function(p_Stato){};SlotLiner.prototype.VisualizzaLinea=function(linea,win){this.DEBUG_LOG("SHOW LINE "+linea);this.Lines[linea].Draw(win);if(this.ParentStage.children.indexOf(this.Container)==-1)this.ParentStage.addChild(this.Container)};SlotLiner.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);this.CheckLinePreview();for(var i=0;i<this.Lines.length;i++){this.Lines[i].Refresh(ellapsed_ms)}this.DisplayWinLine.Refresh(ellapsed_ms);if(this.SpriteWinLine!=null)this.SpriteWinLine.Refresh(ellapsed_ms)};SlotLiner.prototype.Visible=function(vsb){this.Container.visible=vsb};ButtonManager.NUM_PULSANTI=19;ButtonManager.PULSANTE_RILASCIATO=0;ButtonManager.PULSANTE_PREMUTO=1;ButtonManager.BUTT_BET_INC=0;ButtonManager.BUTT_BET_DEC=1;ButtonManager.BUTT_LINES_INC=2;ButtonManager.BUTT_LINES_DEC=3;ButtonManager.BUTT_COINLEVEL_INC=4;ButtonManager.BUTT_COINLEVEL_DEC=5;ButtonManager.BUTT_START=6;ButtonManager.BUTT_MAXBET=7;ButtonManager.BUTT_FEATURE=8;ButtonManager.BUTT_FREESPIN=9;ButtonManager.BUTT_HELP=10;ButtonManager.BUTT_AUTO=11;ButtonManager.BUTT_EURO_SET=12;ButtonManager.BUTT_COIN_SET=13;ButtonManager.BUTT_SOUND=14;ButtonManager.BUTT_CASH_SET=15;ButtonManager.BUTT_DEMO_FEATURE_1=16;ButtonManager.BUTT_DEMO_FEATURE_2=17;ButtonManager.BUTT_EXIT=18;ButtonManager.BUTT_ALLBET_INC=19;ButtonManager.BUTT_ALLBET_DEC=20;function ButtonManager(){SObject.call(this);this.StatoCorrente=new Array(ButtonManager.NUM_PULSANTI);this.StatoCorrente.fill(0);this.StatoPrecedente=new Array(ButtonManager.NUM_PULSANTI);this.StatoPrecedente.fill(0)}ButtonManager.prototype=Object.create(SObject.prototype);ButtonManager.prototype.constructor=ButtonManager;ButtonManager.prototype.IsPushed=function(p_IDButton){if(this.StatoCorrente[p_IDButton]==ButtonManager.PULSANTE_RILASCIATO){this.StatoPrecedente[p_IDButton]=ButtonManager.PULSANTE_RILASCIATO;return false}if(this.StatoCorrente[p_IDButton]!=this.StatoPrecedente[p_IDButton]){this.StatoCorrente[p_IDButton]=ButtonManager.PULSANTE_RILASCIATO;this.StatoPrecedente[p_IDButton]=ButtonManager.PULSANTE_RILASCIATO;return true}return false};ButtonManager.prototype.NotifyStymulus=function(p_IDButton){this.StatoCorrente[p_IDButton]=ButtonManager.PULSANTE_PREMUTO};Player.TAB_AUTO_SPINS=[10,20,30,50,100,500];function Player(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.Crediti=0;this.Win=0;this.TotalBet=0;this.LineBet=0;this.Lines=0;this.LastVincita=0;this.AutoPlaySpins=0;this.RefreshCoins=false;this.TAB_COIN_VALUES=new Array(1);this.TAB_COIN_VALUES[0]=1;this.CoinValueIndex=0}Player.prototype=Object.create(SObject.prototype);Player.prototype.constructor=Player;Player.prototype.Init=function(){};Player.prototype.Reset=function(){if(window.CONNECT2SERVER==false)this.Crediti=100;else this.Crediti=0;this.ResetSession()};Player.prototype.ResetSession=function(){this.TotalBet=0;this.LineBet=1;this.Lines=window.NUM_LINEE;this.Win=0;this.AutoPlaySpins=0;this.LastVincita=0;this.CoinValueIndex=0};Player.prototype.COINS_GET=function(){return this.Divisa2Coins(this.Crediti)};Player.prototype.COINS_AT_MIN_COINVALUE=function(){return parseInt(this.Crediti/this.TAB_COIN_VALUES[0])};Player.prototype.COINS_SET=function(setValue){this.Crediti=this.Coins2Divisa(setValue)};Player.prototype.COINS_DEC=function(dec){var dec_cents=this.Coins2Divisa(dec);if(this.Crediti>=dec_cents)this.Crediti-=dec_cents;else this.Crediti=0};Player.prototype.CREDITI_GET=function(){return this.Crediti};Player.prototype.COIN_VALUE_GET=function(){return this.TAB_COIN_VALUES[this.CoinValueIndex]};Player.prototype.COIN_VALUE_SET=function(setValue){for(var i=0;i<this.TAB_COIN_VALUES.length;i++)if(setValue==this.TAB_COIN_VALUES[i])break;if(i<this.TAB_COIN_VALUES.length)this.CoinValueIndex=i};Player.prototype.COIN_VALUE_INDEX=function(){return this.CoinValueIndex};Player.prototype.COIN_VALUE_INC_ENABLED=function(){if(this.CoinValueIndex+1>=this.TAB_COIN_VALUES.length)return false;return true};Player.prototype.COIN_VALUE_DEC_ENABLED=function(){return this.CoinValueIndex>0};Player.prototype.COIN_VALUE_INC=function(){if(this.CoinValueIndex<this.TAB_COIN_VALUES.length-1)this.CoinValueIndex++};Player.prototype.COIN_VALUE_DEC=function(){if(this.CoinValueIndex!=0)this.CoinValueIndex--};Player.prototype.AUTO_SPINS_GET=function(){return this.AutoPlaySpins};Player.prototype.AUTO_SPINS_SET=function(auto){this.AutoPlaySpins=auto};Player.prototype.AUTO_SPINS_DEC=function(){if(this.AutoPlaySpins!=0)this.AutoPlaySpins--};Player.prototype.COINS_PLAYABLES=function(coins_to_play){return coins_to_play<=this.COINS_GET()};Player.prototype.COINS_PLAYED=function(consumed_coins){var initial_crediti=this.COINS_GET();if(this.COINS_GET()>=consumed_coins){this.COINS_DEC(consumed_coins)}else this.COINS_SET(0);this.TotalBet=consumed_coins;this.Lines=this.ApplicationRef.SLOT().LINES();this.LineBet=parseInt(this.TotalBet/this.Lines);if(this.LineBet==0)this.LineBet=1};Player.prototype.BET_DIVISA=function(){return this.Coins2Divisa(this.TotalBet)};Player.prototype.TOTAL_BET=function(){return this.TotalBet};Player.prototype.BET_LINE=function(){return this.LineBet};Player.prototype.LINES=function(){return this.Lines};Player.prototype.ULTIMA_VINCITA=function(){return this.LastVincita};Player.prototype.NotificaVincita=function(win_coins){this.LastVincita=win_coins};Player.prototype.Divisa2Coins=function(divisa_cents){return parseInt(divisa_cents/this.COIN_VALUE_GET())};Player.prototype.Coins2Divisa=function(coins){return parseInt(coins*this.COIN_VALUE_GET())};Player.prototype.REFRESH_COINS=function(enb){this.RefreshCoins=enb};Player.prototype.Parse_PLAYER_STATUS=function(chunk_to_parse){var esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){this.Crediti=this.ParseServer_Dump_UINT(-1);if(this.RefreshCoins==false){this.Win=this.ParseServer_Dump_UINT(-1);this.Lines=this.ParseServer_Dump_UINT(-1);this.LineBet=this.ParseServer_Dump_UINT(-1);this.COIN_VALUE_SET(this.ParseServer_Dump_UINT(-1));this.ApplicationRef.Recover()}}m_RefreshCoins=false;return esito};Player.prototype.Parse_COIN_VALUES=function(chunk_to_parse){var i=0;var esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){this.TAB_COIN_VALUES=new Array(this.ServerData.length-1);for(i=0;i<this.TAB_COIN_VALUES.length;i++)this.TAB_COIN_VALUES[i]=this.ParseServer_Dump_UINT(-1)}return esito};ConsoleButton.TYPE_PUSH_AND_BACK=0;ConsoleButton.TYPE_PUSH_AND_KEEP=1;ConsoleButton.STATE_ENABLED=0;ConsoleButton.STATE_DISABLED=1;ConsoleButton.STATE_PUSHING=2;ConsoleButton.STATE_PUSHED=3;function ConsoleButton(id_butt_plancia,res_name,frames,xx,yy,type,parent_container,app_reference,extension=".png"){TiledSprite.call(this,res_name,frames,true,parent_container,extension);this.ApplicationRef=app_reference;this.ID_Button_Plancia=id_butt_plancia;this.TYPE=type;this.Stato=ConsoleButton.STATE_DISABLED;this.AsyncStato=ConsoleButton.STATE_ENABLED;this.TimerStato=0;this.StatoCorrente=0;this.StatoPrecedente=0;this.StageX=xx;this.StageY=yy}ConsoleButton.prototype=Object.create(TiledSprite.prototype);ConsoleButton.prototype.constructor=ConsoleButton;ConsoleButton.prototype.Init=function(){this.Setup();this.SetButton(true);this.XX(this.StageX,0);this.YY(this.StageY,0)};ConsoleButton.prototype.IsEnabled=function(){return this.Stato==ConsoleButton.STATE_ENABLED};ConsoleButton.prototype.SetEnable=function(enb){var new_stato;if(this.Stato!=ConsoleButton.STATE_PUSHED){if(enb==true){new_stato=ConsoleButton.STATE_ENABLED;this.Visible(true)}else{new_stato=ConsoleButton.STATE_DISABLED}if(this.Stato!=new_stato){this.Stato=new_stato;this.AggiornaStato(this.Stato)}}};ConsoleButton.prototype.AggiornaStato=function(stato){var l_CurFrame;l_CurFrame=this.StatoToFrame(stato);this.SetFrame(l_CurFrame)};ConsoleButton.prototype.StatoToFrame=function(p_Stato){if(this.TotFrames==1){switch(p_Stato){case ConsoleButton.STATE_ENABLED:{this.Sprite.alpha=1;this.SetMaskFilter(TiledSprite.MASK_STAT_NONE)}break;case ConsoleButton.STATE_DISABLED:{this.Sprite.alpha=.4;this.SetMaskFilter(TiledSprite.MASK_STAT_NONE)}break;case ConsoleButton.STATE_PUSHING:{this.SetMaskFilter(TiledSprite.MASK_STAT_DARKEN)}break;case ConsoleButton.STATE_PUSHED:{this.SetMaskFilter(TiledSprite.MASK_STAT_RED)}break;default:{}break}}else{switch(p_Stato){case ConsoleButton.STATE_ENABLED:{this.Sprite.alpha=1;this.SetMaskFilter(TiledSprite.MASK_STAT_NONE)}break;case ConsoleButton.STATE_DISABLED:{this.Sprite.alpha=.4;this.SetMaskFilter(TiledSprite.MASK_STAT_NONE)}break;case ConsoleButton.STATE_PUSHING:{return 1}break;case ConsoleButton.STATE_PUSHED:{return 2}break;default:{}break}}return 0};ConsoleButton.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);if(this.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.OnMouseClick()}if(this.CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true){this.OnMouseOver()}if(this.CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true){this.OnMouseOut()}if(this.AsyncStato==ConsoleButton.STATE_PUSHING){if(this.GPTimer==0){if(this.TYPE==ConsoleButton.TYPE_PUSH_AND_KEEP){if(this.Stato==ConsoleButton.STATE_ENABLED)this.Stato=ConsoleButton.STATE_PUSHED;else this.Stato=ConsoleButton.STATE_ENABLED}this.AsyncStato=ConsoleButton.STATE_ENABLED;this.AggiornaStato(this.Stato)}}};ConsoleButton.prototype.Push=function(){this.AsyncStato=ConsoleButton.STATE_PUSHING;this.GPTimer=this.ArmaTimer(this.GPTimer,100);this.AggiornaStato(this.AsyncStato)};ConsoleButton.prototype.OnMouseClick=function(){if(this.TYPE==ConsoleButton.TYPE_PUSH_AND_KEEP){if(this.Stato==ConsoleButton.STATE_PUSHED&&this.AsyncStato==ConsoleButton.STATE_ENABLED||this.Stato==ConsoleButton.STATE_ENABLED&&this.AsyncStato==ConsoleButton.STATE_ENABLED){if(this.ID_Button_Plancia!=-1)this.ApplicationRef.BUTTON_MANAGER().NotifyStymulus(this.ID_Button_Plancia);else this.NotifyStymulus();this.Push()}}else{if(this.Stato==ConsoleButton.STATE_ENABLED&&this.AsyncStato==ConsoleButton.STATE_ENABLED){if(this.ID_Button_Plancia!=-1)this.ApplicationRef.BUTTON_MANAGER().NotifyStymulus(this.ID_Button_Plancia);else this.NotifyStymulus();this.Push()}}};ConsoleButton.prototype.OnMouseOver=function(){if(this.Stato==ConsoleButton.STATE_ENABLED&&this.AsyncStato==ConsoleButton.STATE_ENABLED)this.SetMaskFilter(TiledSprite.MASK_STAT_GREEN)};ConsoleButton.prototype.OnMouseOut=function(){if(this.Stato==ConsoleButton.STATE_ENABLED&&this.AsyncStato==ConsoleButton.STATE_ENABLED)this.SetMaskFilter(TiledSprite.MASK_STAT_NONE)};ConsoleButton.prototype.IsPushed=function(){if(this.StatoCorrente==ButtonManager.PULSANTE_RILASCIATO){this.StatoPrecedente=ButtonManager.PULSANTE_RILASCIATO;return false}if(this.StatoCorrente!=this.StatoPrecedente){this.StatoCorrente=ButtonManager.PULSANTE_RILASCIATO;this.StatoPrecedente=ButtonManager.PULSANTE_RILASCIATO;return true}return false};ConsoleButton.prototype.NotifyStymulus=function(){this.StatoCorrente=ButtonManager.PULSANTE_PREMUTO};ConsoleButton.prototype.GetStatus=function(){return this.AsyncStato};function Display(max_digits,xx,yy,font_name,size,alignment,stage_container){SObject.call(this);this.ParentStage=stage_container;this.MaxDigits=max_digits;this.CurCaption="";this.BitmapFontText=new PIXI.extras.BitmapText("",{font:size+"px "+font_name,align:alignment});this.XX(xx,0);this.YY(yy,0)}Display.prototype=Object.create(SObject.prototype);Display.prototype.constructor=Display;Display.prototype.Init=function(){this.ParentStage.addChild(this.BitmapFontText)};Display.prototype.Visible=function(vsb){this.BitmapFontText.visible=vsb};Display.prototype.Width=function(){return this.BitmapFontText.width};Display.prototype.XX=function(xx,offs){this.BitmapFontText.x=xx+offs};Display.prototype.YY=function(yy,offs){this.BitmapFontText.y=yy+offs};Display.prototype.ResetCaption=function(){this.CurCaption=""};Display.prototype.SetCaption=function(capt){if(this.CurCaption!=capt){if(this.BitmapFontText.align=="right"){while(capt.length<this.MaxDigits)capt="."+capt}this.CurCaption=capt;this.BitmapFontText.text=this.CurCaption}};Display.prototype.SetCaptionCents=function(val){var str=""+parseInt(val/100);str+=".";var remind=parseInt(val%100);var remind_str=""+remind;while(remind_str.length<2)remind_str="0"+remind_str;this.SetCaption(str+remind_str)};function DisplayStyle(area_width,xx,yy,align,stage_container,style){SObject.call(this);this.ParentStage=stage_container;this.AreaWidth=area_width;this.Align=align;this.CurCaption="";this.DisplayText=new PIXI.Text(this.CurCaption,style);this.MaskButton=TiledSprite.MASK_BUTT_NONE;var self=this;this.DisplayText.mousedown=function(data){if(self.MaskButton&TiledSprite.MASK_BUTT_ENABLED){self.MaskButton|=TiledSprite.MASK_BUTT_PUSHED}};this.DisplayText.on("pointerdown",function(event){if(self.MaskButton&TiledSprite.MASK_BUTT_ENABLED){self.MaskButton|=TiledSprite.MASK_BUTT_PUSHED}});this.DisplayText.mouseover=function(data){if(self.MaskButton&TiledSprite.MASK_BUTT_ENABLED){self.MaskButton|=TiledSprite.MASK_BUTT_OVER}};this.DisplayText.mouseout=function(data){if(self.MaskButton&TiledSprite.MASK_BUTT_ENABLED){self.MaskButton|=TiledSprite.MASK_BUTT_OUT}};this.XX(xx,0);this.YY(yy,0)}DisplayStyle.prototype=Object.create(SObject.prototype);DisplayStyle.prototype.constructor=DisplayStyle;DisplayStyle.prototype.Init=function(){};DisplayStyle.prototype.Visible=function(vsb){if(this.ParentStage!=null){if(vsb==true){if(this.ParentStage.children.indexOf(this.DisplayText)==-1)this.ParentStage.addChild(this.DisplayText)}else{if(this.ParentStage.children.indexOf(this.DisplayText)!=-1)this.ParentStage.removeChild(this.DisplayText)}}this.DisplayText.visible=vsb};DisplayStyle.prototype.IsVisible=function(){return this.DisplayText.visible&&this.ParentStage.children.indexOf(this.DisplayText)!=-1};DisplayStyle.prototype.ResetProperties=function(visible_set,alpha_set,scale_set){this.Visible(visible_set);this.DisplayText.alpha=alpha_set;this.DisplayText.scale=new PIXI.Point(scale_set,scale_set);this.MaskButton=TiledSprite.MASK_BUTT_NONE};DisplayStyle.prototype.ResetToTop=function(){this.ParentStage.removeChild(this.DisplayText);this.ParentStage.addChild(this.DisplayText)};DisplayStyle.prototype.StopTransform=function(){};DisplayStyle.prototype.Refresh=function(ellapsed_time){};DisplayStyle.prototype.Width=function(){return this.DisplayText.width};DisplayStyle.prototype.Height=function(){return this.DisplayText.height};DisplayStyle.prototype.XX=function(xx,offs){this.DisplayText.x=xx+offs;if(this.Align=="center"){this.DisplayText.x+=(this.AreaWidth-this.DisplayText.width)/2}else if(this.Align=="right"){this.DisplayText.x+=this.AreaWidth-this.DisplayText.width}};DisplayStyle.prototype.YY=function(yy,offs){this.DisplayText.y=yy+offs};DisplayStyle.prototype.ACTUAL_W=function(){return this.DisplayText.width};DisplayStyle.prototype.ACTUAL_H=function(){return this.DisplayText.height};DisplayStyle.prototype.CenterBox=function(ww,hh){this.DisplayText.x=(ww-this.DisplayText.width)/2;this.DisplayText.y=(hh-this.DisplayText.height)/2};DisplayStyle.prototype.ResetCaption=function(){this.CurCaption=""};DisplayStyle.prototype.SetAreaWidth=function(ww){this.AreaWidth=ww};DisplayStyle.prototype.SetCaption=function(capt){if(this.CurCaption!=capt){this.CurCaption=capt;this.DisplayText.text=this.CurCaption;if(this.Align=="center"){this.DisplayText.x=(this.AreaWidth-this.DisplayText.width)/2}else if(this.Align=="right"){this.DisplayText.x=this.AreaWidth-this.DisplayText.width}}};DisplayStyle.prototype.SetCaptionCents=function(val,currency_str){var str=""+parseInt(val/100);str+=",";var remind=parseInt(val%100);var remind_str=""+remind;while(remind_str.length<2)remind_str="0"+remind_str;this.SetCaption(str+remind_str+currency_str)};DisplayStyle.prototype.SetButton=function(enable){if(enable==true){this.DisplayText.interactive=true;this.DisplayText.buttonMode=true;this.MaskButton=TiledSprite.MASK_BUTT_ENABLED}else{this.DisplayText.interactive=false;this.DisplayText.buttonMode=false;this.MaskButton=TiledSprite.MASK_BUTT_NONE}};DisplayStyle.prototype.GetButtStatus=function(){return this.MaskButton};DisplayStyle.prototype.CheckButtStatus=function(flag){if((this.MaskButton&flag)!=0){this.MaskButton&=~flag;return true}return false};DisplaySprite.NUMERIC_DISPLAY=0;DisplaySprite.ALPHANUMERIC_DISPLAY=1;function DisplaySprite(max_digits,xx,yy,font_name,alignment,type,parent_container,extension=".png"){SObject.call(this);this.Container=new PIXI.Container;this.ParentStage=parent_container;this.MaxDigits=max_digits;this.CurCaption="";this.DisplayType=type;if(this.DisplayType==DisplaySprite.NUMERIC_DISPLAY)frames=10;else frames=36;this.Digits=new Array(max_digits);for(var i=0;i<this.Digits.length;i++){this.Digits[i]=new TiledSprite(font_name,frames,false,this.Container,extension)}this.XX(xx,0);this.YY(yy,0)}DisplaySprite.prototype=Object.create(SObject.prototype);DisplaySprite.prototype.constructor=DisplaySprite;DisplaySprite.prototype.Init=function(){for(var i=0;i<this.Digits.length;i++){this.Digits[i].Setup();this.Digits[i].XX(0,i*this.Digits[i].FrameW)}this.ParentStage.addChild(this.Container)};DisplaySprite.prototype.MoveEx=function(rel_x,rel_y,steps,time){for(var i=0;i<this.Digits.length;i++){this.Digits[i].StopTransform();this.Digits[i].YY(0,0);this.Digits[i].SPRITE_TRANSFORMER().MoveEx(rel_x,rel_y,steps,time)}};DisplaySprite.prototype.StopTransform=function(){for(var i=0;i<this.Digits.length;i++){this.Digits[i].StopTransform()}};DisplaySprite.prototype.Visible=function(vsb){this.Container.visible=vsb};DisplaySprite.prototype.Width=function(){return this.Digits.length*this.Digits[0].FrameW};DisplaySprite.prototype.ACTUAL_W=function(){return this.CurCaption.length*this.Container.scale.x*this.Digits[0].FrameW};DisplaySprite.prototype.ACTUAL_H=function(){return this.Container.scale.y*this.Digits[0].FrameH};DisplaySprite.prototype.XX=function(xx,offs){this.Container.x=xx+offs};DisplaySprite.prototype.XX_GET=function(){return this.Container.x};DisplaySprite.prototype.YY=function(yy,offs){this.Container.y=yy+offs};DisplaySprite.prototype.YY_GET=function(){return this.Container.y};DisplaySprite.prototype.CenterBox=function(ww_box,hh_box){this.Container.x=(ww_box-this.ACTUAL_W())/2;this.Container.y=(hh_box-this.ACTUAL_H())/2};DisplaySprite.prototype.SCALE=function(scale){this.Container.scale.x=scale;this.Container.scale.y=scale};DisplaySprite.prototype.ALPHA=function(alpha){this.Container.alpha=alpha};DisplaySprite.prototype.ALPHA_INC=function(alpha){this.Container.alpha+=alpha};DisplaySprite.prototype.ALPHA_DEC=function(alpha){this.Container.alpha+=alpha};DisplaySprite.prototype.ALPHA_GET=function(){return this.Container.alpha};DisplaySprite.prototype.ResetProperties=function(visible_set,alpha_set,scale_set){this.Visible(visible_set);this.SCALE(scale_set);this.ALPHA(alpha_set)};DisplaySprite.prototype.ResetToTop=function(){this.ParentStage.removeChild(this.Container);this.ParentStage.addChild(this.Container)};DisplaySprite.prototype.ResetCaption=function(){this.CurCaption=""};DisplaySprite.prototype.SetCaption=function(capt){var i,len,char_frame;if(this.CurCaption!=capt){for(var i=0;i<this.Digits.length;i++){this.Digits[i].Visible(false)}len=capt.length;if(len>this.MaxDigits)len=this.MaxDigits;for(i=0;i<len;i++){if(capt[i]!=" "){char_frame=this.ConvertChar(capt[i]);this.Digits[i].SetFrame(char_frame);this.Digits[i].Visible(true)}}this.CurCaption=capt}};DisplaySprite.prototype.ConvertChar=function(ch){var frm,DLT,templ;if(ch>="0"&&ch<="9")templ="0";else templ="A";DLT=ch.charCodeAt(0)-templ.charCodeAt(0);if(ch>="0"&&ch<="9")DLT+=0;else DLT+=10;return DLT};DisplaySprite.prototype.Refresh=function(ellapsed_ms){for(var i=0;i<this.Digits.length;i++){this.Digits[i].Refresh(ellapsed_ms)}};function DialogButton(caption,parent_container){SObject.call(this);this.ParentContainer=parent_container;this.Container=new PIXI.Container
;this.SpriteButton=new TiledSprite("Dialog_Button",1,false,this.Container,".webp");this.ButtonText=new DisplayStyle(6,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:14,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.Caption=caption;this.Enabled=true}DialogButton.prototype=Object.create(SObject.prototype);DialogButton.prototype.constructor=DialogButton;DialogButton.prototype.Init=function(){this.SpriteButton.Setup();this.SpriteButton.SetButton(true);this.ButtonText.Init();this.SetCaption(this.Caption);this.ParentContainer.addChild(this.Container)};DialogButton.prototype.SetCaption=function(caption){this.ButtonText.SetCaption(caption);this.ButtonText.CenterBox(this.SpriteButton.FrameW,this.SpriteButton.FrameH)};DialogButton.prototype.XX=function(xx,offs){this.Container.x=xx+offs};DialogButton.prototype.YY=function(yy,offs){this.Container.y=yy+offs};DialogButton.prototype.Visible=function(vsb){this.SpriteButton.Visible(vsb);this.ButtonText.Visible(vsb)};DialogButton.prototype.IsVisible=function(){return this.SpriteButton.IsVisible()};DialogButton.prototype.GetSprite=function(){return this.SpriteButton};DialogButton.prototype.SetEnabled=function(enb){if(enb==true){this.SpriteButton.SetMaskFilter(TiledSprite.MASK_STAT_NONE);this.ButtonText.DisplayText.alpha=1}else{this.SpriteButton.SetMaskFilter(TiledSprite.MASK_STAT_GRAY);this.ButtonText.DisplayText.alpha=.5}this.SpriteButton.SetButton(enb);this.Enabled=enb};function DialogCheckBox(caption,parent_container){SObject.call(this);this.ParentContainer=parent_container;this.Container=new PIXI.Container;this.SpriteButton=new TiledSprite("Butt_Check",2,true,this.Container,".webp");this.ButtonText=new DisplayStyle(6,0,0,"left",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:14,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.Caption=caption;this.Enabled=true}DialogCheckBox.prototype=Object.create(SObject.prototype);DialogCheckBox.prototype.constructor=DialogCheckBox;DialogCheckBox.prototype.Init=function(){this.SpriteButton.Setup();this.SpriteButton.SetButton(true);this.ButtonText.Init();this.SetCaption(this.Caption);this.ParentContainer.addChild(this.Container)};DialogCheckBox.prototype.SetCaption=function(caption){this.ButtonText.SetCaption(caption);this.ButtonText.CenterBox(this.SpriteButton.FrameW,this.SpriteButton.FrameH);this.ButtonText.XX(0,45)};DialogCheckBox.prototype.SetValue=function(val){this.SpriteButton.SetFrame(val)};DialogCheckBox.prototype.XX=function(xx,offs){this.Container.x=xx+offs};DialogCheckBox.prototype.YY=function(yy,offs){this.Container.y=yy+offs};DialogCheckBox.prototype.Visible=function(vsb){this.SpriteButton.Visible(vsb);this.ButtonText.Visible(vsb)};DialogCheckBox.prototype.IsVisible=function(){return this.SpriteButton.IsVisible()};DialogCheckBox.prototype.GetSprite=function(){return this.SpriteButton};DialogCheckBox.prototype.SetEnabled=function(enb){if(enb==true){this.SpriteButton.SetMaskFilter(TiledSprite.MASK_STAT_NONE);this.ButtonText.DisplayText.alpha=1}else{this.SpriteButton.SetMaskFilter(TiledSprite.MASK_STAT_DARKEN);this.ButtonText.DisplayText.alpha=.5}this.SpriteButton.SetButton(enb);this.Enabled=enb};DialogBox.DIALOG_NOT_MODAL=0;DialogBox.DIALOG_MODAL_OK=1;DialogBox.DIALOG_MODAL_OK_CANCEL=2;DialogBox.DIALOG_EXIT_NONE=0;DialogBox.DIALOG_EXIT_OK=1;DialogBox.DIALOG_EXIT_CANCEL=2;DialogBox.TAB_CAPTIONS=[["ATTENTION","ATTENZIONE"]];function DialogBox(app_reference,parent_container){SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.Container=new PIXI.Container;this.Shape=new TiledSprite("Alarm_Box",1,true,this.Container,".webp");this.TitleText=null;this.InfoText=null;this.ButtonOK=null;this.ButtonCANCEL=null}DialogBox.prototype=Object.create(SObject.prototype);DialogBox.prototype.constructor=DialogBox;DialogBox.prototype.Init=function(){this.Container.scale=new PIXI.Point(1.5,1.5);this.Shape.Setup();if(this.InfoText==null){this.InfoText=new DisplayStyle(this.Shape.FrameW,0,this.Shape.FrameH/2-32,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:32,fontStyle:"normal",fontWeight:"bold",fill:"white"}))}if(this.TitleText==null){this.TitleText=new DisplayStyle(this.Shape.FrameW,0,24,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:32,fontStyle:"normal",fontWeight:"bold",fill:"white"}))}this.InfoText.Init()};DialogBox.prototype.Render=function(popup_message,modal){this.TitleText.SetCaption(DialogBox.TAB_CAPTIONS[0][window.LANG]);this.TitleText.Visible(true);this.InfoText.SetCaption(popup_message);this.InfoText.Visible(true);var proxy_msg=this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES();if(this.ButtonOK==null){this.ButtonOK=new DialogButton(proxy_msg.OK_MESSAGE(),this.Container);this.ButtonOK.Init()}if(this.ButtonCANCEL==null){this.ButtonCANCEL=new DialogButton(proxy_msg.CANCEL_MESSAGE(),this.Container);this.ButtonCANCEL.Init()}if(modal!=DialogBox.DIALOG_NOT_MODAL){if(modal==DialogBox.DIALOG_MODAL_OK){this.ButtonOK.XX(350,0);this.ButtonOK.YY(435,0);this.ButtonOK.Visible(true);this.ButtonOK.Container.scale.x=1.5;this.ButtonOK.Container.scale.y=1.5}else{this.ButtonOK.XX(190,0);this.ButtonOK.YY(350,0);this.ButtonOK.Visible(true);this.ButtonOK.Container.scale.x=1.5;this.ButtonOK.Container.scale.y=1.5;this.ButtonCANCEL.XX(510,0);this.ButtonCANCEL.YY(350,0);this.ButtonCANCEL.Visible(true);this.ButtonCANCEL.Container.scale.x=1.5;this.ButtonCANCEL.Container.scale.y=1.5}}else{this.ButtonOK.Visible(false);this.ButtonCANCEL.Visible(false)}};DialogBox.prototype.GetShape=function(){return this.Shape};DialogBox.prototype.GetContainer=function(){return this.Container};DialogBox.prototype.GetTextDisplay=function(){return this.InfoText};DialogBox.prototype.Mount=function(){var offs_x,offs_y;offs_x=(window.VIDEO_WIDTH-this.Container.scale.x*this.Shape.ACTUAL_W())/2;offs_y=(window.VIDEO_HEIGHT-this.Container.scale.y*this.Shape.ACTUAL_H())/2;this.Container.x=offs_x;this.Container.y=offs_y;this.Shape.Visible(true);this.ParentContainer.addChild(this.Container)};DialogBox.prototype.Unmount=function(){if(this.Shape.IsVisible()==true){this.ButtonOK.Visible(false);this.ButtonCANCEL.Visible(false);this.Shape.Visible(false);this.ParentContainer.removeChild(this.Container)}};DialogBox.prototype.Refresh=function(){var exit=DialogBox.DIALOG_EXIT_NONE;if(this.Shape.IsVisible()==true){if(this.ButtonOK.IsVisible()==true){if(this.ButtonOK.GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.ButtonOK.GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_HIGHLIGHT);else if(this.ButtonOK.GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.ButtonOK.GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_NONE);if(this.ButtonOK.GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){exit=DialogBox.DIALOG_EXIT_OK}}if(this.ButtonCANCEL.IsVisible()==true){if(this.ButtonCANCEL.GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.ButtonCANCEL.GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_HIGHLIGHT,0);else if(this.ButtonCANCEL.GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.ButtonCANCEL.GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_NONE,0);if(this.ButtonCANCEL.GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){exit=DialogBox.DIALOG_EXIT_CANCEL}}}return exit};function ControlStyle(xx,yy,scale){SObject.call(this);this.X=xx;this.Y=yy;this.SCALE=scale}ControlStyle.prototype=Object.create(SObject.prototype);ControlStyle.prototype.constructor=ControlStyle;ControlBuilder.ID_CONSOLE_SPIN=0;ControlBuilder.ID_SPIN_BUTT_SPIN=0;ControlBuilder.ID_SPIN_BUTT_AUTO=1;ControlBuilder.ID_SPIN_BUTT_BETDEC=2;ControlBuilder.ID_SPIN_BUTT_BETINC=3;ControlBuilder.ID_CONSOLE_INFO=1;ControlBuilder.ID_CONSOLE_BILL=2;ControlBuilder.ID_CONSOLE_BILL_LBL_CREDIT=0;ControlBuilder.ID_CONSOLE_BILL_DSP_CREDIT=1;ControlBuilder.ID_CONSOLE_BILL_LBL_BET=2;ControlBuilder.ID_CONSOLE_BILL_DSP_BET=3;ControlBuilder.ID_CONSOLE_SET=3;ControlBuilder.ID_CONSOLE_DIALOG_BET=4;ControlBuilder.ID_CONSOLE_DIALOG_AUTO=5;ControlBuilder.ID_CONSOLE_DIALOG_SET=6;ControlBuilder.TAB_CTRL_LAPTOP=[new ControlStyle(1515,-115,1),new ControlStyle(0,50,1),new ControlStyle(0,0,1),new ControlStyle(10,50,1),new ControlStyle(1400,400,1),new ControlStyle(1400,400,1),new ControlStyle(10,600,1)];ControlBuilder.TAB_CTRL_MOBILE_LAND=[new ControlStyle(1520,-568,2),new ControlStyle(-300,40,1.3),new ControlStyle(-180,-49,2),new ControlStyle(6,-900,1.8),new ControlStyle(550,200,2),new ControlStyle(410,85,2.5),new ControlStyle(410,85,2.5)];ControlBuilder.TAB_CTRL_MOBILE_PORT=[new ControlStyle(1520,-400,2),new ControlStyle(-300,40,1.3),new ControlStyle(-180,-49,2),new ControlStyle(6,-900,1.8),new ControlStyle(550,200,2),new ControlStyle(410,85,2.5),new ControlStyle(410,85,2.5)];ControlBuilder.TAB_SUBCTRL_SPIN_LAPTOP=[new ControlStyle(85,0,1),new ControlStyle(144,200,.8),new ControlStyle(0,168,1),new ControlStyle(304,168,1)];ControlBuilder.TAB_SUBCTRL_SPIN_MOBILE_LAND=[new ControlStyle(83,30,.6),new ControlStyle(-760,95,.8),new ControlStyle(112,240,1.3),new ControlStyle(112,-140,1.3)];ControlBuilder.TAB_SUBCTRL_SPIN_MOBILE_PORT=[new ControlStyle(20,64,1),new ControlStyle(-759,15,.8),new ControlStyle(120,-148,1.2),new ControlStyle(120,-248,1.2)];ControlBuilder.TAB_SUBCTRL_BILL_LAPTOP=[new ControlStyle(115,45,1),new ControlStyle(264,45,1),new ControlStyle(115,80,1),new ControlStyle(246,80,1)];ControlBuilder.TAB_SUBCTRL_BILL_MOBILE_LAND=[new ControlStyle(92,82,1),new ControlStyle(238,82,1),new ControlStyle(165+700,82,1),new ControlStyle(244+700,82,1)];ControlBuilder.TAB_SUBCTRL_BILL_MOBILE_PORT=[new ControlStyle(92,82,1),new ControlStyle(238,82,1),new ControlStyle(165+700,82,1),new ControlStyle(244+700,82,1)];function ControlBuilder(app_reference){SObject.call(this);this.ApplicationRef=app_reference}ControlBuilder.prototype=Object.create(SObject.prototype);ControlBuilder.prototype.constructor=ControlBuilder;ControlBuilder.prototype.GetControlStyle=function(id_ctrl,style_ref){var tab_styles=null;if(this.ApplicationRef.IsMobile()==true){if(this.ApplicationRef.IsPortrait()==true)tab_styles=ControlBuilder.TAB_CTRL_MOBILE_PORT;else tab_styles=ControlBuilder.TAB_CTRL_MOBILE_LAND}else{tab_styles=ControlBuilder.TAB_CTRL_LAPTOP}if(tab_styles!=null){style_ref.X=tab_styles[id_ctrl].X;style_ref.Y=tab_styles[id_ctrl].Y;style_ref.SCALE=tab_styles[id_ctrl].SCALE}};ControlBuilder.prototype.GetSubControlStyle=function(id_main_ctrl,style_ref){var tab_styles=null;if(this.ApplicationRef.IsMobile()==true){if(this.ApplicationRef.IsPortrait()==true){if(id_main_ctrl==ControlBuilder.ID_CONSOLE_SPIN){tab_styles=ControlBuilder.TAB_SUBCTRL_SPIN_MOBILE_PORT}else if(id_main_ctrl==ControlBuilder.ID_CONSOLE_BILL){tab_styles=ControlBuilder.TAB_SUBCTRL_BILL_MOBILE_PORT}}else{if(id_main_ctrl==ControlBuilder.ID_CONSOLE_SPIN){tab_styles=ControlBuilder.TAB_SUBCTRL_SPIN_MOBILE_LAND}else if(id_main_ctrl==ControlBuilder.ID_CONSOLE_BILL){tab_styles=ControlBuilder.TAB_SUBCTRL_BILL_MOBILE_LAND}}}else{if(id_main_ctrl==ControlBuilder.ID_CONSOLE_SPIN){tab_styles=ControlBuilder.TAB_SUBCTRL_SPIN_LAPTOP}else if(id_main_ctrl==ControlBuilder.ID_CONSOLE_BILL){tab_styles=ControlBuilder.TAB_SUBCTRL_BILL_LAPTOP}}return tab_styles};ControlBuilder.prototype.Dummy=function(){};ConsoleBill.TAB_CAPTIONS=[["CREDIT","CREDITO"],["BET","BET"]];function ConsoleBill(app_reference,parent_container){SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.FreezeCounters=false;this.CoinsView=false;this.Container=new PIXI.Container;this.CreditLabel=new DisplayStyle(0,115,45,"left",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:window.MOBILE?25:28,fontStyle:"normal",fontWeight:"bold",fill:["#f6ae31","#f6ae31"]}));this.CreditDisplay=new DisplayStyle(0,246,45,"left",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:window.MOBILE?25:28,fontStyle:"normal",fontWeight:"bold",fill:["#ffffff","#ffffff"]}));this.BetLabel=new DisplayStyle(0,115,80,"left",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:window.MOBILE?25:28,fontStyle:"normal",fontWeight:"bold",fill:["#f6ae31","#f6ae31"]}));this.BetDisplay=new DisplayStyle(0,246,80,"left",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:window.MOBILE?25:28,fontStyle:"normal",fontWeight:"bold",fill:["#ffffff","#ffffff"]}));this.Style=new ControlStyle(0,0,1)}ConsoleBill.prototype=Object.create(SObject.prototype);ConsoleBill.prototype.constructor=ConsoleBill;ConsoleBill.prototype.Init=function(){this.CreditLabel.Init();this.CreditDisplay.Init();this.BetLabel.Init();this.BetDisplay.Init();this.CreditLabel.Visible(true);this.CreditDisplay.Visible(true);this.BetLabel.Visible(true);this.BetDisplay.Visible(true);this.Setup();this.CreditLabel.SetButton(true);this.CreditDisplay.SetButton(true);this.BetLabel.SetButton(true);this.BetDisplay.SetButton(true);this.ParentContainer.addChild(this.Container)};ConsoleBill.prototype.OnResize=function(){this.Setup()};ConsoleBill.prototype.Setup=function(){var builder=this.ApplicationRef.CONTROL_BUILDER();builder.GetControlStyle(ControlBuilder.ID_CONSOLE_BILL,this.Style);var tab_sub_ctrl;tab_sub_ctrl=this.ApplicationRef.CONTROL_BUILDER().GetSubControlStyle(ControlBuilder.ID_CONSOLE_BILL,this.Style);if(tab_sub_ctrl!=null){this.CreditLabel.XX(tab_sub_ctrl[ControlBuilder.ID_CONSOLE_BILL_LBL_CREDIT].X,0);this.CreditLabel.YY(tab_sub_ctrl[ControlBuilder.ID_CONSOLE_BILL_LBL_CREDIT].Y,0);this.CreditDisplay.XX(tab_sub_ctrl[ControlBuilder.ID_CONSOLE_BILL_DSP_CREDIT].X,0);this.CreditDisplay.YY(tab_sub_ctrl[ControlBuilder.ID_CONSOLE_BILL_DSP_CREDIT].Y,0);this.BetLabel.XX(tab_sub_ctrl[ControlBuilder.ID_CONSOLE_BILL_LBL_BET].X,0);this.BetLabel.YY(tab_sub_ctrl[ControlBuilder.ID_CONSOLE_BILL_LBL_BET].Y,0);this.BetDisplay.XX(tab_sub_ctrl[ControlBuilder.ID_CONSOLE_BILL_DSP_BET].X,0);this.BetDisplay.YY(tab_sub_ctrl[ControlBuilder.ID_CONSOLE_BILL_DSP_BET].Y,0)}this.Container.x=this.Style.X;this.Container.y=this.Style.Y;this.Container.scale=new PIXI.Point(this.Style.SCALE,this.Style.SCALE)};ConsoleBill.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);if(this.CreditLabel.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true||this.CreditDisplay.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true||this.BetLabel.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true||this.BetDisplay.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){if(this.CoinsView==true)this.CoinsView=false;else this.CoinsView=true}this.CreditLabel.SetCaption(ConsoleBill.TAB_CAPTIONS[0][window.LANG]);this.BetLabel.SetCaption(ConsoleBill.TAB_CAPTIONS[1][window.LANG]);if(this.FreezeCounters==false)if(this.CoinsView==true){this.CreditDisplay.SetCaption(this.ApplicationRef.PLAYER().COINS_GET());this.BetDisplay.SetCaption(this.ApplicationRef.SLOT().TOTAL_BET())}else{this.BetDisplay.SetCaptionCents(this.ApplicationRef.PLAYER().Coins2Divisa(this.ApplicationRef.SLOT().TOTAL_BET()),this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().VALUTA_STRING());this.CreditDisplay.SetCaptionCents(this.ApplicationRef.PLAYER().CREDITI_GET(),this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().VALUTA_STRING())}};ConsoleBill.prototype.SetFreezeCounters=function(frz){this.FreezeCounters=frz};ConsoleBill.prototype.SetCoinView=function(coin_view){this.CoinsView=coin_view};ConsoleBill.prototype.OnSpinEvent=function(spin){};function ConsoleInfo(app_reference,parent_container){SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.StaticInfo_Queue=null;this.Container=new PIXI.Container;this.InfoDisplay=new DisplayStyle(0,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:48,fontStyle:"normal",fontWeight:"bold",fill:["#ffffff","#ffffff"]}));this.Style=new ControlStyle(0,0,1)}ConsoleInfo.prototype=Object.create(SObject.prototype);ConsoleInfo.prototype.constructor=ConsoleInfo;ConsoleInfo.prototype.Init=function(){this.InfoDisplay.Init();this.InfoDisplay.SetAreaWidth(window.VIDEO_WIDTH);this.InfoDisplay.Visible(true);this.Setup();this.ParentContainer.addChild(this.Container)};ConsoleInfo.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms)};ConsoleInfo.prototype.OnResize=function(){this.Setup()};ConsoleInfo.prototype.Setup=function(){this.ApplicationRef.CONTROL_BUILDER().GetControlStyle(ControlBuilder.ID_CONSOLE_INFO,this.Style);this.Container.x=this.Style.X;this.Container.y=this.Style.Y;this.Container.scale=new PIXI.Point(this.Style.SCALE,this.Style.SCALE)};ConsoleInfo.prototype.SetCaption=function(str,queue){var i=0;if(queue==false){this.InfoDisplay.SetCaption(str)}else{this.StaticInfo_Queue=str}};ConsoleInfo.prototype.UpdateDisplayQueue=function(){if(this.StaticInfo_Queue!=null){this.SetCaption(this.StaticInfo_Queue,false);this.StaticInfo_Queue=null}};var ConsoleSettings_SliderPos=0;function ConsoleSettings(app_reference,parent_container){SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.Container=new PIXI.Container;this.Button_Sound=new ConsoleButton(ButtonManager.BUTT_SOUND,"Butt_Sound",3,77,71,ConsoleButton.TYPE_PUSH_AND_KEEP,this.Container,this.ApplicationRef,".webp");this.Button_Info=new ConsoleButton(ButtonManager.BUTT_HELP,"Butt_Help",1,0,0,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.Button_Adjust=new ConsoleButton(-1,"Butt_Sett",1,5,71,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.Button_Exit=new ConsoleButton(ButtonManager.BUTT_EXIT,"Butt_Close",1,window.VIDEO_WIDTH-100,-window.VIDEO_HEIGHT+150,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.Style=new ControlStyle(0,0,1);this.SliderVolume_Box=new TiledSprite("Dialog_Volume",1,false,this.Container,".webp");this.SliderVolume_Guide=new PIXI.Graphics;this.SliderVolume_Guide.beginFill(16711680,1);this.SliderVolume_Guide.drawRect(0,0,200,10);this.SliderVolume_Guide.endFill();this.SliderVolume_Thumb=null;this.CheckVolume=true}ConsoleSettings.prototype=Object.create(SObject.prototype);ConsoleSettings.prototype.constructor=ConsoleSettings;ConsoleSettings.prototype.Init=function(){this.Button_Sound.Init();this.Button_Info.Init();this.Button_Adjust.Init();this.Button_Exit.Init();this.Setup();if(this.ApplicationRef.SOUNDGENERATOR().AudioEnabled==false){this.Button_Sound.Push()}this.SliderVolume_Box.Setup();this.ParentContainer.addChild(this.Container)};ConsoleSettings.prototype.OnResize=function(){this.Setup()};ConsoleSettings.prototype.Setup=function(){this.ApplicationRef.CONTROL_BUILDER().GetControlStyle(ControlBuilder.ID_CONSOLE_SET,this.Style);this.Container.x=this.Style.X;this.Container.y=this.Style.Y;this.Container.scale=new PIXI.Point(this.Style.SCALE,this.Style.SCALE);if(window.MOBILE==true){this.Button_Adjust.XX(0,0);this.Button_Adjust.YY(125,0);this.Button_Exit.XX(0,0);this.Button_Exit.YY(502,0);this.Button_Exit.SCALE(.94);this.Button_Info.XX(70,0);this.Button_Info.YY(500,0);this.Button_Sound.XX(0,0);this.Button_Sound.YY(55,0)}};ConsoleSettings.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);this.Button_Sound.Refresh(ellapsed_ms);this.Button_Info.Refresh(ellapsed_ms);this.Button_Adjust.Refresh(ellapsed_ms);this.Button_Exit.Refresh(ellapsed_ms);if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_SOUND)==true){this.ApplicationRef.SOUNDGENERATOR().ToggleMute();if(this.ApplicationRef.SOUNDGENERATOR().AudioEnabled==true){this.ApplicationRef.SLOT().PlayMusic();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.SliderVolume_Enable()}else this.SliderVolume_Disable()}if(this.Button_Adjust.GetStatus()==ConsoleButton.STATE_PUSHING){this.ApplicationRef.CONSOLE().DialogSetEnable(true)}this.SliderVolume_Update()};ConsoleSettings.prototype.OnSpinEvent=function(spin){if(spin==true){this.Button_Info.SetEnable(false);this.Button_Adjust.SetEnable(false);this.Button_Exit.SetEnable(false);this.SliderVolume_Disable()}else{this.Button_Info.SetEnable(true);this.Button_Adjust.SetEnable(true);this.Button_Exit.SetEnable(true)}};ConsoleSettings.prototype.Disable=function(){this.Button_Info.SetEnable(false);this.Button_Adjust.SetEnable(false);this.Button_Exit.SetEnable(false)};ConsoleSettings.prototype.Enable=function(){this.Button_Info.SetEnable(true);this.Button_Adjust.SetEnable(true);this.Button_Sound.SetEnable(true);this.Button_Exit.SetEnable(true)};ConsoleSettings.prototype.SliderVolume_Enable=function(){var slider_thumb_texture;slider_thumb_texture=PIXI.Texture.fromFrame("SlideCursor.webp");if(this.SliderVolume_Thumb==null){this.SliderVolume_Thumb=new PIXI.Sprite(slider_thumb_texture);this.SliderVolume_Thumb.scale.set(1);this.SliderVolume_Thumb.interactive=true;this.SliderVolume_Thumb.buttonMode=true;this.SliderVolume_Thumb.on("pointerdown",SliderVolume_on_drag_start).on("pointerup",SliderVolume_on_drag_end).on("pointerupoutside",SliderVolume_on_drag_end).on("pointermove",SliderVolume_on_drag_move)}this.SliderVolume_Guide.x=this.Button_Sound.Sprite.x+110;this.SliderVolume_Guide.y=this.Button_Sound.Sprite.y+18;this.Container.addChild(this.SliderVolume_Guide);this.SliderVolume_Box.CenterBox(this.SliderVolume_Guide.width,this.SliderVolume_Guide.height,false);this.SliderVolume_Box.Sprite.x+=this.SliderVolume_Guide.x-10;this.SliderVolume_Box.Sprite.y+=this.SliderVolume_Guide.y;this.SliderVolume_Box.Visible(true);this.SliderVolume_VolumeStart=this.ApplicationRef.SOUNDGENERATOR().SET_Volume;this.SliderVolume_Init();this.Container.addChild(this.SliderVolume_Thumb)};ConsoleSettings.prototype.SliderVolume_Disable=function(){if(this.Container.children.indexOf(this.SliderVolume_Guide)!=-1){this.Container.removeChild(this.SliderVolume_Guide);this.Container.removeChild(this.SliderVolume_Thumb);this.SliderVolume_Box.Visible(false)}};ConsoleSettings.prototype.SliderVolume_Init=function(){var volume;volume=this.ApplicationRef.SOUNDGENERATOR().SET_Volume;if(volume==0)this.SliderVolume_Thumb.x=0;else this.SliderVolume_Thumb.x=parseInt(this.SliderVolume_Guide.x+volume*this.SliderVolume_Guide.width/100);if(this.SliderVolume_Thumb.x<this.SliderVolume_Guide.x)this.SliderVolume_Thumb.x=this.SliderVolume_Guide.x;else if(this.SliderVolume_Thumb.x>this.SliderVolume_Guide.x+this.SliderVolume_Guide.width)this.SliderVolume_Thumb.x=this.SliderVolume_Guide.x+this.SliderVolume_Guide.width;this.SliderVolume_Thumb.x-=this.SliderVolume_Thumb.width/2;this.SliderVolume_Thumb.y=this.SliderVolume_Guide.y+(this.SliderVolume_Guide.height-this.SliderVolume_Thumb.height)/2};ConsoleSettings.prototype.SliderVolume_Update=function(){var offs_volume;if(this.SliderVolume_Thumb!=null)if(this.SliderVolume_Thumb.dragging==true){offs_volume=parseInt(100*this.SliderVolume_Thumb.offset/this.SliderVolume_Guide.width);this.ApplicationRef.SOUNDGENERATOR().SET_Volume=this.SliderVolume_VolumeStart+offs_volume;if(this.ApplicationRef.SOUNDGENERATOR().SET_Volume>100)this.ApplicationRef.SOUNDGENERATOR().SET_Volume=100;else if(this.ApplicationRef.SOUNDGENERATOR().SET_Volume<0)this.ApplicationRef.SOUNDGENERATOR().SET_Volume=0;this.SliderVolume_Init();this.ApplicationRef.SOUNDGENERATOR().UpdateVolume()}else{this.SliderVolume_VolumeStart=this.ApplicationRef.SOUNDGENERATOR().SET_Volume}};function SliderVolume_on_drag_start(event){this.data=event.data;this.origin=parseInt(this.data.global.x);this.offset=0;this.alpha=.9;this.dragging=true}function SliderVolume_on_drag_end(){this.alpha=1;this.dragging=false;this.data=null}function SliderVolume_on_drag_move(){if(this.dragging==true){this.offset=parseInt(this.data.global.x)-this.origin}}var KEY_SPACE=false;function ConsoleSpinButton(xx,yy,parent_container,app_reference){ConsoleButton.call(this,ButtonManager.BUTT_START,"Butt_Spin",3,xx,yy,ConsoleButton.TYPE_PUSH_AND_BACK,parent_container,app_reference,".webp");document.addEventListener("keydown",function(event){if(event.defaultPrevented){return}var key=event.key||event.keyCode;if(key===" "){KEY_SPACE=true}})}ConsoleSpinButton.prototype=Object.create(ConsoleButton.prototype);ConsoleSpinButton.prototype.constructor=ConsoleSpinButton;ConsoleSpinButton.prototype.Refresh=function(ellapsed_ms){ConsoleButton.prototype.Refresh.call(this,ellapsed_ms);if(KEY_SPACE==true){KEY_SPACE=false;this.OnMouseClick()}};function ConsoleSpin(app_reference,parent_container){SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.Container=new PIXI.Container;this.Button_Spin=new ConsoleSpinButton(85,0,this.Container,this.ApplicationRef);this.Button_Auto=new ConsoleButton(-1,"Butt_Auto",1,87,208,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.Button_BetDec=new ConsoleButton(ButtonManager.BUTT_ALLBET_DEC,"Butt_Min",1,0,168,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.Button_BetInc=new ConsoleButton(ButtonManager.BUTT_ALLBET_INC,"Butt_Pls",1,304,168,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.Style=new ControlStyle(0,0,1)}ConsoleSpin.prototype=Object.create(SObject.prototype);ConsoleSpin.prototype.constructor=ConsoleSpin;ConsoleSpin.prototype.Init=function(){this.Button_Spin.Init();this.Button_Auto.Init();this.Button_BetDec.Init();this.Button_BetInc.Init();this.Setup();this.ParentContainer.addChild(this.Container)};ConsoleSpin.prototype.OnResize=function(){this.Setup()};ConsoleSpin.prototype.Setup=function(){var tab_sub_ctrl;this.ApplicationRef.CONTROL_BUILDER().GetControlStyle(ControlBuilder.ID_CONSOLE_SPIN,this.Style);this.Container.x=this.Style.X;this.Container.y=this.Style.Y;this.Container.scale=new PIXI.Point(this.Style.SCALE,this.Style.SCALE);tab_sub_ctrl=this.ApplicationRef.CONTROL_BUILDER().GetSubControlStyle(ControlBuilder.ID_CONSOLE_SPIN,this.Style);if(tab_sub_ctrl!=null){this.Button_Spin.XX(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_SPIN].X,0);this.Button_Spin.YY(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_SPIN].Y,0);this.Button_Spin.SCALE(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_SPIN].SCALE);this.Button_Auto.XX(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_AUTO].X,0);this.Button_Auto.YY(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_AUTO].Y,0);this.Button_Auto.SCALE(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_AUTO].SCALE);this.Button_BetDec.XX(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_BETDEC].X,0);this.Button_BetDec.YY(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_BETDEC].Y,0);this.Button_BetDec.SCALE(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_BETDEC].SCALE);this.Button_BetInc.XX(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_BETINC].X,0);this.Button_BetInc.YY(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_BETINC].Y,0);this.Button_BetInc.SCALE(tab_sub_ctrl[ControlBuilder.ID_SPIN_BUTT_BETINC].SCALE)}};ConsoleSpin.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);this.Button_Spin.Refresh(ellapsed_ms);this.Button_Auto.Refresh(ellapsed_ms);this.Button_BetDec.Refresh(ellapsed_ms);this.Button_BetInc.Refresh(ellapsed_ms);if(this.Button_BetDec.GetStatus()==ConsoleButton.STATE_PUSHING||this.Button_BetInc.GetStatus()==ConsoleButton.STATE_PUSHING)this.ApplicationRef.CONSOLE().DialogBetEnable(true);if(this.Button_Auto.GetStatus()==ConsoleButton.STATE_PUSHING){if(this.ApplicationRef.SLOT().IsAutoPlay()==true)this.ApplicationRef.SLOT().BreakAutoPlay();else this.ApplicationRef.CONSOLE().DialogAutoEnable(true)}if(this.Button_Spin.GetStatus()==ConsoleButton.STATE_PUSHING&&this.ApplicationRef.SLOT().IsAutoPlay()==true){this.ApplicationRef.SLOT().BreakAutoPlay();this.Button_Spin.SetEnable(false)}};ConsoleSpin.prototype.OnSpinEvent=function(spin){if(this.ApplicationRef.SLOT().FREESPIN().IsRunning()==true){this.Button_Auto.SetEnable(false);this.Button_BetDec.SetEnable(false);this.Button_BetInc.SetEnable(false);if(spin==true)this.Button_Spin.SetEnable(false);else this.Button_Spin.SetEnable(true)}else if(spin==true){this.Button_Auto.SetEnable(false);this.Button_BetDec.SetEnable(false);this.Button_BetInc.SetEnable(false);if(this.ApplicationRef.PROGRAMMA().GetSPIN_SET().IsAutoPlay()==true){this.Button_Spin.SetEnable(true);this.Button_Spin.SetFrame(2);this.Button_Auto.Visible(false);this.Button_BetDec.Visible(false);this.Button_BetInc.Visible(false)}else{this.Button_Spin.SetEnable(false);this.Button_Spin.SetFrame(1)}}else{this.Button_Auto.SetEnable(true);this.Button_BetDec.SetEnable(true);this.Button_BetInc.SetEnable(true);this.Button_Spin.SetEnable(true);if(this.ApplicationRef.PROGRAMMA().GetSPIN_SET().IsAutoPlay()==true){this.Button_Spin.SetEnable(true);this.Button_Spin.SetFrame(2);this.Button_Auto.Visible(false);this.Button_BetDec.Visible(false);this.Button_BetInc.Visible(false)}else this.Button_Spin.SetFrame(0);this.Container.visible=true}};ConsoleSpin.prototype.OnBrakeEnable=function(){this.Button_Spin.SetEnable(true);this.Button_Spin.SetFrame(2)};ConsoleSpin.prototype.OnBrakePushed=function(){this.Button_Spin.SetEnable(false)};ConsoleSpin.prototype.Disable=function(){this.Button_Auto.SetEnable(false);this.Button_BetDec.SetEnable(false);this.Button_BetInc.SetEnable(false);this.Button_Spin.SetEnable(false)};ConsoleSpin.prototype.Enable=function(){this.Button_Auto.SetEnable(true);this.Button_BetDec.SetEnable(true);this.Button_BetInc.SetEnable(true);this.Button_Spin.SetEnable(true);if(this.ApplicationRef.PROGRAMMA().GetSPIN_SET().IsAutoPlay()==true){this.Button_Spin.SetFrame(2);this.Button_Auto.Visible(false);this.Button_BetDec.Visible(false);this.Button_BetInc.Visible(false)}else this.Button_Spin.SetFrame(0)};ConsoleDialogBet.TAB_CAPTIONS=[["BETTING ON ","PUNTATA SU "],[" LINES"," LINEE"],["BET PER LINE","BET PER LINEA"],["COIN VALUE","VALORE GETTONE"],["TOTAL BET ","BET TOTALE "],[" COINS"," GETTONI"]];function ConsoleDialogBet(app_reference,parent_container){SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.Container=new PIXI.Container;this.Shape=new TiledSprite("Dialog_Box",1,true,this.Container,".webp");var w_shape=440;this.ExitButton=new TiledSprite("Dialog_Close",1,true,this.Container,".webp");this.Lines_Display=new DisplayStyle(w_shape,0,20,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:16,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.BetLine_Label=new DisplayStyle(w_shape,0,72,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:16,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.BetLine_Display=new DisplayStyle(w_shape,0,95,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:36,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.BetLine_Dec=new ConsoleButton(ButtonManager.BUTT_BET_DEC,"Butt_Min",1,50,90,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.BetLine_Inc=new ConsoleButton(ButtonManager.BUTT_BET_INC,"Butt_Pls",1,340,90,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.CoinValue_Label=new DisplayStyle(w_shape,0,162,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:16,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.CoinValue_Display=new DisplayStyle(w_shape,0,187,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:36,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.CoinValue_Dec=new ConsoleButton(ButtonManager.BUTT_COINLEVEL_DEC,"Butt_Min",1,50,180,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.CoinValue_Inc=new ConsoleButton(ButtonManager.BUTT_COINLEVEL_INC,"Butt_Pls",1,340,180,ConsoleButton.TYPE_PUSH_AND_BACK,this.Container,this.ApplicationRef,".webp");this.TotalBet_Display=new DisplayStyle(w_shape,0,290,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:16,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.Style=new ControlStyle(0,0,1)}ConsoleDialogBet.prototype=Object.create(SObject.prototype)
;ConsoleDialogBet.prototype.constructor=ConsoleDialogBet;ConsoleDialogBet.prototype.Init=function(){this.Shape.Setup();this.ExitButton.Setup();this.ExitButton.SetButton(true);this.ExitButton.XX(this.Shape.ACTUAL_W(),-60);this.ExitButton.YY(0,8);this.Lines_Display.Init();this.Lines_Display.Visible(true);this.BetLine_Label.Init();this.BetLine_Label.Visible(true);this.BetLine_Display.Init();this.BetLine_Display.Visible(true);this.BetLine_Dec.Init();this.BetLine_Dec.SetEnable(true);this.BetLine_Inc.Init();this.BetLine_Inc.SetEnable(true);this.CoinValue_Label.Init();this.CoinValue_Label.Visible(true);this.CoinValue_Display.Init();this.CoinValue_Display.Visible(true);this.CoinValue_Dec.Init();this.CoinValue_Dec.SetEnable(true);this.CoinValue_Inc.Init();this.CoinValue_Inc.SetEnable(true);this.TotalBet_Display.Init();this.TotalBet_Display.Visible(true);this.Setup();this.Container.visible=false;this.ParentContainer.addChild(this.Container)};ConsoleDialogBet.prototype.OnResize=function(){this.Setup()};ConsoleDialogBet.prototype.Setup=function(){this.ApplicationRef.CONTROL_BUILDER().GetControlStyle(ControlBuilder.ID_CONSOLE_DIALOG_BET,this.Style);this.Container.x=this.Style.X;this.Container.y=this.Style.Y;this.Container.scale=new PIXI.Point(this.Style.SCALE,this.Style.SCALE)};ConsoleDialogBet.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.ExitButton.SetMaskFilter(TiledSprite.MASK_STAT_GREEN);else if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.ExitButton.SetMaskFilter(TiledSprite.MASK_STAT_NONE);if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.Container.visible=false;return}this.Lines_Display.SetCaption(ConsoleDialogBet.TAB_CAPTIONS[0][window.LANG]+window.NUM_LINEE+ConsoleDialogBet.TAB_CAPTIONS[1][window.LANG]);this.BetLine_Label.SetCaption(ConsoleDialogBet.TAB_CAPTIONS[2][window.LANG]);this.BetLine_Display.SetCaption(this.ApplicationRef.SLOT().BET_LINE());if(this.ApplicationRef.PROGRAMMA().GetSPIN_SET().DecBet_Enabled()==false){if(this.BetLine_Dec.IsEnabled()==true){this.BetLine_Dec.SetEnable(false)}}else{if(this.BetLine_Dec.IsEnabled()==false){this.BetLine_Dec.SetEnable(true)}}this.BetLine_Dec.Refresh(ellapsed_ms);if(this.ApplicationRef.PROGRAMMA().GetSPIN_SET().IncBet_Enabled()==false){if(this.BetLine_Inc.IsEnabled()==true){this.BetLine_Inc.SetEnable(false)}}else{if(this.BetLine_Inc.IsEnabled()==false){this.BetLine_Inc.SetEnable(true)}}this.BetLine_Inc.Refresh(ellapsed_ms);this.CoinValue_Label.SetCaption(ConsoleDialogBet.TAB_CAPTIONS[3][window.LANG]);this.CoinValue_Display.SetCaptionCents(this.ApplicationRef.PLAYER().COIN_VALUE_GET(),this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().VALUTA_STRING());if(this.ApplicationRef.PLAYER().COIN_VALUE_DEC_ENABLED()==false){if(this.CoinValue_Dec.IsEnabled()==true){this.CoinValue_Dec.SetEnable(false)}}else{if(this.CoinValue_Dec.IsEnabled()==false){this.CoinValue_Dec.SetEnable(true)}}this.CoinValue_Dec.Refresh(ellapsed_ms);if(this.ApplicationRef.PLAYER().COIN_VALUE_INC_ENABLED()==false){if(this.CoinValue_Inc.IsEnabled()==true){this.CoinValue_Inc.SetEnable(false)}}else{if(this.CoinValue_Inc.IsEnabled()==false){this.CoinValue_Inc.SetEnable(true)}}this.CoinValue_Inc.Refresh(ellapsed_ms);var tot_bet_coins=this.ApplicationRef.SLOT().TOTAL_BET();var tot_bet_cents=this.ApplicationRef.PLAYER().Coins2Divisa(tot_bet_coins);this.TotalBet_Display.SetCaption(ConsoleDialogBet.TAB_CAPTIONS[4][window.LANG]+this.GetCaptionCents(tot_bet_cents)+this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().VALUTA_STRING()+" / "+tot_bet_coins+ConsoleDialogBet.TAB_CAPTIONS[5][window.LANG])};ConsoleDialogBet.prototype.GetCaptionCents=function(val){var str=""+parseInt(val/100);str+=",";var remind=parseInt(val%100);var remind_str=""+remind;while(remind_str.length<2)remind_str="0"+remind_str;return str+remind_str};ConsoleDialogBet.prototype.OnSpinEvent=function(spin){this.Container.visible=false};ConsoleDialogBet.prototype.IsActive=function(){return this.Container.visible};ConsoleDialogBet.prototype.SetActive=function(act){this.Container.visible=act};ConsoleDialogAuto.TAB_CAPTIONS=[["AUTOPLAY SETTING","IMPOSTAZIONI AUTOPLAY"]];ConsoleDialogAuto.ID_CHECKBOX_STOP_WIN=0;ConsoleDialogAuto.ID_CHECKBOX_STOP_FEATURE=1;ConsoleDialogAuto.TAB_CHECKBOX_ID=[ConsoleDialogAuto.ID_CHECKBOX_STOP_WIN,ConsoleDialogAuto.ID_CHECKBOX_STOP_FEATURE];ConsoleDialogAuto.TAB_CAPTIONS_CB=[["STOP ON ANY WIN","STOP SU VINCITA"],["STOP ON FEATURE","STOP SU FEATURE"]];function ConsoleDialogAuto(app_reference,parent_container){var i;SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.Container=new PIXI.Container;this.Shape=new TiledSprite("Dialog_Box",1,true,this.Container,".webp");var w_shape=440;this.Auto_Title=new DisplayStyle(w_shape,0,20,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:16,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.ExitButton=new TiledSprite("Dialog_Close",1,true,this.Container,".webp");this.ButtonsSet=new Array(Player.TAB_AUTO_SPINS.length);for(i=0;i<this.ButtonsSet.length;i++){this.ButtonsSet[i]=new DialogButton(Player.TAB_AUTO_SPINS[i],this.Container)}this.CheckBoxSet=new Array(ConsoleDialogAuto.TAB_CHECKBOX_ID.length);for(i=0;i<this.CheckBoxSet.length;i++){this.CheckBoxSet[i]=new DialogCheckBox(ConsoleDialogAuto.TAB_CAPTIONS_CB[i][window.LANG],this.Container)}this.Style=new ControlStyle(0,0,1)}ConsoleDialogAuto.prototype=Object.create(SObject.prototype);ConsoleDialogAuto.prototype.constructor=ConsoleDialogAuto;ConsoleDialogAuto.prototype.Init=function(){var i;this.Shape.Setup();this.Auto_Title.Init();this.Auto_Title.Visible(true);this.ExitButton.Setup();this.ExitButton.SetButton(true);this.ExitButton.XX(this.Shape.ACTUAL_W(),-60);this.ExitButton.YY(0,8);for(i=0;i<this.ButtonsSet.length;i++){this.ButtonsSet[i].Init();this.ButtonsSet[i].XX(24,138*parseInt(i%3));this.ButtonsSet[i].YY(60,56*parseInt(i/3));this.ButtonsSet[i].Visible(true)}for(j=0;j<this.CheckBoxSet.length;j++){this.CheckBoxSet[j].Init();this.CheckBoxSet[j].XX(24,0);this.CheckBoxSet[j].YY(170,50*j);this.CheckBoxSet[j].Visible(true)}this.Setup();this.Container.visible=false;this.ParentContainer.addChild(this.Container)};ConsoleDialogAuto.prototype.OnResize=function(){this.Setup()};ConsoleDialogAuto.prototype.Setup=function(){this.ApplicationRef.CONTROL_BUILDER().GetControlStyle(ControlBuilder.ID_CONSOLE_DIALOG_AUTO,this.Style);this.Container.x=this.Style.X;this.Container.y=this.Style.Y;this.Container.scale=new PIXI.Point(this.Style.SCALE,this.Style.SCALE)};ConsoleDialogAuto.prototype.Refresh=function(ellapsed_ms){var i;this.TimerRefresh(ellapsed_ms);this.Auto_Title.SetCaption(ConsoleDialogAuto.TAB_CAPTIONS[0][window.LANG]);if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.ExitButton.SetMaskFilter(TiledSprite.MASK_STAT_GREEN);else if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.ExitButton.SetMaskFilter(TiledSprite.MASK_STAT_NONE);if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.Container.visible=false;return}for(i=0;i<this.ButtonsSet.length;i++){if(this.ButtonsSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.ButtonsSet[i].GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_GREEN);else if(this.ButtonsSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.ButtonsSet[i].GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_NONE);if(this.ButtonsSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.PLAYER().AUTO_SPINS_SET(Player.TAB_AUTO_SPINS[i]);this.ApplicationRef.BUTTON_MANAGER().NotifyStymulus(ButtonManager.BUTT_START);this.Container.visible=false;break}}for(i=0;i<this.CheckBoxSet.length;i++){if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.CheckBoxSet[i].GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_GREEN);else if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.CheckBoxSet[i].GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_NONE);switch(i){case ConsoleDialogAuto.ID_CHECKBOX_STOP_WIN:{if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SLOT().REEL_HOLDER().SET_Auto_BreakAtWin^=1}this.CheckBoxSet[i].SetValue(this.ApplicationRef.SLOT().REEL_HOLDER().SET_Auto_BreakAtWin)}break;case ConsoleDialogAuto.ID_CHECKBOX_STOP_FEATURE:{if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SLOT().REEL_HOLDER().SET_Auto_BreakAtFeature^=1}this.CheckBoxSet[i].SetValue(this.ApplicationRef.SLOT().REEL_HOLDER().SET_Auto_BreakAtFeature)}break;default:break}}};ConsoleDialogAuto.prototype.OnSpinEvent=function(spin){this.Container.visible=false};ConsoleDialogAuto.prototype.IsActive=function(){return this.Container.visible};ConsoleDialogAuto.prototype.SetActive=function(act){var i;this.Container.visible=act;if(act==true){this.ApplicationRef.PROGRAMMA().GetSPIN_SET().BreakAutoPlay();for(i=0;i<this.CheckBoxSet.length;i++){this.CheckBoxSet[i].SetCaption(ConsoleDialogAuto.TAB_CAPTIONS_CB[i][window.LANG])}}};ConsoleDialogSet.ID_BUTT_DEMO1=0;ConsoleDialogSet.ID_BUTT_DEMO2=1;ConsoleDialogSet.ID_BUTT_DEMO3=2;ConsoleDialogSet.ID_BUTT_FULLS=3;ConsoleDialogSet.TAB_BUTTONS_ID=[ConsoleDialogSet.ID_BUTT_DEMO1,ConsoleDialogSet.ID_BUTT_DEMO2,ConsoleDialogSet.ID_BUTT_DEMO3,ConsoleDialogSet.ID_BUTT_FULLS];ConsoleDialogSet.TAB_CAPTIONS_BT=[["GENERAL SETTINGS","IMPOSTAZIONI GENERALI"],["Free spin","Free spin"],["Bonus","Bonus"],["Long wild","Long wild"],["FullScreen","FullScreen"]];ConsoleDialogSet.ID_CHECKBOX_TURBOSPINS=0;ConsoleDialogSet.ID_CHECKBOX_QUICKSPINS=1;ConsoleDialogSet.ID_CHECKBOX_AMBIENT=2;ConsoleDialogSet.ID_CHECKBOX_FX=3;ConsoleDialogSet.ID_CHECKBOX_POWERSAVE=4;ConsoleDialogSet.TAB_CHECKBOX_ID=[ConsoleDialogSet.ID_CHECKBOX_TURBOSPINS,ConsoleDialogSet.ID_CHECKBOX_QUICKSPINS,ConsoleDialogSet.ID_CHECKBOX_AMBIENT,ConsoleDialogSet.ID_CHECKBOX_FX,ConsoleDialogSet.ID_CHECKBOX_POWERSAVE];ConsoleDialogSet.TAB_CAPTIONS_CB=[["TURBO SPIN","TURBO SPIN"],["QUICK SPIN","QUICK SPIN"],["SOUND MUSIC","SUONO MUSICA"],["SOUND FX","SUONO FX"],["POWER SAVE","POWER SAVE"]];function ConsoleDialogSet(app_reference,parent_container){var i;SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.Container=new PIXI.Container;this.Shape=new TiledSprite("Dialog_Box",1,true,this.Container,".webp");var w_shape=440;this.Setting_Title=new DisplayStyle(w_shape,0,20,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:16,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.ExitButton=new TiledSprite("Dialog_Close",1,true,this.Container,".webp");this.ButtonsSet=new Array(ConsoleDialogSet.TAB_BUTTONS_ID.length);for(i=0;i<this.ButtonsSet.length;i++){this.ButtonsSet[i]=new DialogButton(ConsoleDialogSet.TAB_CAPTIONS_BT[1+i][window.LANG],this.Container)}this.CheckBoxSet=new Array(ConsoleDialogSet.TAB_CHECKBOX_ID.length);for(i=0;i<this.CheckBoxSet.length;i++){this.CheckBoxSet[i]=new DialogCheckBox(ConsoleDialogSet.TAB_CAPTIONS_CB[i][window.LANG],this.Container)}this.Style=new ControlStyle(0,0,1)}ConsoleDialogSet.prototype=Object.create(SObject.prototype);ConsoleDialogSet.prototype.constructor=ConsoleDialogSet;ConsoleDialogSet.prototype.Init=function(){var i,j;this.Shape.Setup();this.Setting_Title.Init();this.Setting_Title.Visible(true);this.ExitButton.Setup();this.ExitButton.SetButton(true);this.ExitButton.XX(this.Shape.ACTUAL_W(),-60);this.ExitButton.YY(0,8);for(i=0;i<this.ButtonsSet.length;i++){this.ButtonsSet[i].Init();this.ButtonsSet[i].XX(24,138*parseInt(i%3));this.ButtonsSet[i].YY(72,50*parseInt(i/3));if(i!=this.ButtonsSet.length-1)this.ButtonsSet[i].Visible(true)}this.ButtonsSet[ConsoleDialogSet.ID_BUTT_FULLS].GetSprite().Sprite.on("touchend",ToggleFullScreen);this.ButtonsSet[ConsoleDialogSet.ID_BUTT_FULLS].GetSprite().Sprite.on("click",ToggleFullScreen);for(j=0;j<this.CheckBoxSet.length;j++){this.CheckBoxSet[j].Init();this.CheckBoxSet[j].XX(24,180*parseInt(j%2));this.CheckBoxSet[j].YY(174,55*parseInt(j/2));if(j==ConsoleDialogSet.ID_CHECKBOX_POWERSAVE){if(window.MOBILE==true){this.CheckBoxSet[j].Visible(true);this.CheckBoxSet[j].GetSprite().Sprite.on("touchend",ToggleNoSleep);this.CheckBoxSet[j].GetSprite().Sprite.on("click",ToggleNoSleep)}else this.CheckBoxSet[j].Visible(false)}else this.CheckBoxSet[j].Visible(true)}this.Setup();this.Container.visible=false;this.ParentContainer.addChild(this.Container)};ConsoleDialogSet.prototype.OnResize=function(){this.Setup()};ConsoleDialogSet.prototype.Setup=function(){this.ApplicationRef.CONTROL_BUILDER().GetControlStyle(ControlBuilder.ID_CONSOLE_DIALOG_SET,this.Style);this.Container.x=this.Style.X;this.Container.y=this.Style.Y;this.Container.scale=new PIXI.Point(this.Style.SCALE,this.Style.SCALE)};ConsoleDialogSet.prototype.Refresh=function(ellapsed_ms){var i;this.TimerRefresh(ellapsed_ms);this.Setting_Title.SetCaption(ConsoleDialogSet.TAB_CAPTIONS_BT[0][window.LANG]);if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.ExitButton.SetMaskFilter(TiledSprite.MASK_STAT_GREEN);else if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.ExitButton.SetMaskFilter(TiledSprite.MASK_STAT_NONE);if(this.ExitButton.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.Container.visible=false;return}for(i=0;i<this.ButtonsSet.length;i++){if(this.ButtonsSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.ButtonsSet[i].GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_GREEN);else if(this.ButtonsSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.ButtonsSet[i].GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_NONE);if(this.ButtonsSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){switch(i){case ConsoleDialogSet.ID_BUTT_DEMO1:{this.ApplicationRef.BUTTON_MANAGER().NotifyStymulus(ButtonManager.BUTT_DEMO_FEATURE_1)}break;case ConsoleDialogSet.ID_BUTT_DEMO2:{this.ApplicationRef.BUTTON_MANAGER().NotifyStymulus(ButtonManager.BUTT_DEMO_FEATURE_2)}break;case ConsoleDialogSet.ID_BUTT_DEMO3:{this.ApplicationRef.BUTTON_MANAGER().NotifyStymulus(ButtonManager.BUTT_DEMO_FEATURE_3)}break;case ConsoleDialogSet.ID_BUTT_FULLS:{this.Container.visible=false}break;default:break}break}}for(i=0;i<this.CheckBoxSet.length;i++){if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true)this.CheckBoxSet[i].GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_GREEN);else if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true)this.CheckBoxSet[i].GetSprite().SetMaskFilter(TiledSprite.MASK_STAT_NONE);switch(i){case ConsoleDialogSet.ID_CHECKBOX_TURBOSPINS:{if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SLOT().REEL_HOLDER().SET_Turbo_Spins^=1;this.ApplicationRef.SLOT().REEL_HOLDER().SET_Quick_Spins=0}this.CheckBoxSet[i].SetValue(this.ApplicationRef.SLOT().REEL_HOLDER().SET_Turbo_Spins)}break;case ConsoleDialogSet.ID_CHECKBOX_QUICKSPINS:{if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SLOT().REEL_HOLDER().SET_Turbo_Spins=0;this.ApplicationRef.SLOT().REEL_HOLDER().SET_Quick_Spins^=1}this.CheckBoxSet[i].SetValue(this.ApplicationRef.SLOT().REEL_HOLDER().SET_Quick_Spins)}break;case ConsoleDialogSet.ID_CHECKBOX_AMBIENT:{if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SOUNDGENERATOR().Stop();this.ApplicationRef.SOUNDGENERATOR().SET_PlayMusic^=1;if(this.ApplicationRef.SOUNDGENERATOR().AudioEnabled&&this.ApplicationRef.SOUNDGENERATOR().SET_PlayMusic){this.ApplicationRef.SLOT().PlayMusic()}}this.CheckBoxSet[i].SetValue(this.ApplicationRef.SOUNDGENERATOR().SET_PlayMusic)}break;case ConsoleDialogSet.ID_CHECKBOX_FX:{if(this.CheckBoxSet[i].GetSprite().CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SOUNDGENERATOR().SET_PlayFX^=1}this.CheckBoxSet[i].SetValue(this.ApplicationRef.SOUNDGENERATOR().SET_PlayFX)}break;case ConsoleDialogSet.ID_CHECKBOX_POWERSAVE:{this.CheckBoxSet[i].SetValue(window.POWER_SAVE)}break;default:break}}};ConsoleDialogSet.prototype.OnSpinEvent=function(spin){this.Container.visible=false};ConsoleDialogSet.prototype.IsActive=function(){return this.Container.visible};ConsoleDialogSet.prototype.SetActive=function(act){this.Container.visible=act;if(act==true){if(window.DEMO_PLAY==false){this.ButtonsSet[ConsoleDialogSet.ID_BUTT_DEMO1].SetEnabled(false);this.ButtonsSet[ConsoleDialogSet.ID_BUTT_DEMO2].SetEnabled(false);this.ButtonsSet[ConsoleDialogSet.ID_BUTT_DEMO3].SetEnabled(false)}for(i=0;i<this.CheckBoxSet.length;i++){this.CheckBoxSet[i].SetCaption(ConsoleDialogSet.TAB_CAPTIONS_CB[i][window.LANG])}this.ApplicationRef.PROGRAMMA().GetSPIN_SET().BreakAutoPlay()}};function ConsoleContainer(parent_container,app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.Container=new PIXI.Container;this.Panel=new TiledSprite("Panel",1,true,this.Container,".webp");this.Bill=new ConsoleBill(app_reference,this.Container);this.Info=new ConsoleInfo(app_reference,this.Container);this.Settings=new ConsoleSettings(app_reference,this.Container);this.Spin=new ConsoleSpin(app_reference,this.Container);this.DialogBet=new ConsoleDialogBet(app_reference,this.ParentContainer);this.DialogAuto=new ConsoleDialogAuto(app_reference,this.ParentContainer);this.DialogSet=new ConsoleDialogSet(app_reference,this.ParentContainer);this.FullScreenArea=new TiledSprite("FullScreen",2,false,this.ParentContainer,".webp");this.FullScreenTip=0}ConsoleContainer.prototype=Object.create(SObject.prototype);ConsoleContainer.prototype.constructor=ConsoleContainer;ConsoleContainer.prototype.Init=function(){this.Panel.Setup();this.Bill.Init();this.Info.Init();this.Settings.Init();this.Spin.Init();this.DialogBet.Init();this.DialogAuto.Init();this.DialogSet.Init();this.Container.y=window.VIDEO_HEIGHT-this.Panel.GetSprite().height;this.ParentContainer.addChild(this.Container);this.FullScreenArea.Setup();this.FullScreenArea.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.ApplicationRef.SLOT().REEL_FRAME().ReelFrame.SetButton(true);this.ApplicationRef.SLOT().REEL_FRAME().ReelFrame.Sprite.on("touchend",ToggleFullScreen);this.ApplicationRef.SLOT().REEL_FRAME().ReelFrame.Sprite.on("click",ToggleFullScreen);this.GPTimer=this.ArmaTimer(this.GPTimer,5e3)};ConsoleContainer.prototype.TouchToResize=function(){return window.MOBILE==true&&window.IOS==false&&this.ApplicationRef.IsPortrait()==false&&this.DialogBet.IsActive()==false&&this.DialogAuto.IsActive()==false&&this.DialogSet.IsActive()==false};ConsoleContainer.prototype.OnResize=function(){this.Bill.OnResize();this.Info.OnResize();this.Spin.OnResize();this.DialogBet.OnResize();this.DialogAuto.OnResize();this.DialogSet.OnResize()};ConsoleContainer.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);this.Bill.Refresh(ellapsed_ms);this.Info.Refresh(ellapsed_ms);this.Settings.Refresh(ellapsed_ms);this.Spin.Refresh(ellapsed_ms);if(this.DialogBet.IsActive()==true)this.DialogBet.Refresh(ellapsed_ms);if(this.DialogAuto.IsActive()==true)this.DialogAuto.Refresh(ellapsed_ms);if(this.DialogSet.IsActive()==true)this.DialogSet.Refresh(ellapsed_ms);this.FullScreenArea.Refresh(ellapsed_ms);if(this.TouchToResize()==true){if(window.FULL_SCREEN==false&&window.FULL_SCREEN_DONE==false&&this.GPTimer==0&&this.FullScreenTip<3){if(this.FullScreenArea.CurFrame==0){this.FullScreenArea.ResetProperties(true,1,1);this.FullScreenArea.SetFrame(1);this.FullScreenArea.SPRITE_TRANSFORMER().Pause(1e3);this.FullScreenArea.SPRITE_TRANSFORMER().ScaleAndGoto(1.2,1,10,10,0)}else{if(this.FullScreenArea.TransformOver()==true){this.FullScreenArea.SetFrame(0);this.FullScreenArea.ResetProperties(false,1,1);this.FullScreenArea.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.GPTimer=this.ArmaTimer(this.GPTimer,1e4);this.FullScreenTip++}}}else{this.FullScreenArea.StopTransform();this.FullScreenArea.SetFrame(0);this.FullScreenArea.ResetProperties(false,1,1);this.FullScreenArea.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT)}}else this.FullScreenArea.ResetProperties(false,1,1);if(window.SCREEN_TIPPED==true){this.OnOuterToch();window.SCREEN_TIPPED=false}};ConsoleContainer.prototype.OnOuterToch=function(){if(this.DialogBet.IsActive()==true)this.DialogBet.OnSpinEvent();if(this.DialogAuto.IsActive()==true)this.DialogAuto.OnSpinEvent();if(this.DialogSet.IsActive()==true)this.DialogSet.OnSpinEvent();this.Settings.SliderVolume_Disable()};ConsoleContainer.prototype.OnSpinEvent=function(spin){if(this.ApplicationRef.SLOT().FREESPIN().IsArmed()==true){this.Disable()}else if(this.ApplicationRef.SLOT().FREESPIN().IsRunning()==true){this.Disable();this.Spin.OnSpinEvent(spin)}else{this.Bill.OnSpinEvent(spin);this.Settings.OnSpinEvent(spin);this.Spin.OnSpinEvent(spin);if(this.DialogBet.IsActive()==true)this.DialogBet.OnSpinEvent();if(this.DialogAuto.IsActive()==true)this.DialogAuto.OnSpinEvent();if(this.DialogSet.IsActive()==true)this.DialogSet.OnSpinEvent()}};ConsoleContainer.prototype.OnBrakeEnable=function(){if(this.ApplicationRef.SLOT().FREESPIN_IsRunning()==true){this.Disable()}else this.Spin.OnBrakeEnable()};ConsoleContainer.prototype.OnBrakePushed=function(){this.Spin.OnBrakePushed()};ConsoleContainer.prototype.SetFreezeCounters=function(frz){this.Bill.SetFreezeCounters(frz)};ConsoleContainer.prototype.UpdateDisplayQueue=function(){this.Info.UpdateDisplayQueue()};ConsoleContainer.prototype.Disable=function(){this.Settings.Disable();this.Spin.Disable()};ConsoleContainer.prototype.Enable=function(){if(this.ApplicationRef.SLOT().FREESPIN_IsRunning()==true){this.Disable()}else{this.Settings.Enable();this.Spin.Enable()}};ConsoleContainer.prototype.SetStaticDisplay=function(str,queue){this.Info.SetCaption(str,queue)};ConsoleContainer.prototype.DialogBetEnable=function(enb){this.DialogBet.SetActive(enb);if(enb==true){this.DialogAuto.SetActive(false);this.DialogSet.SetActive(false)}};ConsoleContainer.prototype.DialogAutoEnable=function(enb){this.DialogAuto.SetActive(enb);if(enb==true){this.DialogBet.SetActive(false);this.DialogSet.SetActive(false)}};ConsoleContainer.prototype.DialogSetEnable=function(enb){this.DialogSet.SetActive(enb);if(enb==true){this.DialogAuto.SetActive(false);this.DialogBet.SetActive(false)}};ConsoleContainer.prototype.SpinSet=function(enb){if(enb==true)this.Enable();if(this.TouchToResize()==true){if(enb==true){this.FullScreenArea.SetFrame(0);this.GPTimer=this.ArmaTimer(this.GPTimer,5e3)}else{this.FullScreenArea.Visible(false)}}};ConsoleContainer.prototype.CONTAINER=function(){return this.Container};function PayTableCoords(xx,yy,page,vsb){SObject.call(this);this.X=xx;this.Y=yy;this.PAGE=page;this.VISIBLE=vsb}PayTableCoords.prototype=Object.create(SObject.prototype);PayTableCoords.prototype.constructor=PayTableCoords;PayTableQuotazione.FONT_FAMILY="Game_Font";PayTableQuotazione.FONT_SIZE=40;PayTableQuotazione.FONT_STYLE="normal";PayTableQuotazione.FONT_WEIGHT="bold";PayTableQuotazione.FONT_FILL="white";function PayTableQuotazione(id,app_reference,parent_container){SObject.call(this);this.ID=id;this.ParentContainer=parent_container;this.ApplicationRef=app_reference;this.DisplayQuotazione=new DisplayStyle(10,0,0,"right",this.ParentContainer,new PIXI.TextStyle({fontFamily:PayTableQuotazione.FONT_FAMILY,fontSize:PayTableQuotazione.FONT_SIZE,fontStyle:PayTableQuotazione.FONT_STYLE,fontWeight:PayTableQuotazione.FONT_WEIGHT,fill:PayTableQuotazione.FONT_FILL}));this.Render=false}PayTableQuotazione.prototype=Object.create(SObject.prototype);PayTableQuotazione.prototype.constructor=PayTableQuotazione;PayTableQuotazione.prototype.Renderize=function(p_xx,p_yy,max_width){const quot=this.ApplicationRef.SLOT().SLOT_COMBO().GetQuotazioneCombinazione(this.ID);let ww=max_width;if(quot!=0){this.DisplayQuotazione.SetCaptionCents(quot,this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().VALUTA_STRING());if(ww==0){ww=this.DisplayQuotazione.ACTUAL_W()}this.DisplayQuotazione.XX(p_xx,ww);this.DisplayQuotazione.YY(p_yy,30);this.Render=true}else{this.Render=false;this.DisplayQuotazione.Visible(false)}return ww};PayTableQuotazione.prototype.Visible=function(vsb){this.DisplayQuotazione.Visible(vsb)};PayTableQuotazione.prototype.Renderable=function(){return this.Render};PayTable.NUM_SHEETS=10;PayTable.POS_Y=100;PayTable.CANVAS_H=790;PayTable.TAB_COORDINATE=[new PayTableCoords(0,0,0),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(1262,768,0,true),new PayTableCoords(1262,768,0,false),new PayTableCoords(864,768,0,true),new PayTableCoords(545,768,0,true),new PayTableCoords(1262,617,0,true),new PayTableCoords(545,617,0,true),new PayTableCoords(1262,475,0,true),new PayTableCoords(545,475,0,true),new PayTableCoords(1262,329,0,true),new PayTableCoords(545,329,0,true),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(1262,768-36,0,true),new PayTableCoords(1262,768-36,0,false),new PayTableCoords(864,768-36,0,true),new PayTableCoords(545,768-36,0,true),new PayTableCoords(1262,617-36,0,true),new PayTableCoords(545,617-36,0,true),new PayTableCoords(1262,475-36,0,true),new PayTableCoords(545,475-36,0,true),new PayTableCoords(1262,329-36,0,true),new PayTableCoords(545,329-36,0,true),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(1262,768-72,0,true),new PayTableCoords(1262,768-72,0,false),new PayTableCoords(864,768-72,0,true),new PayTableCoords(545,768-72,0,true),new PayTableCoords(1262,617-72,0,true),new PayTableCoords(545,617-72,0,true),new PayTableCoords(1262,475-72,0,true),new PayTableCoords(545,475-72,0,true),new PayTableCoords(1262,329-72,0,true),new PayTableCoords(545,329-72,0,true),new PayTableCoords(864,329-32,0,true),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false),new PayTableCoords(0,0,0,false)];function PayTable(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=this.ApplicationRef.MainStage;this.Container=new PIXI.Container;this.ParentContainer=null;this.Black=new PIXI.Graphics;this.Black.beginFill(0,.7);this.Black.drawRect(0,0,window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.Black.endFill();this.BackGround=new TiledSprite("Help_",PayTable.NUM_SHEETS,true,this.Container,".webp");this.Quotazioni=[];for(let i=0;i<window.NUM_COMBINAZIONI_SLOT;i++){this.Quotazioni.push(new PayTableQuotazione(i,this.ApplicationRef,this.Container))}this.Butt_Prev=new TiledSprite("help_prev",3,true,this.Container,".webp");this.Butt_Exit=new TiledSprite("help_exit",3,true,this.Container,".webp");this.Butt_Next=new TiledSprite("help_next",3,true,this.Container,".webp");this.Step=0;this.PageView=0;this.Mounted=false;this.Container.visible=false}PayTable.prototype=Object.create(SObject.prototype);PayTable.prototype.constructor=PayTable;PayTable.prototype.Init=function(){var button_scale=1;this.Container.addChild(this.Black);this.Black.visible=true;this.BackGround.Setup();this.BackGround.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.BackGround.YY(PayTable.POS_Y,0);if(window.MOBILE==true)button_scale=2;this.Butt_Exit.Setup();this.Butt_Exit.ResetProperties(true,1,button_scale);this.Butt_Exit.SetButton(true);this.Butt_Exit.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT,true);this.Butt_Exit.YY(PayTable.POS_Y+PayTable.CANVAS_H,0);this.Butt_Prev.Setup();this.Butt_Prev.ResetProperties(true,1,button_scale);this.Butt_Prev.SetButton(true);this.Butt_Prev.XX(this.Butt_Exit.Sprite.x,-200);this.Butt_Prev.YY(this.Butt_Exit.Sprite.y,0);this.Butt_Next.Setup();this.Butt_Next.ResetProperties(true,1,button_scale);this.Butt_Next.SetButton(true);this.Butt_Next.XX(this.Butt_Exit.Sprite.x,200);this.Butt_Next.YY(this.Butt_Exit.Sprite.y,0)};PayTable.prototype.Renderize=function(){let ww=0;for(let i=window.NUM_COMBINAZIONI_SLOT-1;i>=0;i--){if(PayTable.TAB_COORDINATE[i].VISIBLE==true)ww=this.Quotazioni[i].Renderize(PayTable.TAB_COORDINATE[i].X,PayTable.TAB_COORDINATE[i].Y,ww)}};PayTable.prototype.Mount=function(parent_container){this.Mounted=true;this.ApplicationRef.CONSOLE().Disable();this.MainStage.addChild(this.Container);this.Container.visible=true;this.ExitRequest=false;this.Renderize();this.PageSetup(0);this.Step=1};PayTable.prototype.UnMount=function(){if(this.Mounted==true){this.Step=0;this.MainStage.removeChild(this.Container);this.Mounted=false;this.ExitRequest=false;this.Container.visible=false;this.ApplicationRef.CONSOLE().Enable()}};PayTable.prototype.PageSetup=function(page_index){this.PageView=page_index;this.BackGround.SetFrame(page_index);for(let i=0;i<window.NUM_COMBINAZIONI_SLOT;i++){if(PayTable.TAB_COORDINATE[i].PAGE==page_index&&this.Quotazioni[i].Renderable()==true)this.Quotazioni[i].Visible(true);else this.Quotazioni[i].Visible(false)}this.Butt_Prev.Visible(true);this.Butt_Exit.Visible(true);this.Butt_Next.Visible(true)};PayTable.prototype.Refresh=function(ellapsed_time){if(this.Mounted==true){switch(this.Step){case 0:{}break;case 1:{if(this.Butt_Exit.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.UnMount()}else if(this.Butt_Prev.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.PagePrev()}else if(this.Butt_Next.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.PageNext()}}break;default:break}}};PayTable.prototype.PagePrev=function(){if(this.PageView>0)this.PageView--;else this.PageView=PayTable.NUM_SHEETS-1;this.PageSetup(this.PageView)};PayTable.prototype.PageNext=function(){if(++this.PageView>=PayTable.NUM_SHEETS)this.PageView=0;this.PageSetup(this.PageView)};PayTable.prototype.IsMounted=function(){return this.Mounted};PayTable.prototype.Exit=function(){return this.ExitRequest};SlotStage.TEATRO_NORMAL=0;SlotStage.TEATRO_FREESPIN=1;SlotStage.TEATRO_BONUS=2;function SlotStage(stage_container,app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.ParentStage=stage_container;this.Container=new PIXI.Container;this.Background=new TiledSprite("Teatro",1,true,this.Container,".webp");this.BackgroundFS=new TiledSprite("TeatroFS",1,false,this.Container,".webp");this.BackgroundBN=null;this.Reels=new TiledSprite("Reels",1,true,this.Container,".webp");this.ReelsFS=new TiledSprite("ReelsFS",1,false,this.Container,".webp");this.SnowEmitter=null;this.GameType=SlotStage.TEATRO_NORMAL}SlotStage.prototype=Object.create(SObject.prototype);SlotStage.prototype.constructor=SlotStage;SlotStage.prototype.Init=function(){var resources;var json_data;this.Background.Setup();this.BackgroundFS.Setup();resources=this.ApplicationRef.TEXTURE_DB();json_data=resources["PRT_Snow"].data;this.SnowEmitter=new PIXI.particles.Emitter(this.Container,[PIXI.Texture.fromFrame("Star1.webp"),PIXI.Texture.fromFrame("Star2.webp"),PIXI.Texture.fromFrame("Star3.webp"),PIXI.Texture.fromFrame("Star4.webp")],json_data);this.Reels.Setup();if(this.ReelsFS!=null)this.ReelsFS.Setup()
;this.ParentStage.addChild(this.Container);this.SnowEmitter.emit=true;this.GPTimer=this.ArmaTimer(this.GPTimer,1500)};SlotStage.prototype.SetType=function(id_type){if(id_type==SlotStage.TEATRO_NORMAL){this.BackgroundFS.Visible(false);this.Background.Visible(true);this.Reels.Visible(true);this.ReelsFS.Visible(false);this.ApplicationRef.SLOT().REEL_HOLDER().SetSpecialReel(ReelHolder.SPECIAL_REEL_MULTY);this.SnowEmitter.emit=true;this.GameType=SlotStage.TEATRO_NORMAL;this.PlayMusic()}else if(id_type==SlotStage.TEATRO_FREESPIN){this.BackgroundFS.Visible(true);this.Background.Visible(false);this.Reels.Visible(false);this.ReelsFS.Visible(true);this.ApplicationRef.SLOT().REEL_HOLDER().SetSpecialReel(ReelHolder.SPECIAL_REEL_SYMBOL);this.SnowEmitter.emit=false;this.GameType=SlotStage.TEATRO_FREESPIN}else if(id_type==SlotStage.TEATRO_BONUS){this.GameType=SlotStage.TEATRO_BONUS}this.ApplicationRef.SLOT().REEL_FRAME().SetType(id_type)};SlotStage.prototype.Refresh=function(ellapsed_ms){SObject.prototype.TimerRefresh.call(this,ellapsed_ms);if(this.GPTimer==0)this.SnowEmitter.emit=false;this.SnowEmitter.update(ellapsed_ms*.001);this.Background.Refresh(ellapsed_ms);this.Reels.Refresh(ellapsed_ms)};SlotStage.prototype.PlayMusic=function(){switch(this.GameType){case SlotStage.TEATRO_NORMAL:{this._playStageMusic(SoundGenerator.FREESPIN_LOOP,SoundGenerator.BONUS_LOOP,SoundGenerator.GAME_LOOP,SoundGenerator.SMP_VOLUME_SUPER_REDUCE|SoundGenerator.SMP_LOOP)}break;case SlotStage.TEATRO_FREESPIN:{this._playStageMusic(SoundGenerator.GAME_LOOP,SoundGenerator.BONUS_LOOP,SoundGenerator.FREESPIN_LOOP,SoundGenerator.SMP_VOLUME_NORMAL|SoundGenerator.SMP_LOOP)}break;case SlotStage.TEATRO_BONUS:{this._playStageMusic(SoundGenerator.FREESPIN_LOOP,SoundGenerator.GAME_LOOP,SoundGenerator.BONUS_LOOP,SoundGenerator.SMP_VOLUME_NORMAL|SoundGenerator.SMP_LOOP)}break;default:break}};SlotStage.prototype._playStageMusic=function(idSndStage1Stop,idSndStage2Stop,idSndStage,flags){if(this.ApplicationRef.SOUNDGENERATOR().IsPlaying(idSndStage1Stop)==true)this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(idSndStage1Stop);if(this.ApplicationRef.SOUNDGENERATOR().IsPlaying(idSndStage2Stop)==true)this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(idSndStage2Stop);if(this.ApplicationRef.SOUNDGENERATOR().IsPaused(idSndStage)==true){this.ApplicationRef.SOUNDGENERATOR().Resume(idSndStage,flags)}else if(this.ApplicationRef.SOUNDGENERATOR().IsPlaying(idSndStage)==false){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(idSndStage,flags,true)}};SlotFrame.ORG_MULTIPLIER_X=1525;SlotFrame.ORG_MULTIPLIER_Y=105;function SlotFrame(stage_container,app_reference){var i;var str;SObject.call(this);this.ApplicationRef=app_reference;this.ParentStage=stage_container;this.Container=new PIXI.Container;this.ReelFrame=new TiledSprite("Frame",1,true,this.Container,".webp");this.ReelFrameFS=new TiledSprite("FrameFS",1,false,this.Container,".webp");this.Logo=new TiledSprite("Title",1,true,this.Container,".webp");this.Black=new PIXI.Graphics;this.Black.beginFill(0,1);this.Black.drawRect(0,0,window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.Black.endFill();this.GPTimer=this.ArmaTimer(this.GPTimer,100);this.LogoStatus=0}SlotFrame.prototype=Object.create(SObject.prototype);SlotFrame.prototype.constructor=SlotStage;SlotFrame.prototype.Init=function(){var i;this.ReelFrame.Setup();this.ReelFrameFS.Setup();this.Container.addChild(this.Black);this.Black.visible=true;this.Logo.Setup();this.Logo.ResetProperties(true,1,.7);this.Logo.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT,true);this.Logo.YY(0,0);this.GPTimer=this.ArmaTimer(this.GPTimer,100);this.SetType(SlotStage.TEATRO_NORMAL);this.ParentStage.addChild(this.Container)};SlotFrame.prototype.SetType=function(id_type){if(id_type==SlotStage.TEATRO_NORMAL){this.ReelFrame.ResetProperties(true,1,1);this.ReelFrameFS.ResetProperties(false,1,1)}else{this.ReelFrame.ResetProperties(false,1,1);this.ReelFrameFS.ResetProperties(true,1,1)}};SlotFrame.prototype.Refresh=function(ellapsed_ms){var i,rnd;this.TimerRefresh(ellapsed_ms);switch(this.LogoStatus){case 0:{if(this.GPTimer==0&&this.ApplicationRef.SLOT().Initialized==true){window.BENCH_ENABLE=true;this.LogoStatus++}}break;case 1:{if(this.Black.alpha<=0){this.ApplicationRef.Preloader_Unmount();this.LogoStatus++}else{this.Black.alpha-=this.DeviceInc(.01)}}break;case 2:{}break;case 3:{}break;case 4:{}break;case 5:{}break;case 6:{}break;default:break}this.Logo.Refresh(ellapsed_ms)};function ReelAnimationAction(action,float_parms_array,uint_parms_array){SObject.call(this);this.Action=action;this.FloatParms=float_parms_array;this.UintParms=uint_parms_array}ReelAnimationAction.prototype=Object.create(SObject.prototype);ReelAnimationAction.prototype.constructor=ReelAnimationAction;ReelAnimationInfo.TYPE_PULSE_STATIC=0;ReelAnimationInfo.TYPE_PULSE_MEDIA_ALPHA_BLINK=1;ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE=2;ReelAnimationInfo.TYPE_PULSE_MEDIA_CLIP=3;ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE=4;ReelAnimationInfo.FLG_ANI_NONE=0;ReelAnimationInfo.FLG_ANI_LOOP=32768;function ReelAnimationInfo(media_type,res_name,tot_frames,frame_rate,flags,actions_array){SObject.call(this);this.m_MediaType=media_type;this.m_ResourceID=res_name;this.m_TotFrames=tot_frames;this.m_FrameTime=frame_rate;this.m_Flags=flags;this.m_ActionsArray=actions_array}ReelAnimationInfo.prototype=Object.create(SObject.prototype);ReelAnimationInfo.prototype.constructor=ReelAnimationInfo;ReelAnimation.NUM_SIMBOLI=14;ReelAnimation.TRANSFORM_STEPS=20;ReelAnimation.TRANSFORM_UNLY_FRAMES=0;ReelAnimation.TRANSFORM_UNLY_STEPS=0;ReelAnimation.TRANSFORM_UNLY_TIME=100;ReelAnimation.TRANSFORM_MIDY_TIME=60;ReelAnimation.TYPE_ANIMATION_NORMAL=0;ReelAnimation.TYPE_ANIMATION_SNAPSHOT=4096;ReelAnimation.TYPE_MASK_SYMBOL=0;ReelAnimation.TYPE_MASK_OVERLAY=256;ReelAnimation.TYPE_MASK_UNDERLAY=512;ReelAnimation.TAB_REEL_PULSE_TYPE=[new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym00_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym01_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym02_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym03_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym04_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym05_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym06_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym07_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym08_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym09_",50,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym10_",31,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym11_",31,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym12_",45,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym13_",16,ReelAnimation.TRANSFORM_MIDY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"AniSym14_",20,ReelAnimation.TRANSFORM_MIDY_TIME,0,null)];ReelAnimation.TAB_UNLY_PULSE_TYPE=[new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),null,null,new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",20,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",20,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",20,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE,"WinBackA_",15,ReelAnimation.TRANSFORM_UNLY_TIME,ReelAnimationInfo.FLG_ANI_LOOP|0,null)];ReelAnimation.TAB_OVLY_PULSE_TYPE=[new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null),new ReelAnimationInfo(ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE,"WinFrame_",20,0,ReelAnimationInfo.FLG_ANI_NONE,null)];function ReelAnimation(id,root_container,app_reference){SObject.call(this);this.ID=id;this.IDSimbolo=0;this.Loops=0;this.AnimationLine=0;this.AnimationType=0;this.AnimationMedia=0;this.AnimationReloadTime=0;this.AnimationFrame=0;this.AnimateOnFreespins=false;this.ApplicationRef=app_reference;this.AnimationContainer=root_container;if((id&(ReelAnimation.TYPE_MASK_OVERLAY|ReelAnimation.TYPE_MASK_UNDERLAY))==0){this.UnderlayAnimation=new ReelAnimation(ReelAnimation.TYPE_MASK_UNDERLAY|id,root_container,app_reference)}else{this.UnderlayAnimation=null}this.AnimationTile=new TiledSprite("AniSym00_",15,true,this.AnimationContainer,".webp");if((id&(ReelAnimation.TYPE_MASK_OVERLAY|ReelAnimation.TYPE_MASK_UNDERLAY))==0){this.OverlayAnimation=new ReelAnimation(ReelAnimation.TYPE_MASK_OVERLAY|id,root_container,app_reference)}else{this.OverlayAnimation=null}}ReelAnimation.prototype=Object.create(SObject.prototype);ReelAnimation.prototype.constructor=ReelAnimation;ReelAnimation.prototype.Init=function(){if(this.UnderlayAnimation!=null)this.UnderlayAnimation.Init();this.AnimationTile.Setup();if(this.OverlayAnimation!=null)this.OverlayAnimation.Init()};ReelAnimation.prototype.AnimateInit=function(id_sym,ani_line,ani_type){if(this.UnderlayAnimation!=null)this.UnderlayAnimation.AnimateInit(id_sym,ani_line,ani_type);this.IDSimbolo=id_sym;this.AnimationLine=ani_line;this.AnimationType=ani_type;this.Loops=0;this.AnimationTile.XX(0,0);this.AnimationTile.YY(0,0);this.AnimationTile.ResetProperties(false,1,1);this.SetupMedia();if(this.OverlayAnimation!=null)this.OverlayAnimation.AnimateInit(id_sym,ani_line,ani_type)};ReelAnimation.prototype.Animate=function(ellapsed_time){var tab_index;var tab_ani=null;if(this.UnderlayAnimation!=null)this.UnderlayAnimation.Animate(ellapsed_time);this.TimerRefresh(ellapsed_time);this.AnimationTile.SPRITE_TRANSFORMER().Refresh(ellapsed_time);tab_ani=this.GetTabAni();tab_index=this.GetTabIndex();if(tab_ani[tab_index]==null)return;if(this.GPTimer==0){switch(this.AnimationMedia){case ReelAnimationInfo.TYPE_PULSE_MEDIA_ALPHA_BLINK:{if(++this.AnimationFrame>=2){this.AnimationFrame=0;this.Loops++}if(this.AnimationFrame==1)this.AnimationTile.GetSprite().alpha=1;else this.AnimationTile.GetSprite().alpha=.3;this.GPTimer=tab_ani[tab_index].m_FrameTime}break;case ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE:{if((this.ID&(ReelAnimation.TYPE_MASK_OVERLAY|ReelAnimation.TYPE_MASK_UNDERLAY))==0&&(this.AnimationType&ReelAnimation.TYPE_ANIMATION_SNAPSHOT)!=0){if(this.AnimationFrame==1){this.Loops++;this.AnimationFrame=0}this.GPTimer=this.AnimationType&255;this.AnimationTile.SetFrame(0);this.AnimationFrame++}else{if(this.AnimationFrame<tab_ani[tab_index].m_TotFrames){if(++this.AnimationFrame>=tab_ani[tab_index].m_TotFrames){if((tab_ani[tab_index].m_Flags&ReelAnimationInfo.FLG_ANI_LOOP)!=0){this.AnimationFrame=tab_ani[tab_index].m_Flags&32767;this.Loops++}else{this.AnimationFrame=tab_ani[tab_index].m_TotFrames-1;this.Loops=1}}this.GPTimer=tab_ani[tab_index].m_FrameTime;this.AnimationTile.SetFrame(this.AnimationFrame)}}}break;default:break}}if(this.OverlayAnimation!=null)this.OverlayAnimation.Animate(ellapsed_time)};ReelAnimation.prototype.AnimateOver=function(){if(this.UnderlayAnimation!=null)this.UnderlayAnimation.AnimateOver();if(this.OverlayAnimation!=null)this.OverlayAnimation.AnimateOver();this.AnimationTile.Visible(false)};ReelAnimation.prototype.GetCompletedLoops=function(){return this.Loops};ReelAnimation.prototype.AnimationFreeSpin=function(enb){this.AnimateOnFreespins=enb;if(this.UnderlayAnimation!=null)this.UnderlayAnimation.AnimationFreeSpin(enb);if(this.OverlayAnimation!=null)this.OverlayAnimation.AnimationFreeSpin(enb)};ReelAnimation.prototype.SetupMedia=function(){var tab_index;var tab_ani=null;tab_ani=this.GetTabAni();tab_index=this.GetTabIndex();if(tab_ani[tab_index]==null)return;this.AnimationMedia=tab_ani[tab_index].m_MediaType;switch(this.AnimationMedia){case ReelAnimationInfo.TYPE_PULSE_STATIC:{this.AnimationTile.SetNewTile(tab_ani[tab_index].m_ResourceID,tab_ani[tab_index].m_TotFrames,".webp");this.AnimationTile.SetFrame(this.IDSimbolo-window.ID_SIMBOLO_0);this.AnimationTile.GetSprite().alpha=1;this.AnimationTile.Visible(true)}break;case ReelAnimationInfo.TYPE_PULSE_STATIC_BY_FRAME:{this.AnimationTile.SetNewTile(tab_ani[tab_index].m_ResourceID,tab_ani[tab_index].m_TotFrames,".webp");this.AnimationTile.SetFrame(tab_ani[tab_index].m_FrameTime);this.AnimationTile.GetSprite().alpha=1;this.AnimationTile.Visible(true)}break;case ReelAnimationInfo.TYPE_PULSE_STATIC_BY_TYPE:{this.AnimationTile.SetNewTile(tab_ani[tab_index].m_ResourceID,tab_ani[tab_index].m_TotFrames,".webp");this.AnimationTile.SetFrame(this.AnimationLine);this.AnimationTile.GetSprite().alpha=1;this.AnimationTile.CenterBox(window.LARGHEZZA_SIMBOLO,window.ALTEZZA_SIMBOLO,true);this.AnimationTile.Visible(true)}break;case ReelAnimationInfo.TYPE_PULSE_MEDIA_ALPHA_BLINK:{this.AnimationTile.SetNewTile(tab_ani[tab_index].m_ResourceID,tab_ani[tab_index].m_TotFrames,".webp");this.AnimationTile.SetFrame(this.IDSimbolo-window.ID_SIMBOLO_0);this.AnimationFrame=0;this.AnimationReloadTime=tab_ani[tab_index].m_FrameTime;this.AnimationTime=this.AnimationReloadTime;this.AnimationTile.GetSprite().alpha=.3;this.AnimationTile.Visible(true)}break;case ReelAnimationInfo.TYPE_PULSE_MEDIA_TILE:{this.AnimationTile.SetNewTile(tab_ani[tab_index].m_ResourceID,tab_ani[tab_index].m_TotFrames,".webp");this.AnimationFrame=0;this.AnimationReloadTime=tab_ani[tab_index].m_FrameTime;this.AnimationTime=this.AnimationReloadTime;this.AnimationTile.CenterBox(window.LARGHEZZA_SIMBOLO,window.ALTEZZA_SIMBOLO,true);this.AnimationTile.Visible(true);this.AnimationTile.SetFrame(0)}break;default:break}if(tab_ani[tab_index].m_ActionsArray!=null)this.SetupActions(tab_ani[tab_index].m_ActionsArray)};ReelAnimation.prototype.SetupActions=function(actions){var act;for(var i=0;i<actions.length;i++){this.AnimationTile.SPRITE_TRANSFORMER().RunAction(actions[i].Action,actions[i].FloatParms,actions[i].UintParms)}};ReelAnimation.prototype.GetTabIndex=function(){return(this.IDSimbolo&255)-1};ReelAnimation.prototype.GetTabAni=function(){if((this.ID&ReelAnimation.TYPE_MASK_OVERLAY)!=0)return ReelAnimation.TAB_OVLY_PULSE_TYPE;if((this.ID&ReelAnimation.TYPE_MASK_UNDERLAY)!=0)return ReelAnimation.TAB_UNLY_PULSE_TYPE;return ReelAnimation.TAB_REEL_PULSE_TYPE};ReelMotion.BEHAVIOUR_STACK=1;ReelMotion.STACK_TIME=3;ReelMotion.BLUR_FRAMES_SIMBOLO=44;ReelMotion.BLUR_ALTEZZA_SIMBOLO=260;ReelMotion.BLUR_PIXEL_REEL_SIZE=ReelMotion.BLUR_FRAMES_SIMBOLO*ReelMotion.BLUR_ALTEZZA_SIMBOLO;ReelMotion.OFFS_START_FRAME_SYM_ORG=40;ReelMotion.OFFS_START_FRAME_SYM_ORG_BLUR=37;ReelMotion.BLUR_START_FRAME_MOTION=ReelMotion.OFFS_START_FRAME_SYM_ORG*ReelMotion.BLUR_ALTEZZA_SIMBOLO;ReelMotion.OFFS_START_FRAME_SYM_NEW=1;ReelMotion.OFFS_START_FRAME_SYM_NEW_BLUR=4;ReelMotion.OFFS_PAD_TOP_AREA_0=7;ReelMotion.OFFS_PAD_TOP_AREA_1=10;ReelMotion.OFFS_PAD_BOT_AREA_0=31;ReelMotion.OFFS_PAD_BOT_AREA_1=34;ReelMotion.TAB_DEFAULT_TILES=[1,1,1,1,1,1,1,1,6,7,2,4,3,7,1,1,1,1,2,2,2,2,3,3,3,4,4,4,5,5,5,1,6,7,2,4,3,1,1,1,1,1,1,1];ReelMotion.TAB_REEL_BOUNCE=[-64,16,16,8,8,4,4,4,2,2,2,2,2,2,-2,-2,-2,-2,-2,2];ReelMotion.REEL_SPEED=56;ReelMotion.TURBO_SPEED=86;function ReelMotion(id_reel,parent_container,parent_renderer){SObject.call(this);this.ParentStage=parent_container;this.ParentRender=parent_renderer;this.SimboliEstrattiRef=null;this.MagicSymbol=0;this.IDReel=id_reel;this.ReelSpeed=0;this.SpinStep=0;this.IdxTabBounce=0;this.LoadMotionOffset=0;this.LoadMotionDelay=0;this.LoadMotionDelayer=0;this.StackTimer=0;this.TabTiles=[];for(var i=0;i<ReelMotion.BLUR_FRAMES_SIMBOLO;i++){this.TabTiles.push(ReelMotion.TAB_DEFAULT_TILES[i])}this.PoolSymbols=[];this.SuperContainer=new PIXI.Container;this.StripContainer=new PIXI.Container;this.SuperContainer.addChild(this.StripContainer);this.DEBUG_LOG("Created motion for reel :"+this.IDReel)}ReelMotion.prototype=Object.create(SObject.prototype);ReelMotion.prototype.constructor=ReelMotion;ReelMotion.prototype.Init=function(p_pSimboliEstratti){this.SimboliEstrattiRef=p_pSimboliEstratti;for(var i=0;i<ReelMotion.BLUR_FRAMES_SIMBOLO;i++){this.PoolSymbols.push(new TiledSprite("SYMB",2*window.NUM_SIMBOLI,true,this.StripContainer,".webp"));this.PoolSymbols[i].Setup();this.PoolSymbols[i].YY(i*window.ALTEZZA_SIMBOLO,0)}this.ElaboraTiles();this.StripMask=new PIXI.Graphics;this.SuperContainer.addChild(this.StripMask);this.StripMask.position.x=0;this.StripMask.position.y=-10;const yOffset=10;this.StripMask.lineStyle(0);this.StripMask.clear();this.StripMask.beginFill(9160191);this.StripMask.drawRect(0,0,window.LARGHEZZA_SIMBOLO,window.ALTEZZA_SIMBOLO*window.NUM_SIMBOLI_RUOTA+yOffset);this.StripMask.endFill();this.SuperContainer.mask=this.StripMask;this.SuperContainer.visible=false;this.ParentStage.addChild(this.SuperContainer)};ReelMotion.prototype.ElaboraTiles=function(){for(var i=0;i<100;i++){var idx1=ReelMotion.OFFS_PAD_TOP_AREA_0+Lib.Rand(ReelMotion.OFFS_PAD_BOT_AREA_0-1);var idx2=ReelMotion.OFFS_PAD_TOP_AREA_0+Lib.Rand(ReelMotion.OFFS_PAD_BOT_AREA_0-1);var tmp=this.TabTiles[idx1];this.TabTiles[idx1]=this.TabTiles[idx2];this.TabTiles[idx2]=tmp}for(i=0;i<6;i++)this.TabTiles[ReelMotion.OFFS_PAD_BOT_AREA_0+i]=this.TabTiles[ReelMotion.OFFS_PAD_TOP_AREA_0+i];for(var i=0;i<ReelMotion.BLUR_FRAMES_SIMBOLO;i++){this.SetStripSymbol(this.TabTiles[i],i,true)}};ReelMotion.prototype.SpinInit=function(){for(var i=0;i<window.NUM_SIMBOLI_RUOTA;i++){this.SetStripSymbol(this.SimboliEstrattiRef[this.IDReel+window.NUM_REELS*i],ReelMotion.OFFS_START_FRAME_SYM_ORG+i,false)}for(var i=0;i<window.NUM_SIMBOLI_RUOTA;i++){this.SetStripSymbol(this.SimboliEstrattiRef[this.IDReel+window.NUM_REELS*i],ReelMotion.OFFS_START_FRAME_SYM_ORG_BLUR+i,true)}var rnd=window.ID_SIMBOLO_0+Lib.Rand(6);this.SetStripSymbol(rnd,ReelMotion.OFFS_START_FRAME_SYM_ORG+window.NUM_SIMBOLI_RUOTA,false);this.SetScrollRect(ReelMotion.BLUR_START_FRAME_MOTION);this.SpinStep=0;this.ReelSpeed=ReelMotion.REEL_SPEED;this.IdxTabBounce=0;this.LoadMotionOffset=0;this.LoadMotionDelayer=1;this.LoadMotionDelay=0;this.StripContainer.visible=true;this.SuperContainer.visible=true;this.StackTimer=4*ReelMotion.BLUR_ALTEZZA_SIMBOLO};ReelMotion.prototype.SetStripSymbol=function(sym_ID,strip_index,blur){var sym_FRM;blur_FRM=parseInt(sym_ID-window.ID_SIMBOLO_0);sym_FRM=blur_FRM+(window.NUM_SIMBOLI+1);if(this.MagicSymbol!=0&&sym_ID==this.MagicSymbol){this.PoolSymbols[strip_index].ChangeFrame(sym_FRM,"SYMBMGC");this.PoolSymbols[strip_index].ChangeFrame(blur_FRM,"SYMBMGC")}else{this.PoolSymbols[strip_index].ChangeFrame(sym_FRM,"SYMB");this.PoolSymbols[strip_index].ChangeFrame(blur_FRM,"SYMB")}if(blur==true)sym_FRM=blur_FRM;this.PoolSymbols[strip_index].SetFrame(sym_FRM)};ReelMotion.prototype.SpinOver=function(){var offs=0;for(var i=0;i<window.NUM_SIMBOLI_RUOTA;i++){sym_ID=this.SimboliEstrattiRef[this.IDReel+window.NUM_REELS*i];this.SetStripSymbol(sym_ID,ReelMotion.OFFS_START_FRAME_SYM_NEW+i,false)}for(var i=0;i<window.NUM_SIMBOLI_RUOTA;i++){sym_ID=this.SimboliEstrattiRef[this.IDReel+window.NUM_REELS*i];this.SetStripSymbol(sym_ID,ReelMotion.OFFS_START_FRAME_SYM_NEW_BLUR+i,true)}offs=330;this.SetScrollRect(ReelMotion.OFFS_START_FRAME_SYM_NEW_BLUR*ReelMotion.BLUR_ALTEZZA_SIMBOLO+offs);this.StripContainer.visible=true;this.SpinStep=2};ReelMotion.prototype.StackSet=function(step){var rnd_sym,cur_pos;if(ReelMotion.BEHAVIOUR_STACK==1){if(this.StackTimer>=step)this.StackTimer-=step;else this.StackTimer=0;if(this.StackTimer==0){rnd_sym=window.ID_SIMBOLO_0+Lib.Rand(window.NUM_SIMBOLI-4);cur_pos=parseInt(this.StripContainer.y/window.BLUR_ALTEZZA_SIMBOLO);for(var i=ReelMotion.OFFS_PAD_TOP_AREA_0;i<ReelMotion.OFFS_START_FRAME_SYM_ORG_BLUR;i++){if(i!=cur_pos&&i!=cur_pos+1&&i!=cur_pos+2)this.SetStripSymbol(rnd_sym,i,true)}this.StackTimer=ReelMotion.STACK_TIME*ReelMotion.BLUR_ALTEZZA_SIMBOLO}}};ReelMotion.prototype.SetScrollRect=function(pos){this.StripContainer.y=-pos};ReelMotion.prototype.IncScrollRect=function(offs){this.StripContainer.y-=offs};ReelMotion.prototype.DecScrollRect=function(offs){this.StripContainer.y+=offs};ReelMotion.prototype.Spin=function(){var blur_frame;switch(this.SpinStep){case 0:{if(this.LoadMotionDelay==0){this.LoadMotionOffset+=2;if(this.LoadMotionOffset>=15){this.SetScrollRect(ReelMotion.OFFS_START_FRAME_SYM_ORG_BLUR*ReelMotion.BLUR_ALTEZZA_SIMBOLO);this.StripContainer.visible=true;this.SpinStep++}else{this.IncScrollRect(this.LoadMotionOffset)}this.LoadMotionDelay=this.LoadMotionDelayer}else this.LoadMotionDelay--}break;case 1:{this.StackSet(ReelMotion.REEL_SPEED);this.DecScrollRect(this.ReelSpeed);if(Math.abs(this.StripContainer.y)<ReelMotion.OFFS_PAD_TOP_AREA_1*window.ALTEZZA_SIMBOLO){this.DecScrollRect(ReelMotion.OFFS_PAD_TOP_AREA_0*window.ALTEZZA_SIMBOLO);this.IncScrollRect(ReelMotion.OFFS_PAD_BOT_AREA_0*window.ALTEZZA_SIMBOLO)}}break;case 2:{this.DecScrollRect(this.ReelSpeed);if(Math.abs(this.StripContainer.y)<=ReelMotion.OFFS_START_FRAME_SYM_NEW_BLUR*ReelMotion.BLUR_ALTEZZA_SIMBOLO){this.SetScrollRect(ReelMotion.OFFS_START_FRAME_SYM_NEW*ReelMotion.BLUR_ALTEZZA_SIMBOLO);this.SpinStep++}}break;case 3:{this.IncScrollRect(ReelMotion.TAB_REEL_BOUNCE[this.IdxTabBounce]);this.IdxTabBounce++;if(this.IdxTabBounce>=ReelMotion.TAB_REEL_BOUNCE.length){this.SuperContainer.visible=false;this.SpinStep++;break}}break;default:break}};ReelMotion.prototype.IsSpinOver=function(){return this.SpinStep>3};ReelMotion.prototype.IsStopPostion=function(){return this.SpinStep==3};ReelMotion.prototype.Turbo=function(){this.ReelSpeed=ReelMotion.TURBO_SPEED};ReelMotion.prototype.SetMagicSymbol=function(id_sym,enb){this.MagicSymbol=id_sym;if(enb==false){this.MagicSymbol=0}else{this.MagicSymbol=id_sym}this.ElaboraTiles()};Reel.REELS_TAB_SYMS_RESET=[1,2,3,4,5,6,7,1,2,3,4,5,6,7,1];Reel.FSM_RUOTA_0=0;Reel.FSM_RUOTA_0B=1;Reel.FSM_RUOTA_1=2;Reel.FSM_RUOTA_2=3;Reel.FSM_RUOTA_3=4;Reel.FSM_RUOTA_4=5;Reel.FSM_RUOTA_5=6;Reel.REELS_TAB_SCATTER_SOUND=[SoundGenerator.SCATTER_1,SoundGenerator.SCATTER_2,SoundGenerator.SCATTER_3,SoundGenerator.SCATTER_3,SoundGenerator.SCATTER_3];Reel.REELS_TAB_TURBO_SOUND=[0,0,0,0,0];var Reels_MotionStatus=Array(window.NUM_REELS);var Reel_BloccoSimultaneo=0;var Reel_ProgScatter=0;var Reel_TurboSprite=null;var Reel_LockTurbo=0;var Reel_StageType=0;function Reel(id_reel,app_reference,parent_container,parent_renderer){SObject.call(this);this.ApplicationRef=app_reference;this.ParentStage=parent_container;this.ParentRender=parent_renderer;this.ReelContainer=new PIXI.Container;this.AnimationContainer=new PIXI.Container;this.AnimationContainer.visible=false;this.IDReel=id_reel;this.SymbolSprite=new TiledSprite("SYM",window.NUM_SIMBOLI,true,this.ReelContainer,".webp");this.DEBUG_LOG("Created symbol sprite for reel "+this.IDReel+"length "+window.NUM_SIMBOLI);this.Motion=null;this.IDSimbolo=Slot.ID_SIMBOLO_0;this.SimboliEstrattiRef=null;this.SampleBrakeFired=false;this.LoadedTurbo=false;this.NotifyTurbo=false;this.Animation=new ReelAnimation(this.IDReel,this.AnimationContainer,this.ApplicationRef);if(this.HaveMotion()==true){this.Motion=new ReelMotion(this.IDReel,this.ReelContainer,this.ParentRender);if(Reel_TurboSprite==null){Reel_TurboSprite=new TiledSprite("ReelTurbo_",10,true,null,".webp");Reel_TurboSprite.Setup()}}this.OverlaySprite=new TiledSprite("SymSpecial_",6,false,this.ReelContainer,".webp");this.StepFSM=Reel.FSM_RUOTA_0B}Reel.prototype=Object.create(SObject.prototype);Reel.prototype.constructor=Reel;Reel.prototype.SetupCoords=function(){var xx,yy;xx=window.REELS_TAB_X[parseInt(this.IDReel%window.NUM_REELS)];yy=window.REELS_TAB_Y[parseInt(this.IDReel/window.NUM_REELS)];this.ReelContainer.x=xx;this.ReelContainer.y=yy};Reel.prototype.Visible=function(vsb){this.ReelContainer.visible=vsb};Reel.prototype.HaveMotion=function(){if(this.IDReel<window.NUM_REELS)return true;return false};Reel.prototype.Init=function(p_pSimboliEstratti){this.SimboliEstrattiRef=p_pSimboliEstratti;this.SimboliEstrattiRef[this.IDReel]=Reel.REELS_TAB_SYMS_RESET[this.IDReel];this.SymbolSprite.Setup();if(this.OverlaySprite!=null)this.OverlaySprite.Setup();this.SetSymbol(Reel.REELS_TAB_SYMS_RESET[this.IDReel]);this.AttualizzaSimbolo();this.SetupCoords();if(this.HaveMotion()==true){this.Motion.Init(p_pSimboliEstratti)}this.Animation.Init();this.ReelContainer.addChild(this.AnimationContainer);this.ParentStage.addChild(this.ReelContainer)};Reel.prototype.Spin_Start=function(){Reel_BloccoSimultaneo=0;this.StepFSM=Reel.FSM_RUOTA_2};Reel.prototype.AnimationContainer_Setup=function(){this.ReelContainer.removeChild(this.AnimationContainer);this.ApplicationRef.SLOT().CONTAINER().addChild(this.AnimationContainer);this.AnimationContainer.x=this.ReelContainer.x;this.AnimationContainer.y=this.ReelContainer.y;this.AnimationContainer.visible=true};Reel.prototype.Animate_Start=function(ani_line,ani_type){var main_sym,ani_line;this.Mistery_Off();if(this.ReelContainer.visible==false)return;if(this.ReelContainer.children.indexOf(this.AnimationContainer)!==-1){this.SymbolOff();this.AnimationContainer_Setup();if(ani_line<window.NUM_LINEE){if(this.IDSimbolo==window.ID_SIMBOLO_JOLLY)main_sym=this.IDSimbolo;else{main_win=this.ApplicationRef.SLOT().SLOT_COMBO().DirettriciVincenti[ani_line];main_sym=this.ApplicationRef.SLOT().SLOT_COMBO().GetSimboloCombinazione(main_win)}}else{main_sym=this.IDSimbolo;ani_line=0}if(this.ApplicationRef.SLOT().SLOT_WILD().IsSymbolOverlapped(this.IDReel)==true){this.AnimationContainer.alpha=.2}else{this.AnimationContainer.alpha=1}this.Animation.AnimateInit(main_sym,ani_line,ani_type);this.StepFSM=Reel.FSM_RUOTA_1}};Reel.prototype.Animate_Stop=function(){if(this.ApplicationRef.SLOT().CONTAINER().children.indexOf(this.AnimationContainer)!==-1){this.ReelIn();this.ApplicationRef.SLOT().CONTAINER().removeChild(this.AnimationContainer);this.ReelContainer.addChild(this.AnimationContainer);this.AnimationContainer.visible=false;this.AnimationContainer.x=0;this.AnimationContainer.y=0;this.Animation.AnimateOver()}this.SymbolOn()};Reel.prototype.Stop=function(){if(this.StepFSM==Reel.FSM_RUOTA_3){this.StepFSM=Reel.FSM_RUOTA_4}else if(this.StepFSM==Reel.FSM_RUOTA_1){this.Animate_Stop();this.StepFSM=Reel.FSM_RUOTA_0}else if(this.StepFSM==Reel.FSM_RUOTA_0B){this.StepFSM=Reel.FSM_RUOTA_0}else if(this.StepFSM>Reel.FSM_RUOTA_5){this.StepFSM=Reel.FSM_RUOTA_0B}};Reel.prototype.Paint=function(ellapsed_ms){var sym_vsb=false;switch(this.StepFSM){case Reel.FSM_RUOTA_0:{this.AttualizzaSimbolo();this.StepFSM=Reel.FSM_RUOTA_0B}break;case Reel.FSM_RUOTA_0B:{}break;case Reel.FSM_RUOTA_1:{this.Animation.Animate(ellapsed_ms)}break;case Reel.FSM_RUOTA_2:{this.SpinInit();this.StepFSM=Reel.FSM_RUOTA_3}break;case Reel.FSM_RUOTA_3:{this.Spin()}break;case Reel.FSM_RUOTA_4:{this.AttualizzaSimbolo();if(this.HaveMotion()==true){this.Motion.SpinOver()}this.Spin();this.StepFSM=Reel.FSM_RUOTA_5}break;case Reel.FSM_RUOTA_5:{this.Spin();if(this.HaveMotion()==true){if(this.Motion.IsStopPostion()==true&&this.SampleBrakeFired==false){if(Reel_BloccoSimultaneo==255){Reel_BloccoSimultaneo=254;this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.STOP_ALL_REELS,SoundGenerator.SMP_VOLUME_REDUCE)}else if(Reel_BloccoSimultaneo==0){this.PlaySampleBrake()}this.SampleBrakeFired=true}if(this.Motion.IsSpinOver()==true){Reels_MotionStatus[this.IDReel]=0;this.SymbolOn();this.StopTurbo();sym_vsb=true;this.StepFSM++}}else if(Reels_MotionStatus[parseInt(this.IDReel%window.NUM_REELS)]==0){this.SymbolOn();sym_vsb=true;this.StepFSM++}if(sym_vsb==true){if(this.IDSimbolo==window.ID_SIMBOLO_SCATTER&&this.ScatterAttention()==true){this.Mistery_On(true)}if(parseInt(this.IDReel/window.NUM_REELS)==window.NUM_SIMBOLI_RUOTA-1){this.CheckProgressScatter()}}}break;default:break}if(this.OverlaySprite!=null)this.OverlaySprite.Refresh(ellapsed_ms);if(Reel_TurboSprite!=null)Reel_TurboSprite.Refresh(ellapsed_ms);this.SymbolSprite.Refresh(ellapsed_ms)};Reel.prototype.CheckProgressScatter=function(){if(Reel_ProgScatter!=255){
if(this.SimboliEstrattiRef[this.IDReel]==window.ID_SIMBOLO_SCATTER||this.SimboliEstrattiRef[this.IDReel-1*window.NUM_REELS]==window.ID_SIMBOLO_SCATTER||this.SimboliEstrattiRef[this.IDReel-2*window.NUM_REELS]==window.ID_SIMBOLO_SCATTER){Reel_ProgScatter++}}};Reel.prototype.ScatterAttention=function(){var id_reel,reels;if(this.ApplicationRef.SLOT().FREESPIN_IsStarted()==false&&Reel_ProgScatter!=255&&Reel_ProgScatter<Reel.REELS_TAB_SCATTER_SOUND.length){id_reel=this.IDReel%window.NUM_REELS;reels=window.NUM_REELS-id_reel;if(Reel_ProgScatter+reels>=3)return true}return false};Reel.prototype.AttualizzaSimbolo=function(){this.SymbolSprite.SetFrame(this.IDSimbolo-window.ID_SIMBOLO_0)};Reel.prototype.SetSymbol=function(id_sym){this.IDSimbolo=id_sym};Reel.prototype.SpinInit=function(){if(this.ApplicationRef.SLOT().FREESPIN_IsStarted()==true)Reel_ProgScatter=255;else Reel_ProgScatter=0;Reel_LockTurbo=window.NUM_REELS;this.LoadedTurbo=false;this.NotifyTurbo=false;this.SymbolOff();this.SampleBrakeFired=false;if(this.HaveMotion()==true){Reels_MotionStatus[this.IDReel]=1;this.Motion.SpinInit()}};Reel.prototype.Spin=function(){if(this.HaveMotion()==true){this.Motion.Spin();this.CheckTurbo()}};Reel.prototype.CheckTurbo=function(){if(Reel_BloccoSimultaneo==0&&Reel_ProgScatter>=2){if(this.IsInBrake()==false&&this.ApplicationRef.SLOT().FREESPIN_IsStarted()==false&&Reel_LockTurbo==window.NUM_REELS){this.Motion.Turbo();Reel_TurboSprite.StopUnlink();Reel_TurboSprite.SPRITE_TRANSFORMER().AnimateAbs(0,Reel_TurboSprite.TotFrames-1,SpriteTransformer.ANIMATION_LOOP,400);Reel_TurboSprite.LinkTo(this.ApplicationRef.SLOT().CONTAINER());Reel_TurboSprite.XX(this.ReelContainer.x,-50);Reel_TurboSprite.YY(this.ReelContainer.y,-25);Reel_TurboSprite.SCALE_X(1.3);Reel_TurboSprite.SCALE_Y(1.07);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(Reel.REELS_TAB_TURBO_SOUND[this.IDReel],SoundGenerator.SMP_VOLUME_NORMAL);if(Reel_ProgScatter>=2&&this.IDReel!=window.NUM_REELS)this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.TURBO_BGND,SoundGenerator.SMP_VOLUME_AMPLIFY);Reel_LockTurbo=this.IDReel;this.NotifyTurbo=true;this.LoadedTurbo=true}}};Reel.prototype.StopTurbo=function(){if(Reel_TurboSprite.IsChildOf(this.ApplicationRef.SLOT().CONTAINER())==true){Reel_TurboSprite.StopUnlink();if(this.IDReel==window.NUM_REELS-1)this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.SCATTER_3);Reel_LockTurbo=window.NUM_REELS;this.LoadedTurbo=false}};Reel.prototype.TurboLoaded=function(){if(this.NotifyTurbo==true){this.NotifyTurbo=false;return true}return false};Reel.prototype.Brake_ACK=function(){return true};Reel.prototype.IsStill=function(){return this.StepFSM==Reel.FSM_RUOTA_0B||this.StepFSM>Reel.FSM_RUOTA_5};Reel.prototype.IsInBrake=function(){return this.StepFSM==Reel.FSM_RUOTA_4||this.StepFSM==Reel.FSM_RUOTA_5};Reel.prototype.IsMoving=function(){return this.StepFSM==Reel.FSM_RUOTA_3||IsInBrake()==true};Reel.prototype.IsLoadingSpin=function(){return this.StepFSM==Reel.FSM_RUOTA_2};Reel.prototype.IsSpinning=function(){return this.StepFSM==Reel.FSM_RUOTA_3};Reel.prototype.IsAnimating=function(){return this.StepFSM==Reel.FSM_RUOTA_1};Reel.prototype.FadeOut=function(transition){if(this.SymbolSprite.IsVisible()==true){if(transition==true)this.SymbolSprite.SPRITE_TRANSFORMER().FadeAbs(.2,10,10);else this.SymbolSprite.Sprite.alpha=.2}else if(this.OverlaySprite!=null){if(transition==true)this.OverlaySprite.SPRITE_TRANSFORMER().FadeAbs(.2,10,10);else this.OverlaySprite.Sprite.alpha=.2}};Reel.prototype.FadeIn=function(transition){if(this.SymbolSprite.IsVisible()==true){this.SymbolSprite.SetMaskFilter(TiledSprite.MASK_STAT_NONE);if(transition==true)this.SymbolSprite.SPRITE_TRANSFORMER().FadeAbs(1,3,10);else this.SymbolSprite.Sprite.alpha=1}else if(this.OverlaySprite!=null){if(transition==true)this.OverlaySprite.SPRITE_TRANSFORMER().FadeAbs(1,3,10);else this.OverlaySprite.Sprite.alpha=1}};Reel.prototype.TurnOff=function(){if(this.SymbolSprite.IsVisible()==true){this.SymbolSprite.SetMaskFilter(TiledSprite.MASK_STAT_GRAY)}else if(this.OverlaySprite!=null){this.OverlaySprite.SetMaskFilter(TiledSprite.MASK_STAT_GRAY)}};Reel.prototype.TurnOn=function(){if(this.SymbolSprite.IsVisible()==true){this.SymbolSprite.SetMaskFilter(TiledSprite.MASK_STAT_NONE)}else if(this.OverlaySprite!=null){this.OverlaySprite.SetMaskFilter(TiledSprite.MASK_STAT_NONE)}};Reel.prototype.WatchMe=function(){this.Stop();this.Paint();if(this.SymbolSprite.IsVisible()==true)this.SymbolSprite.SPRITE_TRANSFORMER().ScaleAndBack(1.1,5,10,SpriteTransformer.MASK_BACK_TO_ORG);else if(this.OverlaySprite!=null)this.OverlaySprite.SPRITE_TRANSFORMER().ScaleAndBack(1.1,5,10,SpriteTransformer.MASK_BACK_TO_ORG)};Reel.prototype.IsSymbolSpecial=function(){var sym_special=0;if(this.IDSimbolo==window.ID_SIMBOLO_8)sym_special=1;else if(this.IDSimbolo==window.ID_SIMBOLO_9)sym_special=2;else if(this.IDSimbolo==window.ID_SIMBOLO_11)sym_special=3;else if(this.IDSimbolo==window.ID_SIMBOLO_12)sym_special=4;else if(this.IDSimbolo==window.ID_SIMBOLO_13)sym_special=5;else if(this.IDSimbolo==window.ID_SIMBOLO_14)sym_special=6;return sym_special};Reel.prototype.SymbolOn=function(){this.SymbolSprite.StopTransform();if(this.IsSymbolSpecial()!=0){this.Mistery_On(false);this.SymbolSprite.ResetProperties(false,1,1)}else{this.SymbolSprite.ResetProperties(true,1,1)}this.SetupCoords()};Reel.prototype.SymbolOff=function(){this.SymbolSprite.StopTransform();this.SymbolSprite.ResetProperties(false,1,1);this.SetupCoords();if(this.OverlaySprite!=null){this.OverlaySprite.StopTransform();this.OverlaySprite.ResetProperties(false,1,1)}};Reel.prototype.Mistery_On=function(pimp){var frm_spc=0;frm_spc=this.IsSymbolSpecial();if(this.OverlaySprite!=null&&frm_spc!=0){this.OverlaySprite.StopUnlink();this.OverlaySprite.LinkToParent();this.OverlaySprite.ResetProperties(true,1,1);this.OverlaySprite.SetFrame(frm_spc-1);this.OverlaySprite.XX(0,0);this.OverlaySprite.YY(0,0);if(pimp==true){this.OverlaySprite.SPRITE_TRANSFORMER().ScaleLoop(1,1.1,5,30,0);this.OverlaySprite.SPRITE_TRANSFORMER().LightAndBack(10,5,0)}this.SymbolSprite.Visible(false)}};Reel.prototype.Mistery_Off=function(){this.SymbolOn()};Reel.prototype.ReelOut=function(){};Reel.prototype.ReelIn=function(){};Reel.prototype.CONTAINER=function(){return this.ReelContainer};Reel.prototype.ANIMATION_CONTAINER=function(){return this.ReelContainer};Reel.prototype.GetXX=function(){return this.ReelContainer.x};Reel.prototype.GetYY=function(){return this.ReelContainer.y};Reel.prototype.PlaySampleBrake=function(){var samp=SoundGenerator.STOP_REEL;var flags=SoundGenerator.SMP_VOLUME_AMPLIFY;if(this.ScatterAttention()==true){if(this.SimboliEstrattiRef[this.IDReel]==window.ID_SIMBOLO_SCATTER||this.SimboliEstrattiRef[this.IDReel+window.NUM_REELS]==window.ID_SIMBOLO_SCATTER||this.SimboliEstrattiRef[this.IDReel+2*+window.NUM_REELS]==window.ID_SIMBOLO_SCATTER){samp=Reel.REELS_TAB_SCATTER_SOUND[Reel_ProgScatter];flags=SoundGenerator.SMP_VOLUME_AMPLIFY}}if(samp!=0){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(samp,flags)}return samp};Reel.prototype.StopSampleBrake=function(){var i;for(i=0;i<Reel.REELS_TAB_SCATTER_SOUND.length;i++)if(Reel.REELS_TAB_SCATTER_SOUND[i]!=0)this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(Reel.REELS_TAB_SCATTER_SOUND[i]);for(i=0;i<Reel.REELS_TAB_TURBO_SOUND.length;i++)if(Reel.REELS_TAB_TURBO_SOUND[i]!=0)this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(Reel.REELS_TAB_TURBO_SOUND[i]);this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.STOP_REEL)};Reel.prototype.GetCompletedLoops=function(){return this.Animation.GetCompletedLoops()};Reel.prototype.SetMagicSymbol=function(id_sym,enb){if(enb==false){this.SymbolSprite.ChangeFrame(id_sym-1,"SYM")}else{this.SymbolSprite.ChangeFrame(id_sym-1,"SYMMGC")}if(this.HaveMotion()==true)this.Motion.SetMagicSymbol(id_sym,enb)};LongWild.WILD_STAT_IDLE=0;LongWild.WILD_STAT_VALIDATE=1;LongWild.WILD_STAT_ARMATO=2;LongWild.WILD_STAT_INNESCATA=3;LongWild.WILD_ANIMATE_IDLE=255;LongWild.WILD_MAX_REELS=5;function LongWild(stage_container,app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.ParentStage=stage_container;this.Container=new PIXI.Container;this.SlotComboRef=null;this.SimboliEstrattiRef=null;this.WILD_Pivot=new Array(LongWild.WILD_MAX_REELS);this.WILD_Stato=0;this.WILD_AniACK=0;this.WILD_AniDelay=0;this.CreateSprites()}LongWild.prototype=Object.create(SObject.prototype);LongWild.prototype.constructor=LongWild;LongWild.prototype.Init=function(){var i;this.WILD_Pivot.fill(255);this.WILD_Stato=LongWild.WILD_STAT_IDLE;this.WILD_AniACK=0;this.SlotComboRef=this.ApplicationRef.SLOT().SLOT_COMBO();this.SimboliEstrattiRef=this.ApplicationRef.SLOT().SLOT_COMBO().SimboliEstratti;for(i=0;i<LongWild.WILD_MAX_REELS;i++){this.WILD_Sprites[i].Setup()}this.ParentStage.addChild(this.Container)};LongWild.prototype.NearPivot=function(pivot_index,nearest){var pos_pivot,pos;pos_pivot=this.SlotComboRef.GetPosizioneInRullo(this.WILD_Pivot[pivot_index]);pos=this.WILD_Pivot[pivot_index]+(nearest+1)*window.NUM_REELS;return pos};LongWild.prototype.FitReel=function(reel_index,pivot_index){var i,pivot,pivot_template;this.SlotComboRef.GetVettoreIndiciRullo(reel_index);pivot_template=this.SimboliEstrattiRef[this.SlotComboRef.VettoreIndiciRullo[0]];for(i=0;i<window.NUM_SIMBOLI_RUOTA;i++){if(this.SlotComboRef.IsHold(this.SlotComboRef.VettoreIndiciRullo[i])==true)break;else if(this.SlotComboRef.IsSimboloJolly(this.SimboliEstrattiRef[this.SlotComboRef.VettoreIndiciRullo[i]])==false)break}if(i>=window.NUM_SIMBOLI_RUOTA){this.WILD_Pivot[pivot_index]=this.SlotComboRef.VettoreIndiciRullo[0];return true}return false};LongWild.prototype.FakeReel=function(pivot_index){};LongWild.prototype.Elabora=function(){var reel_index,pivot_index,wild_cnt;this.WILD_Stato=LongWild.WILD_STAT_IDLE;this.WILD_Pivot.fill(255);if(this.ApplicationRef.SLOT().FREESPIN_IsRunning()==false){for(reel_index=0,wild_cnt=0;reel_index<window.NUM_REELS&&wild_cnt<LongWild.WILD_MAX_REELS;reel_index++){if(this.FitReel(reel_index,wild_cnt)==true){wild_cnt++;this.WILD_Stato=LongWild.WILD_STAT_ARMATO}}if(this.WILD_Stato==LongWild.WILD_STAT_ARMATO){for(pivot_index=0;pivot_index<LongWild.WILD_MAX_REELS;pivot_index++){if(this.ValidPivot(pivot_index)==true){this.FakeReel(pivot_index)}}}}};LongWild.prototype.SostituzioneSimboli=function(){if(this.WILD_Stato==LongWild.WILD_STAT_ARMATO){this.WILD_Stato=LongWild.WILD_STAT_INNESCATA}};LongWild.prototype.AniStart=function(){var i;for(i=0;i<LongWild.WILD_MAX_REELS;i++){if(this.ValidPivot(i)==true){pos=this.WILD_Pivot[i];this.WILD_Sprites[i].ResetProperties(true,1,1);this.WILD_Sprites[i].XX(this.ApplicationRef.SLOT().REEL(pos).GetXX(),0);this.WILD_Sprites[i].YY(this.ApplicationRef.SLOT().REEL(pos).GetYY(),0);this.WILD_Sprites[i].SPRITE_TRANSFORMER().AnimateAbs(0,this.WILD_Sprites[i].TotFrames-1,SpriteTransformer.MASK_NONE,50);this.SetReelVisible(i,false)}}this.WILD_AniACK=1;this.WILD_AniDelay=0;this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.LONG_WILD,SoundGenerator.SMP_VOLUME_NORMAL);this.WILD_Stato=LongWild.WILD_STAT_IDLE};LongWild.prototype.AniRun=function(){var i,wait;if(this.IntroRunning()==false)return;if(this.WILD_AniACK==1){wait=0;for(i=0;i<LongWild.WILD_MAX_REELS;i++){if(this.ValidPivot(i)==true){if(this.WILD_Sprites[i].TransformOver()==false){wait|=1}}}if(wait==0){for(i=0;i<LongWild.WILD_MAX_REELS;i++){if(this.ValidPivot(i)==true){this.WILD_Sprites[i].SPRITE_TRANSFORMER().AnimateAbs(16,this.WILD_Sprites[i].TotFrames-1,SpriteTransformer.ANIMATION_LOOP|5,70)}}this.WILD_AniACK=LongWild.WILD_ANIMATE_IDLE}}};LongWild.prototype.AniStop=function(){this.WILD_Pivot.fill(255);this.WILD_AniACK=0};LongWild.prototype.AniClear=function(){var i,j,pp,np;for(i=0;i<LongWild.WILD_MAX_REELS;i++){if(this.ValidPivot(i)==true){this.WILD_Sprites[i].StopTransform();this.WILD_Sprites[i].ResetProperties(false,1,1);pp=this.WILD_Pivot[i];for(j=0;j<window.NUM_SIMBOLI_RUOTA-1;j++){np=this.NearPivot(i,j)}this.SetReelVisible(i,true)}}this.AniStop()};LongWild.prototype.AniRefresh=function(ellapsed_time){var i;for(i=0;i<LongWild.WILD_MAX_REELS;i++){if(this.ValidPivot(i)==true){this.WILD_Sprites[i].Refresh(ellapsed_time)}}if(this.WILD_AniACK==LongWild.WILD_ANIMATE_IDLE){for(i=0;i<LongWild.WILD_MAX_REELS;i++){if(this.ValidPivot(i)==true&&this.WILD_Sprites[i].TransformOver()==true){this.WILD_Sprites[i].SPRITE_TRANSFORMER().LightLoop(2,30,20)}}}};LongWild.prototype.AniRunning=function(){if(this.WILD_AniACK!=0)return true;return false};LongWild.prototype.IntroRunning=function(){var i;for(i=0;i<LongWild.WILD_MAX_REELS;i++){if(this.ValidPivot(i)==true){if(this.WILD_AniACK!=0&&this.WILD_AniACK!=LongWild.WILD_ANIMATE_IDLE)return true}}return false};LongWild.prototype.ValidPivot=function(pivot_index){if(this.WILD_Pivot[pivot_index]!=255&&this.WILD_Pivot[pivot_index]>=window.NUM_RULLI){return false}if(this.WILD_Pivot[pivot_index]<window.NUM_RULLI)return true;return false};LongWild.prototype.IsSymbolOverlapped=function(pos_idx){var i,j;for(i=0;i<LongWild.WILD_MAX_REELS;i++){if(this.ValidPivot(i)==true){if(this.WILD_Pivot[i]==pos_idx)return true;for(j=0;j<window.NUM_SIMBOLI_RUOTA-1;j++)if(this.NearPivot(i,j)==pos_idx)return true}}return false};LongWild.prototype.get_STATO=function(){return this.WILD_Stato};LongWild.prototype.CreateSprites=function(){var i;this.WILD_Sprites=new Array(LongWild.WILD_MAX_REELS);for(i=0;i<LongWild.WILD_MAX_REELS;i++){this.WILD_Sprites[i]=new TiledSprite("LongWild",45,false,this.Container,".webp")}};LongWild.prototype.SetReelVisible=function(pivot_index,visible){for(let i=this.WILD_Pivot[pivot_index];i<window.NUM_RULLI;i+=window.NUM_REELS){const reel=this.ApplicationRef.SLOT().REEL_HOLDER().GetRullo(i);reel.Visible(visible)}};ReelHolder.REEL_STANDARD=0;ReelHolder.TIME_VISUALIZZA_DIRETTRICE=500;function ReelHolder(stage_container,stage_renderer,app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.ParentStage=stage_container;this.ParentRenderer=stage_renderer;this.Container=new PIXI.Container;this.SimboliEstrattiRef=null;this.PoolRulli=[];for(var i=0;i<window.NUM_RULLI;i++){this.PoolRulli.push(new Reel(i,app_reference,this.Container,stage_renderer))}this.DEBUG_LOG("*** CREATING REEL HOLDER FOR "+window.NUM_RULLI+" REELS ****");this.LinerRef=null;this.StepAnimazione=0;this.StepSpin=0;this.WinLine=0;this.OldWinLine=0;this.LoopAnimazione=0;this.ModeAnimazione=0;this.TimerSpinBreak=0;this.TimerSpinBrake=0;this.SET_Quick_Spins=0;this.SET_Turbo_Spins=0;this.SET_Auto_BreakAtWin=0;this.SET_Auto_BreakAtFeature=0}ReelHolder.prototype=Object.create(SObject.prototype);ReelHolder.prototype.constructor=ReelHolder;ReelHolder.prototype.SetSpecialReel=function(p_Id){var i=0;for(i=0;i<window.NUM_RULLI;i++){this.PoolRulli[i].Visible(true);this.PoolRulli[i].SetupCoords()}};ReelHolder.prototype.GetSpecialReel=function(p_Id){return 0};ReelHolder.prototype.Init=function(p_pSimboliEstratti){this.SimboliEstrattiRef=p_pSimboliEstratti;this.SlotComboRef=this.ApplicationRef.SLOT().SLOT_COMBO();for(var i=0;i<this.PoolRulli.length;i++){this.PoolRulli[i].Init(p_pSimboliEstratti)}this.LinerRef=this.ApplicationRef.SLOT().LINER();this.SetSpecialReel(ReelHolder.REEL_STANDARD);this.ParentStage.addChild(this.Container)};ReelHolder.prototype.Splash=function(){for(var i=0;i<this.PoolRulli.length;i++){this.PoolRulli[i].Stop();this.PoolRulli[i].Paint()}};ReelHolder.prototype.SpinInit=function(){for(var i=0;i<window.NUM_REELS;i++){this.PoolRulli[i].Spin_Start();this.PoolRulli[i+window.NUM_REELS].Spin_Start();this.PoolRulli[i+2*window.NUM_REELS].Spin_Start()}if(this.SET_Turbo_Spins==1){this.GPTimer=0;this.TimerSpinBrake=0;this.TimerSpinBreak=0}else if(this.SET_Quick_Spins==1){this.GPTimer=this.ArmaTimer(this.GPTimer,500);this.TimerSpinBrake=0;this.TimerSpinBreak=0}else{this.GPTimer=this.ArmaTimer(this.GPTimer,800);this.TimerSpinBrake=500;this.TimerSpinBreak=this.ArmaTimer(this.TimerSpinBreak,300)}this.StopAllState=0;this.ApplicationRef.CONSOLE().OnSpinEvent(true)};ReelHolder.prototype.SpinRun=function(stop_pressed,stop_enable){if(this.TimerSpinBreak==0){if(stop_pressed==true&&this.StopAllState==1&&Reel_BloccoSimultaneo==0){Reel_BloccoSimultaneo=255;this.ApplicationRef.CONSOLE().OnBrakePushed()}else if(this.StopAllState==0){if(this.ApplicationRef.SLOT().IsAutoPlay()==false&&this.ApplicationRef.SLOT().FREESPIN_IsRunning()==false&&stop_enable==true){this.ApplicationRef.CONSOLE().OnBrakeEnable();this.StopAllState=1}}}for(i=0;i<window.NUM_REELS;i++){if(this.PoolRulli[i].IsSpinning()==true&&this.PoolRulli[i].IsInBrake()==false){if(this.PoolRulli[i].TurboLoaded()==true){this.ApplicationRef.CONSOLE().OnBrakePushed();this.TimerSpinBrake=8*250;this.GPTimer=this.ArmaTimer(this.GPTimer,this.TimerSpinBrake);break}}}if(this.GPTimer==0){if(stop_enable==true){for(var i=0;i<window.NUM_REELS;i++){if(this.PoolRulli[i].IsSpinning()==true&&this.PoolRulli[i].IsInBrake()==false){if(this.PoolRulli[i].Brake_ACK()==true){this.PoolRulli[i].Stop();this.PoolRulli[i+window.NUM_REELS].Stop();this.PoolRulli[i+2*window.NUM_REELS].Stop();this.DEBUG_LOG("Stop for reel:"+i);this.GPTimer=this.ArmaTimer(this.GPTimer,this.TimerSpinBrake)}if(Reel_BloccoSimultaneo==0)break}}}}};ReelHolder.prototype.IsSpinOver=function(){var ovr=true;for(var i=0;i<window.NUM_RULLI;i++){if(this.PoolRulli[i].IsStill()==false){ovr=false;break}}if(ovr==true){for(var i=0;i<this.PoolRulli.length;i++){this.PoolRulli[i].Stop();this.PoolRulli[i].Mistery_Off()}this.ApplicationRef.CONSOLE().OnSpinEvent(false);this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.TURBO_BGND);return true}return false};ReelHolder.prototype.ChassisFix=function(){for(var i=0;i<window.NUM_RULLI;i++){this.PoolRulli[i].SetSymbol(this.SimboliEstrattiRef[i])}};ReelHolder.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);this.TimerSpinBreak=this.TimerDec(this.TimerSpinBreak,ellapsed_ms);for(var i=0;i<this.PoolRulli.length;i++){this.PoolRulli[i].Paint(ellapsed_ms)}};ReelHolder.prototype.ResetAnimazioneVincita=function(){this.WinLine=255;this.OldWinLine=255;this.LoopAnimazione=0};ReelHolder.prototype.InizializzaAnimazioneVincita=function(){this.ResetAnimazioneVincita();this.StepAnimazione=1};ReelHolder.prototype.GestioneAnimazioneVincita=function(){var i,time;switch(this.StepAnimazione){case 0:{}break;case 1:{for(i=0;i<window.NUM_RULLI;i++){this.PoolRulli[i].FadeOut(false)}this.StepAnimazione++}break;case 2:{if(this.LoopAnimazione!=0){this.ModeAnimazione=ReelAnimation.TYPE_ANIMATION_NORMAL}else{if(this.ApplicationRef.SLOT().IsAutoPlay()==true)this.ModeAnimazione=ReelAnimation.TYPE_ANIMATION_SNAPSHOT|500;else this.ModeAnimazione=ReelAnimation.TYPE_ANIMATION_NORMAL}this.AnimateLine();if(this.WinLine==window.NUM_LINEE){this.GPTimer=this.ArmaTimer(this.GPTimer,ReelHolder.TIME_VISUALIZZA_DIRETTRICE)}this.StepAnimazione++}break;case 3:{if(this.WinLine==window.NUM_LINEE){if(this.GPTimer==0){this.StepAnimazione=2}}else{if((this.ModeAnimazione&ReelAnimation.TYPE_ANIMATION_SNAPSHOT)!=0){if(this.AnimazioneVincitaReached(2)==true)this.StepAnimazione=2}else{if(this.AnimazioneVincitaReached(1)==true)this.StepAnimazione=2}}}break;default:break}};ReelHolder.prototype.TerminaAnimazioneVincita=function(){var i;for(i=0;i<window.NUM_RULLI;i++){this.PoolRulli[i].Stop();this.PoolRulli[i].FadeIn(false)}this.LinerRef.CancellaLinee();this.ResetAnimazioneVincita();this.StepAnimazione=0};ReelHolder.prototype.IsAnimazioneVincitaShort=function(){if(this.LoopAnimazione<1)return true;return false};ReelHolder.prototype.AnimazioneVincitaReached=function(num_loops){for(var i=0;i<window.NUM_RULLI;i++){if(this.PoolRulli[i].IsAnimating()==true)if(this.PoolRulli[i].GetCompletedLoops()<num_loops)break}if(i>=window.NUM_RULLI)return true;return false};ReelHolder.prototype.IsAnimazioneVincitaInterrompibile=function(){if(this.StepAnimazione==0)return true;if(this.SlotComboRef.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_FREESPIN|SlotCombo.MASK_WIN_BONUS_TOPLAY)!=0)if(this.ApplicationRef.SLOT().IsPlayingMusicaWin()==true)return false;if(this.ApplicationRef.SLOT().IsAutoPlay()==true){if(this.LoopAnimazione>=1)return true;return false}if(this.ApplicationRef.SLOT().FREESPIN().IsRunning()==true){if(this.LoopAnimazione>=1)return true;return false}if(this.SlotComboRef.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_FREESPIN|SlotCombo.MASK_WIN_BONUS_TOPLAY)!=0){if(this.LoopAnimazione>=1)return true;return false}return true};ReelHolder.prototype.AnimateLine=function(){var i,j,k;var scr=false;var wrap_around=false;var wrap=true;this.OldWinLine=this.WinLine;do{wrap_around=false;if(this.WinLine==255)this.WinLine=0;else{if(++this.WinLine>=window.NUM_LINEE+1){this.LoopAnimazione++;if(this.ApplicationRef.SLOT().FREESPIN_IsRunning()==true||this.SlotComboRef.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_FREESPIN|SlotCombo.MASK_WIN_BONUS_TOPLAY)!=0||this.ApplicationRef.SLOT().IsAutoPlay()==true)this.WinLine=window.NUM_LINEE;else if(this.SlotComboRef.GetNumDirettriciVincenti()==1)this.WinLine=window.NUM_LINEE;else this.WinLine=0}}for(i=this.WinLine;i<window.NUM_LINEE;i++){if(this.SlotComboRef.DirettriciVincenti[i]!=0){if(i!=this.OldWinLine){if(this.OldWinLine!=255)this.LinerRef.CancellaLinee();for(j=0;j<window.PATTERN_SIMBOLI;j++){if(this.PoolRulli[j].IsAnimating()==true){this.PoolRulli[j].Stop();this.PoolRulli[j].FadeOut(false)}}for(j=0;j<window.NUM_REELS;j++){if(this.SlotComboRef.SimboliVincenti[i][j]==1){if(this.PoolRulli[SlotCombo.TAB_LINES[i][j]].IsAnimating()==false){this.PoolRulli[SlotCombo.TAB_LINES[i][j]].Animate_Start(i,this.ModeAnimazione);this.PoolRulli[SlotCombo.TAB_LINES[i][j]].FadeIn(false)}}}this.LinerRef.VisualizzaLinea(i,this.SlotComboRef.DirettriciVincite[i]);this.WinLine=i;if(this.LoopAnimazione==0){const snd=this.ApplicationRef.SLOT().GetSampleMusicaWin();if(snd==SoundGenerator.WIN_BONUS){setTimeout(()=>{this.ApplicationRef.SOUNDGENERATOR().PlayBrano(snd,SoundGenerator.SMP_VOLUME_NORMAL)},1e3)}else{this.ApplicationRef.SOUNDGENERATOR().PlayBrano(snd,SoundGenerator.SMP_VOLUME_NORMAL)}}break}}}if(i==window.NUM_LINEE&&i!=this.OldWinLine){for(k=0;k<window.PATTERN_SIMBOLI;k++){if(this.SlotComboRef.PatternScattered[k]!=0){if(scr==false){this.LinerRef.CancellaLinee();for(j=0;j<window.PATTERN_SIMBOLI;j++){if(this.PoolRulli[j].IsAnimating()==true){this.PoolRulli[j].Stop();this.PoolRulli[j].FadeOut(false)}}scr=true}this.PoolRulli[k].Animate_Start(window.NUM_LINEE,ReelAnimation.TYPE_ANIMATION_NORMAL);this.PoolRulli[k].FadeIn(false);if(this.LoopAnimazione==0){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.WIN_SCATTER,SoundGenerator.SMP_VOLUME_AMPLIFY)}}}if(scr==false&&wrap==true){wrap=false;wrap_around=true;this.WinLine=window.NUM_LINEE}}}while(wrap_around==true)this.WinLine=i};ReelHolder.prototype.IsAnimazioneVincitaInCorso=function(){return this.StepAnimazione!=0};ReelHolder.prototype.RulloIn=function(id_rullo){this.PoolRulli[id_rullo].ReelIn()};ReelHolder.prototype.RulloOut=function(id_rullo){this.PoolRulli[id_rullo].ReelOut()};ReelHolder.prototype.GetRullo=function(id_rullo){return this.PoolRulli[id_rullo]};ReelHolder.prototype.CONTAINER=function(){return this.Container};ReelHolder.prototype.Visible=function(vsb){this.Container.visible=vsb};ReelHolder.prototype.SetMagicSymbol=function(id_sym,enb){var i;for(i=0;i<window.PATTERN_SIMBOLI;i++){this.PoolRulli[i].SetMagicSymbol(id_sym,enb)}};Congratulation.ORG_Y_PANEL=105;function Congratulation(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=this.ApplicationRef.MainStage;this.Container=new PIXI.Container;this.ParentContainer=null;this.BackGround=new PIXI.Graphics;this.BackGround.beginFill(0,.5);this.BackGround.drawRect(0,0,window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.BackGround.endFill();this.Rays=new TiledSprite("Rays",1,true,this.Container,".webp");this.Panel=new TiledSprite("WinUp",1,true,this.Container,".webp");this.PanelAniTime=0;this.TimerWait=0;this.DisplayWin=null;this.DisplayFooter=null;this.Step=0;this.Mounted=false;this.StopRequest=false;this.SnowEmitter=null;this.Container.visible=false}Congratulation.prototype=Object.create(SObject.prototype);Congratulation.prototype.constructor=Congratulation;Congratulation.prototype.Init=function(){var resources;var json_data;this.Container.addChild(this.BackGround);resources=this.ApplicationRef.TEXTURE_DB();json_data=resources["PRT_Snow"].data;this.SnowEmitter=new PIXI.particles.Emitter(this.Container,[PIXI.Texture.fromFrame("Star1.webp"),PIXI.Texture.fromFrame("Star2.webp"),PIXI.Texture.fromFrame("Star3.webp"),PIXI.Texture.fromFrame("Star4.webp")],json_data);this.SnowEmitter.emit=true;this.Rays.Setup();this.Panel.Setup();this.DisplayWin=new DisplayStyle(window.VIDEO_WIDTH,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:70,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.DisplayFooter=new DisplayStyle(window.VIDEO_WIDTH,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:32,fontStyle:"normal",fontWeight:"bold",fill:"white"}));this.DisplayWin.Init();this.DisplayFooter.Init()};Congratulation.prototype.Mount=function(background_animation_res,background_animation_frames,background_animation_time,background_offsY,win_string,win_YY,footer_string,footer_YY,parent_container,extension=".png"){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.GAME_LOOP);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CONGRATULATION,SoundGenerator.SMP_VOLUME_SUPER_AMPLIFY);this.Rays.GetSprite().anchor.set(.5);this.Panel.SetNewTileAt(background_animation_res,background_animation_frames,2,extension);this.PanelAniTime=background_animation_time;this.Rays.GetSprite().alpha=.5;this.Rays.GetSprite().x=window.VIDEO_WIDTH/2;this.Rays.GetSprite().y=window.VIDEO_HEIGHT/2;this.DisplayWin.SetCaption(win_string);this.DisplayWin.ResetProperties(false,1,1);this.DisplayWin.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.DisplayWin.YY(Congratulation.ORG_Y_PANEL,win_YY);this.DisplayWin.StopTransform();this.DisplayFooter.SetCaption(footer_string);this.DisplayFooter.ResetProperties(false,1,1);this.DisplayFooter.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.DisplayFooter.YY(Congratulation.ORG_Y_PANEL,footer_YY);this.DisplayFooter.StopTransform();this.Rays.Visible(false);this.Panel.ResetProperties(true,1,1);this.Panel.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT,true);this.Panel.Sprite.y+=background_offsY;this.Panel.SetFrame(0);if(background_animation_frames==1)this.Panel.SPRITE_TRANSFORMER().ScaleAbs(.5,.5,1,0,0);this.Mounted=true;this.StopRequest=false;this.ParentContainer=parent_container;this.ParentContainer.addChild(this.Container);this.Container.visible=true;this.Step=1};Congratulation.prototype.UnMount=function(){if(this.Mounted==true){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.CONGRATULATION);this.Step=0;this.ParentContainer.removeChild(this.Container);this.Container.visible=false;this.Mounted=false}};Congratulation.prototype.Refresh=function(ellapsed_time){SObject.prototype.TimerRefresh.call(this,ellapsed_time);this.TimerWait=this.TimerDec(this.TimerWait,ellapsed_time);switch(this.Step){case 0:{}break;case 1:{if(this.Panel.TransformOver()==true){if(this.Panel.TotFrames>1)this.Panel.SPRITE_TRANSFORMER().AnimateAbs(0,this.Panel.TotFrames-1,SpriteTransformer.ANIMATION_NONE,this.PanelAniTime);else this.Panel.SPRITE_TRANSFORMER().ScaleAbs(1,1,5,this.PanelAniTime);this.Step++}}break;case 2:{if(this.Panel.TransformOver()==true){this.DisplayWin.ResetProperties(true,1,1);this.DisplayFooter.ResetProperties(true,1,1);this.Rays.Visible(true);this.Panel.SetButton(true);this.TimerWait=this.ArmaTimer(this.TimerWait,5e3);this.Step++}}break;case 3:{if(this.Panel.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true||this.TimerWait==0){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.UnMount()}}break;default:break}if(this.Panel!=null){this.Panel.Refresh(ellapsed_time);this.DisplayWin.Refresh(ellapsed_time);this.DisplayFooter.Refresh(ellapsed_time);this.SnowEmitter.update(ellapsed_time*.001);this.Rays.GetSprite().rotation+=this.DeviceRotation(.005)}};Congratulation.prototype.IsMounted=function(){return this.Mounted};Congratulation.prototype.Exit=function(){if(this.Mounted==true)return false;return true};BonusDescriptor.ID_BONUS_FREESPIN=1;BonusDescriptor.BS_ACTION_FREESPIN_SPIN=1;BonusDescriptor.BS_ACTION_FREESPIN_PICK=2;BonusDescriptor.BS_OFFSET_FREESPIN_TIRO=2;BonusDescriptor.BS_OFFSET_FREESPIN_TIRI=3;BonusDescriptor.BS_OFFSET_FREESPIN_MULTY=4;BonusDescriptor.BS_OFFSET_FREESPIN_MAGIC=5;BonusDescriptor.BS_OFFSET_FREESPIN_WIN=6;BonusDescriptor.ID_BONUS_PICK=2;BonusDescriptor.BS_ACTION_BONUS_PICK=1;BonusDescriptor.BS_OFFSET_ID_BONUS=1;BonusDescriptor.BS_OFFSET_PICK_WIN=2;BonusDescriptor.BS_OFFSET_PICK_NUM=3;BonusDescriptor.BS_OFFSET_PICK_FLOOR=4;BonusDescriptor.BS_OFFSET_PICK_JP=5;BonusDescriptor.BS_OFFSET_PICK_STATUS=6;BonusDescriptor.BS_OFFSET_PICK_OBJECT=7;BonusDescriptor.BS_OFFSET_PICK_VALUE=8;BonusDescriptor.BONUS_PICK_DISABLED=0;BonusDescriptor.BONUS_PICK_ENABLED=1;BonusDescriptor.BONUS_PICK_OPENING_REAL=2;BonusDescriptor.BONUS_PICK_OPENING_FAKE=3;BonusDescriptor.BONUS_PICK_OPENED=4;BonusDescriptor.BONUS_PICK_OBJ_UNDEF=0;BonusDescriptor.BONUS_PICK_OBJ_DEATH=1;BonusDescriptor.BONUS_PICK_OBJ_LEVELUP=2;BonusDescriptor.BONUS_PICK_OBJ_PRIZE=3;BonusDescriptor.BONUS_PICK_OBJ_JP=4;BonusDescriptor.ID_BONUS_AFRICA=3;function BonusDescriptor(){SObject.call(this)}BonusDescriptor.prototype=Object.create(SObject.prototype);BonusDescriptor.prototype.constructor=BonusDescriptor;function FreeSpinCongratulation(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=this.ApplicationRef.MainStage;this.Container=new PIXI.Container;this.ParentContainer=null;this.BackGround=new TiledSprite("PanelFS",1,true,this.Container,".webp");this.DisplayTitle=new DisplayStyle(0,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:80,fontStyle:"normal",fontWeight:"bold",fill:["#ffffff","#f01000"],stroke:"#4a1850",strokeThickness:5,dropShadow:true,dropShadowColor:"#000000",dropShadowBlur:4,dropShadowAngle:Math.PI/6,dropShadowDistance:6}));this.DisplayText=new DisplayStyle(0,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:50,fontStyle:"normal",fontWeight:"bold",fill:["#A0A000","#FFFF00"],stroke:"#330033",strokeThickness:3,dropShadow:true,dropShadowColor:"#000000",dropShadowBlur:4,dropShadowAngle:Math.PI/6,dropShadowDistance:6}));this.DisplayWin=new DisplayStyle(0,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:80,fontStyle:"normal",fontWeight:"bold",fill:["#ffffff","#f01000"],stroke:"#4a1850",strokeThickness:5,dropShadow:true,dropShadowColor:"#000000",dropShadowBlur:4,dropShadowAngle:Math.PI/6,dropShadowDistance:6}));this.DisplayFooter=new DisplayStyle(0,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:50,fontStyle:"italic",fontWeight:"bold",fill:["#A0A000","#FFFF00"],stroke:"#330033",strokeThickness:3,dropShadow:true,dropShadowColor:"#000000",dropShadowBlur:4,dropShadowAngle:Math.PI/6,dropShadowDistance:6}));this.BackSprite=new TiledSprite("FX_Energy",1,true,this.Container,".webp");this.SymbolSprite=new TiledSprite("SYM",window.NUM_SIMBOLI,true,this.Container,".webp");this.Step=0;this.Mounted=false;this.StopRequest=false;this.Container.visible=false;this.Container.y=-40;this.MagicSymbol=0}FreeSpinCongratulation.prototype=Object.create(SObject.prototype);FreeSpinCongratulation.prototype.constructor=FreeSpinCongratulation;FreeSpinCongratulation.prototype.Init=function(){this.BackGround.Setup();this.BackGround.SetButton(true);this.DisplayTitle.Init();this.DisplayText.Init();this.DisplayWin.Init();this.DisplayFooter.Init();this.BackSprite.Setup();this.BackSprite.ResetProperties(true,1,.8);this.BackSprite.GetSprite().anchor.set(.5)
;this.BackSprite.GetSprite().x=window.VIDEO_WIDTH/2;this.BackSprite.GetSprite().y=window.VIDEO_HEIGHT/2;this.BackSprite.GetSprite().y+=60+30;this.SymbolSprite.Setup();this.DisplayTitle.Visible(true);this.DisplayText.Visible(true);this.DisplayWin.Visible(false);this.DisplayFooter.Visible(true)};FreeSpinCongratulation.prototype.Mount=function(title,caption,win_up,footer,magic_symbol,parent_container){this.MagicSymbol=magic_symbol;this.DisplayTitle.SetAreaWidth(window.VIDEO_WIDTH);this.DisplayTitle.YY(200,20);this.DisplayTitle.SetCaption(title);this.DisplayText.SetAreaWidth(window.VIDEO_WIDTH);this.DisplayText.YY(300,20);this.DisplayText.SetCaption(caption);this.DisplayWin.SetAreaWidth(window.VIDEO_WIDTH);this.DisplayWin.YY(400,20);this.DisplayWin.SetCaption(win_up);this.DisplayFooter.SetAreaWidth(window.VIDEO_WIDTH);this.DisplayFooter.YY(380,20);this.DisplayFooter.SetCaption(footer);this.SymbolSprite.ResetProperties(true,0,.1);this.SymbolSprite.CenterBox(window.VIDEO_WIDTH,window.VIDEO_HEIGHT,true);this.SymbolSprite.GetSprite().y+=60+30;this.Mounted=true;this.StopRequest=false;this.ParentContainer=parent_container;this.ParentContainer.addChild(this.Container);this.Container.visible=true;this.GPTimer=this.ArmaTimer(this.GPTimer,5*1e3);this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.GAME_LOOP);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.MAGIC_INTRO,SoundGenerator.SMP_VOLUME_AMPLIFY|SoundGenerator.SMP_LOOP);this.Step=1};FreeSpinCongratulation.prototype.UnMount=function(){if(this.Mounted==true){this.SymbolSprite.StopTransform();this.BackSprite.StopTransform();this.Step=0;this.ParentContainer.removeChild(this.Container);this.Container.visible=false;this.Mounted=false}};FreeSpinCongratulation.prototype.SymbolToFrame=function(id_sym){var frm;frm=id_sym-window.ID_SIMBOLO_0;return frm};FreeSpinCongratulation.prototype.Refresh=function(ellapsed_ms){var id_sym;this.TimerRefresh(ellapsed_ms);switch(this.Step){case 0:{}break;case 1:{if(this.SymbolSprite.TransformOver()==true){if(this.GPTimer==0){id_sym=this.MagicSymbol;this.StopRequest=true}else{do{id_sym=window.ID_SIMBOLO_0+Lib.Rand(9)}while(this.SymbolSprite.CurFrame==this.SymbolToFrame(id_sym))}this.SymbolSprite.SetFrame(this.SymbolToFrame(id_sym));this.Step++}}break;case 2:{this.SymbolSprite.SPRITE_TRANSFORMER().FadeAbs(1,20,10);this.SymbolSprite.SPRITE_TRANSFORMER().ScaleAbs(1,1,20,10,SpriteTransformer.MASK_NONE);this.Step++}break;case 3:{if(this.SymbolSprite.TransformOver()==true){if(this.StopRequest==true){this.SymbolSprite.SPRITE_TRANSFORMER().ScaleAbs(1.3,1.3,10,10,SpriteTransformer.MASK_NONE);this.SymbolSprite.SPRITE_TRANSFORMER().LightAndBack(10,10,10);this.GPTimer=this.ArmaTimer(this.GPTimer,2*1e3);this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.MAGIC_INTRO);this.Step++}else{this.SymbolSprite.SPRITE_TRANSFORMER().ScaleAbs(.1,.1,5,10,SpriteTransformer.MASK_NONE);this.Step=1}}}break;case 4:{if(this.SymbolSprite.TransformOver()==true){if(this.GPTimer==0||this.BackGround.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.UnMount()}}}break;default:break}this.BackSprite.GetSprite().rotation+=this.DeviceRotation(.03);this.BackSprite.Refresh(ellapsed_ms);this.SymbolSprite.Refresh(ellapsed_ms)};FreeSpinCongratulation.prototype.IsMounted=function(){return this.Mounted};FreeSpinCongratulation.prototype.Exit=function(){if(this.Mounted==true)return false;return true};FreeSpinPU.FREESPIN_STAT_IDLE=0;FreeSpinPU.FREESPIN_STAT_ARMED=1;FreeSpinPU.FREESPIN_STAT_RUNNING=2;FreeSpinPU.FREESPIN_STAT_OVER=3;FreeSpinPU.TAB_CAPTIONS=[["CLICK ON THE IMAGE TO CONTINUE","CLICCA SULL'IMMAGINE PER CONTINUARE"],["YOU WON ","HAI VINTO "]];function FreeSpinPU(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=this.ApplicationRef.MainStage;this.MainRenderer=this.ApplicationRef.Renderer;this.SlotReference=null;this.Container=new PIXI.Container;this.FREESPIN_Status=0;this.FREESPIN_Status_Req=0;this.FREESPIN_Tiro=0;this.FREESPIN_NumTiri=0;this.FREESPIN_Multiplier=1;this.FREESPIN_StepRefresh=0;this.FREESPIN_StepIntro=0;this.FREESPIN_VideoInfo_ACK=false;this.FREESPIN_VideoInfo_TotalWin=0}FreeSpinPU.prototype=Object.create(SObject.prototype);FreeSpinPU.prototype.constructor=FreeSpinPU;FreeSpinPU.prototype.Reset=function(){this.FREESPIN_Status=FreeSpinPU.FREESPIN_STAT_IDLE;this.FREESPIN_Status_Req=FreeSpinPU.FREESPIN_STAT_IDLE;this.FREESPIN_VideoInfo_ACK=false;this.FREESPIN_VideoInfo_TotalWin=0;this.FREESPIN_Tiro=0};FreeSpinPU.prototype.Init=function(){this.SlotReference=this.ApplicationRef.SLOT()};FreeSpinPU.prototype.GetStatus=function(){return this.FREESPIN_Status};FreeSpinPU.prototype.GetTiri=function(){return this.FREESPIN_NumTiri};FreeSpinPU.prototype.IsRunning=function(){return this.FREESPIN_Status==FreeSpinPU.FREESPIN_STAT_RUNNING};FreeSpinPU.prototype.IsStarted=function(){return this.FREESPIN_Tiro!=0&&this.FREESPIN_Status==FreeSpinPU.FREESPIN_STAT_RUNNING};FreeSpinPU.prototype.IsArmed=function(){return this.FREESPIN_Status_Req==FreeSpinPU.FREESPIN_STAT_ARMED};FreeSpinPU.prototype.VideoInfo_ACK=function(){return this.FREESPIN_VideoInfo_ACK};FreeSpinPU.prototype.VideoInfo_VALUE=function(){return this.FREESPIN_VideoInfo_TotalWin};FreeSpinPU.prototype.SpinStart=function(){this.UpdateTIMES();this.FREESPIN_StepRefresh=1;this.FREESPIN_VideoInfo_ACK=true};FreeSpinPU.prototype.SpinOver=function(){if(this.IsStarted()==true){this.FREESPIN_StepRefresh=0;if(this.FREESPIN_Tiro>=this.FREESPIN_NumTiri){this.FREESPIN_Status_Req=FreeSpinPU.FREESPIN_STAT_OVER}}};FreeSpinPU.prototype.Over=function(){this.Reset();this.StampaTeatro(false);this.Container.visible=false};FreeSpinPU.prototype.StampaTeatro=function(enable){if(enable==true)this.SlotReference.REEL_STAGE().SetType(SlotStage.TEATRO_FREESPIN);else this.SlotReference.REEL_STAGE().SetType(SlotStage.TEATRO_NORMAL)};FreeSpinPU.prototype.Parse_FREESPIN_ACTIVATE=function(nfs){this.FREESPIN_NumTiri=nfs;this.FREESPIN_Status_Req=FreeSpinPU.FREESPIN_STAT_ARMED};FreeSpinPU.prototype.Parse_FREESPIN_STATUS=function(chunk_to_parse){this.ParseServer_Init(chunk_to_parse);this.FREESPIN_Tiro=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_TIRO);this.FREESPIN_NumTiri=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_TIRI);this.FREESPIN_Multiplier=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_MULTY);this.FREESPIN_VideoInfo_TotalWin=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_WIN);if(this.FREESPIN_Tiro<this.FREESPIN_NumTiri){if(this.FREESPIN_Status_Req==FreeSpinPU.FREESPIN_STAT_IDLE)this.FREESPIN_Status_Req=FreeSpinPU.FREESPIN_STAT_ARMED}if(this.IsRunning()==true)this.UpdateTIMES();return true};FreeSpinPU.prototype.Refresh=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms)};FreeSpinPU.prototype.PlayMusic=function(){};FreeSpinPU.prototype.GetMultiplier=function(){return 1};FreeSpinPU.prototype.StopMusic=function(){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.FREESPIN_LOOP)};FreeSpinPU.prototype.UpdateTIMES=function(){};FreeSpinPU.prototype.IsIntroOver=function(){return true};FreeSpinPU.prototype.IsHold=function(index){return false};FreeSpinPU.prototype.IntroInit=function(){};FreeSpinPU.prototype.IntroRun=function(){};FreeSpinPU.prototype.ActionPending=function(){return this.FREESPIN_Status!=this.FREESPIN_Status_Req};FreeSpinPU.prototype.RunAction=function(){if((this.FREESPIN_Status==FreeSpinPU.FREESPIN_STAT_IDLE||this.FREESPIN_Status==FreeSpinPU.FREESPIN_STAT_OVER)&&this.FREESPIN_Status_Req==FreeSpinPU.FREESPIN_STAT_ARMED){this.IntroInit();this.Container.visible=true;this.FREESPIN_Status=FreeSpinPU.FREESPIN_STAT_ARMED;this.FREESPIN_Status_Req=FreeSpinPU.FREESPIN_STAT_RUNNING}else if(this.FREESPIN_Status==FreeSpinPU.FREESPIN_STAT_ARMED&&this.FREESPIN_Status_Req==FreeSpinPU.FREESPIN_STAT_RUNNING){this.IntroRun();if(this.IsIntroOver()==true){this.StampaTeatro(true);this.FREESPIN_Status=FreeSpinPU.FREESPIN_STAT_RUNNING}}else if(this.FREESPIN_Status==FreeSpinPU.FREESPIN_STAT_RUNNING&&this.FREESPIN_Status_Req==FreeSpinPU.FREESPIN_STAT_OVER){if(this.FREESPIN_StepRefresh!=2){this.StopMusic();this.SlotReference.CONGRATULATIONS().Mount("WinUp",1,50,-20,FreeSpinPU.TAB_CAPTIONS[1][window.LANG]+this.FREESPIN_VideoInfo_TotalWin.toString(),560,FreeSpinPU.TAB_CAPTIONS[0][window.LANG],680,this.ApplicationRef.CONTAINER(),".webp");this.FREESPIN_StepRefresh=2}else{if(this.SlotReference.CONGRATULATIONS().IsMounted()==false){this.Over()}}}};FreeSpinStage.TAB_CAPTIONS=[["CLICK ON THE IMAGE TO CONTINUE","CLICCA SULL'IMMAGINE PER CONTINUARE"],["CONGRATULATIONS!","CONGRATULAZIONI!"],["YOU WON ","HAI VINTO "],[" FREESPINS!"," FREESPINS!"],["WITH MAGIC SYMBOL:","CON SIMBOLO MAGICO:"],["MAGIC SYMBOL:","SIMBOLO MAGICO:"]];function FreeSpinStage(app_reference){FreeSpinPU.call(this,app_reference);this.InfoDisplay=null;this.MagicDisplay=null;this.IntroStep=0;this.MagicSymbol=window.ID_DUMMY;this.PlayMagicSymbols=0;this.SlotCombo_Ref=null;this.Congratulations=null;this.PoolExplo=[];for(var i=0;i<window.NUM_SIMBOLI_RUOTA;i++){this.PoolExplo.push(new TiledSprite("StarExplosion_",30,false,this.Container,".webp"))}this.SimboliEstrattiSnapshot=new Array(window.NUM_RULLI);this.MagicSymbol_BackSprite=new TiledSprite("FX_Energy",1,false,this.ApplicationRef.CONTAINER(),".webp");this.MagicSymbol_Sprite=new TiledSprite("SYMMGC",window.NUM_SIMBOLI,false,this.ApplicationRef.CONTAINER(),".webp")}FreeSpinStage.prototype=Object.create(FreeSpinPU.prototype);FreeSpinStage.prototype.constructor=FreeSpinStage;FreeSpinStage.prototype.Init=function(){FreeSpinPU.prototype.Init.call(this);if(this.InfoDisplay==null){this.InfoDisplay=new DisplayStyle(0,0,0,"left",this.ApplicationRef.CONSOLE().CONTAINER(),new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:48,fontStyle:"normal",fontWeight:"bold",fill:["#ff0f0f","#ca0f10"],stroke:"#980b0c",strokeThickness:5}))}if(this.MagicDisplay==null){this.MagicDisplay=new DisplayStyle(0,0,0,"center",this.ApplicationRef.CONSOLE().CONTAINER(),new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:36,fontStyle:"normal",fontWeight:"bold",fill:["#ffffff","#ffd05e"],stroke:"#4a1850",strokeThickness:5,dropShadow:true,dropShadowColor:"#000000",dropShadowBlur:4,dropShadowAngle:Math.PI/6,dropShadowDistance:6}))}this.InfoDisplay.Init();this.InfoDisplay.SetAreaWidth(window.VIDEO_WIDTH);this.InfoDisplay.YY(0,-900);this.InfoDisplay.XX(0,16);this.Congratulations=new FreeSpinCongratulation(this.ApplicationRef);this.Congratulations.Init();this.SlotCombo_Ref=this.ApplicationRef.SLOT().SLOT_COMBO();for(var i=0;i<this.PoolExplo.length;i++){this.PoolExplo[i].Setup()}this.MagicSymbol_BackSprite.Setup();this.MagicSymbol_Sprite.Setup();this.MagicDisplay.Init()};FreeSpinStage.prototype.Reset=function(){FreeSpinPU.prototype.Reset.call(this);this.PlayMagicSymbols=0};FreeSpinStage.prototype.PlayMusic=function(){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.GAME_LOOP);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.FREESPIN_LOOP,SoundGenerator.SMP_VOLUME_REDUCE|SoundGenerator.SMP_LOOP,true)};FreeSpinStage.prototype.UpdateTIMES=function(){var left;if(this.InfoDisplay.IsVisible()==false)this.InfoDisplay.Visible(true);left=this.FREESPIN_NumTiri-this.FREESPIN_Tiro;this.InfoDisplay.SetCaption(this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().ON_FREESPIN_MESSAGE()+left)};FreeSpinStage.prototype.Refresh=function(ellapsed_ms){var exit=false;var i;FreeSpinPU.prototype.Refresh.call(this,ellapsed_ms);if(this.Congratulations!=null)this.Congratulations.Refresh(ellapsed_ms);for(i=0;i<this.PoolExplo.length;i++)this.PoolExplo[i].Refresh(ellapsed_ms);this.MagicSymbol_BackSprite.Refresh();this.MagicSymbol_Sprite.Refresh()};FreeSpinStage.prototype.Over=function(){FreeSpinPU.prototype.Over.call(this);this.MagicDisplay.Visible(false);this.InfoDisplay.Visible(false);this.MagicSymbol_BackSprite.StopUnlink();this.MagicSymbol_Sprite.StopUnlink();this.ApplicationRef.SLOT().REEL_HOLDER().SetMagicSymbol(this.MagicSymbol,false)};FreeSpinStage.prototype.IsAtStart=function(){if(this.FREESPIN_Tiro==0)return true;return false};FreeSpinStage.prototype.IsIntroOver=function(){if(this.IntroStep>=20){this.IntroStep=0;return true}return false};FreeSpinStage.prototype.IntroInit=function(){this.MagicDisplay.Visible(false);this.MagicSymbol_BackSprite.StopUnlink();this.MagicSymbol_BackSprite.LinkTo(this.ApplicationRef.CONTAINER());this.MagicSymbol_BackSprite.ResetProperties(false,1,.3);this.MagicSymbol_Sprite.StopUnlink();this.MagicSymbol_Sprite.LinkTo(this.ApplicationRef.CONTAINER());this.MagicSymbol_Sprite.ResetProperties(false,1,.5);this.MagicSymbol_Sprite.XX(1760,0);this.MagicSymbol_Sprite.YY(10,0);this.MagicSymbol_BackSprite.CenterBoxOnSprite(this.MagicSymbol_Sprite);this.GPTimer=this.ArmaTimer(this.GPTimer,3*1e3);this.IntroStep=1};FreeSpinStage.prototype.IntroRun=function(){var k;switch(this.IntroStep){case 0:{}break;case 1:{for(k=0;k<window.PATTERN_SIMBOLI;k++){if(this.SlotReference.SLOT_COMBO().PatternScattered[k]!=0){if(this.SlotReference.REEL(k).GetCompletedLoops()>=1)break}}if(k<window.PATTERN_SIMBOLI||this.GPTimer==0){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.GAME_LOOP);this.Congratulations.Mount(FreeSpinStage.TAB_CAPTIONS[1][window.LANG],FreeSpinStage.TAB_CAPTIONS[2][window.LANG]+this.FREESPIN_NumTiri+FreeSpinStage.TAB_CAPTIONS[3][window.LANG],"",FreeSpinStage.TAB_CAPTIONS[4][window.LANG],this.MagicSymbol,this.ApplicationRef.CONTAINER());this.StampaTeatro(true);this.IntroStep=2}}break;case 2:{if(this.Congratulations.IsMounted()==false){this.MagicSymbol_BackSprite.StopUnlink();this.MagicSymbol_BackSprite.Visible(true);this.MagicSymbol_BackSprite.LinkTo(this.ApplicationRef.CONTAINER());this.MagicSymbol_BackSprite.SPRITE_TRANSFORMER().ScaleLoop(.3,.5,10,10,SpriteTransformer.MASK_BACK_TO_ORG);this.MagicSymbol_Sprite.StopUnlink();this.MagicSymbol_Sprite.Visible(true);k=this.MagicSymbol-window.ID_SIMBOLO_0;this.MagicSymbol_Sprite.SetFrame(k);this.MagicSymbol_Sprite.LinkTo(this.ApplicationRef.CONTAINER());this.MagicSymbol_Sprite.SPRITE_TRANSFORMER().LightLoop(2,50,30);this.MagicDisplay.Visible(true);this.MagicDisplay.SetCaption(FreeSpinStage.TAB_CAPTIONS[5][window.LANG]);this.MagicDisplay.XX(0,1330);this.MagicDisplay.YY(0,-890);this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.MAGIC_INTRO);this.ApplicationRef.SLOT().REEL_HOLDER().SetMagicSymbol(this.MagicSymbol,true);this.PlayMusic();this.IntroStep=20}}break;case 20:{}break;default:break}};FreeSpinStage.prototype.SpinOver=function(win){var started=this.IsStarted();FreeSpinPU.prototype.SpinOver.call(this)};FreeSpinStage.prototype.SimboliMagici_Init=function(){this.CurReelTransform=0;this.PlayMagicSymbols=1};FreeSpinStage.prototype.SimboliMagici_Play=function(){var running=true;var reel_transform=false;var i,k,idx;if(this.PlayMagicSymbols==0)return false;if(this.MagicSymbol==Slot.ID_SIMBOLO_SUPER)return false;switch(this.PlayMagicSymbols){case 1:{this.SlotCombo_Ref.ResetWinPattern();for(i=0;i<this.SimboliEstrattiSnapshot.length;i++)this.SimboliEstrattiSnapshot[i]=this.SlotCombo_Ref.SimboliEstratti[i];this.ApplicationRef.SLOT().REEL_HOLDER().TerminaAnimazioneVincita();this.ApplicationRef.GAMEPROXY().NOTIFY_PLAY_FREESPIN(BonusDescriptor.ID_BONUS_FREESPIN,BonusDescriptor.BS_ACTION_FREESPIN_PICK);this.PlayMagicSymbols=2}break;case 2:{if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){for(i=0;i<this.SlotCombo_Ref.DirettriciVincenti.length;i++){if(this.SlotCombo_Ref.DirettriciVincenti[i]!=0){if(this.SlotCombo_Ref.GetSimboloCombinazione(this.SlotCombo_Ref.DirettriciVincenti[i])==this.MagicSymbol)break}}if(i>=this.SlotCombo_Ref.DirettriciVincenti.length){running=false}else{reel_transform=false;for(i=this.CurReelTransform;i<window.NUM_REELS;i++){if(this.SlotCombo_Ref.GetOccorrenzaSimboloInRullo(this.MagicSymbol,i)!=0){this.SlotCombo_Ref.GetVettoreIndiciRullo(i);for(k=0;k<window.NUM_SIMBOLI_RUOTA;k++){idx=this.SlotCombo_Ref.VettoreIndiciRullo[k];if(this.SimboliEstrattiSnapshot[idx]!=this.MagicSymbol){reel_ref=this.ApplicationRef.SLOT().REEL(idx);this.PoolExplo[k].ResetProperties(true,1,1);this.PoolExplo[k].SetFrame(0);this.PoolExplo[k].XX(0,0);this.PoolExplo[k].YY(0,0);this.PoolExplo[k].StopUnlink();this.PoolExplo[k].LinkTo(reel_ref.CONTAINER());this.PoolExplo[k].SPRITE_TRANSFORMER().AnimateAbs(0,this.PoolExplo[k].TotFrames-1,SpriteTransformer.ANIMATION_NONE,20);this.PoolExplo[k].SPRITE_TRANSFORMER().ScaleAbs(1.5,1.5,5,20,0);reel_transform=true}}if(reel_transform==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.MAGIC_SYMBOL,SoundGenerator.SMP_VOLUME_NORMAL);break}}}this.CurReelTransform=i;this.TurnOffNormalSymbols();this.PlayMagicSymbols=3}}}break;case 3:{running=false;k=0;for(i=0;i<this.PoolExplo.length;i++){if(this.PoolExplo[i].TransformOver()==false){if(this.PoolExplo[i].CurFrame==15){k=this.CurReelTransform+i*window.NUM_REELS;reel_ref=this.ApplicationRef.SLOT().REEL(k);reel_ref.SetSymbol(this.MagicSymbol);reel_ref.SymbolOff();reel_ref.SymbolOn();reel_ref.Stop();reel_ref.Paint();if(k==0){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.MAGIC_SYMBOL);k=1}}running=true}}if(running==false){for(i=0;i<this.PoolExplo.length;i++){this.PoolExplo[i].StopUnlink()}this.CurReelTransform++;if(this.CurReelTransform<=window.NUM_REELS-1){this.PlayMagicSymbols=2;running=true}}}break;default:{running=false}break}return running};FreeSpinStage.prototype.TurnOffNormalSymbols=function(){var i;for(i=0;i<window.NUM_RULLI;i++){if(this.SlotCombo_Ref.SimboliEstratti[i]!=this.MagicSymbol){this.ApplicationRef.SLOT().REEL(i).TurnOff()}}};FreeSpinStage.prototype.IsMagicSymbol=function(sym_id){return this.MagicSymbol==sym_id};FreeSpinStage.prototype.Parse_FREESPIN_ACTIVATE=function(nfs,magic_sym){FreeSpinPU.prototype.Parse_FREESPIN_ACTIVATE.call(this,nfs);this.MagicSymbol=magic_sym};FreeSpinStage.prototype.Parse_FREESPIN_STATUS=function(chunk_to_parse){this.ParseServer_Init(chunk_to_parse);this.FREESPIN_Tiro=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_TIRO);this.FREESPIN_NumTiri=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_TIRI);this.FREESPIN_Multiplier=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_MULTY);this.MagicSymbol=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_MAGIC);this.FREESPIN_VideoInfo_TotalWin=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_FREESPIN_WIN);if(this.FREESPIN_Tiro<this.FREESPIN_NumTiri){if(this.FREESPIN_Status_Req==FreeSpinPU.FREESPIN_STAT_IDLE)this.FREESPIN_Status_Req=FreeSpinPU.FREESPIN_STAT_ARMED}if(this.IsRunning()==true)this.UpdateTIMES();return true};BonusStagePrize.STATE_DISABLED=0;BonusStagePrize.STATE_ENABLED=1;BonusStagePrize.STATE_CLICKED=2;BonusStagePrize.STATE_OPENING=3;BonusStagePrize.STATE_OPENED=4;var BonusStagePrize_GLOBAL_ENABLE=false;var BonusStagePrize_ID_PICK_SELECTED=0;function BonusStagePrize(id,app_reference,parent_container){SObject.call(this);this.ApplicationRef=app_reference;this.ParentContainer=parent_container;this.MainStage=this.ApplicationRef.MainStage;this.MainRenderer=this.ApplicationRef.Renderer;this.SlotReference=null;this.Container=new PIXI.Container;this.ID=id;this.Step=0;this.STATO=BonusStagePrize.STATE_DISABLED;this.PRIZE=0;this.TYPE=0;this.REAL_PRIZE=false;this.Back=null;this.Res=null;this.Prize=null;this.Top=null}BonusStagePrize.prototype=Object.create(SObject.prototype);BonusStagePrize.prototype.constructor=BonusStagePrize;BonusStagePrize.prototype.Init=function(){this.SlotReference=this.ApplicationRef.SLOT();this.STEP=0;if(this.Back!=null)this.Back.Setup();if(this.Res!=null)this.Res.Setup();if(this.Prize!=null)this.Prize.Init();if(this.Top!=null)this.Top.Setup();this.ParentContainer.addChild(this.Container)};BonusStagePrize.prototype.SetupPrize=function(){};BonusStagePrize.prototype.Open=function(real_prize){this.REAL_PRIZE=real_prize;this.STATO=BonusStagePrize.STATE_OPENING};BonusStagePrize.prototype.Stop=function(){this.STATO=BonusStagePrize.STATE_DISABLED};BonusStagePrize.prototype.Mount=function(){};BonusStagePrize.prototype.UnMount=function(){if(this.Top!=null){this.Top.StopTransform();this.Top.Visible(false)}if(this.Res!=null){this.Res.StopTransform();this.Res.Visible(false)}if(this.Back!=null){this.Back.StopTransform();this.Back.Visible(false)}};BonusStagePrize.prototype.IsMounted=function(){return true};BonusStagePrize.prototype.PlayAction=function(){};BonusStagePrize.prototype.Enable=function(){this.STATO=BonusStagePrize.STATE_ENABLED};BonusStagePrize.prototype.Disable=function(){this.STATO=BonusStagePrize.STATE_DISABLED};BonusStagePrize.prototype.Reset=function(){this.PRIZE=0;this.TYPE=0;this.Step=0;this.STATO=BonusStagePrize.STATE_ENABLED;if(this.Top!=null)this.Top.SetMaskFilter(TiledSprite.MASK_STAT_NONE,0);this.Container.visible=true};BonusStagePrize.prototype.get_STATO=function(){return this.STATO};BonusStagePrize.prototype.set_STATO=function(setValue){this.STATO=setValue};BonusStagePrize.prototype.get_PRIZE=function(){return this.PRIZE};BonusStagePrize.prototype.set_PRIZE=function(setValue){this.PRIZE=setValue};BonusStagePrize.prototype.get_TYPE=function(){return this.TYPE};BonusStagePrize.prototype.set_TYPE=function(setValue){this.TYPE=setValue};BonusStagePrize.prototype.Ascii2Digit=function(asc){var digit=asc-48;return digit};BonusStagePrize.prototype.GlobalEnable=function(enb){if(enb==true){BonusStagePrize_GLOBAL_ENABLE=true}else{BonusStagePrize_GLOBAL_ENABLE=false}};BonusStagePrize.prototype.TurnOff_Disabled=function(){if(this.Top!=null){this.Top.SetMaskFilter(TiledSprite.MASK_STAT_DARKEN);this.Top.SetButton(false)}};BonusStagePrize.prototype.TurnOff_Void=function(){if(this.Top!=null){this.Top.SetMaskFilter(TiledSprite.MASK_STAT_GRAY);this.Top.SetButton(false)}};BonusStagePrize.prototype.TurnOn=function(){if(this.Top!=null){this.Top.SetMaskFilter(TiledSprite.MASK_STAT_NONE)}};BonusStagePrize.prototype.TurnOn_Enabled=function(){if(this.Top!=null){this.Top.SetMaskFilter(TiledSprite.MASK_STAT_NONE);this.Top.SetButton(true)}};BonusStagePrize.prototype.IsOn=function(){if(this.Top!=null)return(this.Top.MaskStatus&(TiledSprite.MASK_STAT_DARKEN|TiledSprite.MASK_STAT_GRAY))==0;return true};BonusStagePrize.prototype.Relink=function(){this.ParentContainer.removeChild(this.Container);this.ParentContainer.addChild(this.Container)};BonusStagePrize.prototype.Refresh=function(ellapsed_ms){if(this.Back!=null)this.Back.Refresh(ellapsed_ms);if(this.Res!=null)this.Res.Refresh(ellapsed_ms);if(this.Top!=null)this.Top.Refresh(ellapsed_ms)};BonusStage01Prize.BARREL_WW=252;BonusStage01Prize.BARREL_HH=252;BonusStage01Prize.BARREL_DSH=340;BonusStage01Prize.BARRELS_ROW_2=527+70;BonusStage01Prize.BARRELS_ROW_3=254+70;BonusStage01Prize.BARRELS_ROW_4=0+70;BonusStage01Prize.BARRELS_ROW_5=-680;BonusStage01Prize.BARRELS_COL_2=310;BonusStage01Prize.BARRELS_COL_3=458;BonusStage01Prize.BARRELS_COL_4=598;BonusStage01Prize.BARRELS_COL_5=800;BonusStage01Prize.TAB_BARRELS_COORDS_XX=[BonusStage01Prize.BARRELS_COL_2,BonusStage01Prize.BARRELS_COL_2+1*BonusStage01Prize.BARREL_DSH,BonusStage01Prize.BARRELS_COL_2+2*BonusStage01Prize.BARREL_DSH,BonusStage01Prize.BARRELS_COL_2+3*BonusStage01Prize.BARREL_DSH,BonusStage01Prize.BARRELS_COL_3,BonusStage01Prize.BARRELS_COL_3+1*BonusStage01Prize.BARREL_DSH,BonusStage01Prize.BARRELS_COL_3+2*BonusStage01Prize.BARREL_DSH,BonusStage01Prize.BARRELS_COL_4,BonusStage01Prize.BARRELS_COL_4+1*BonusStage01Prize.BARREL_DSH,BonusStage01Prize.BARRELS_COL_5];BonusStage01Prize.TAB_BARRELS_COORDS_YY=[BonusStage01Prize.BARRELS_ROW_2,BonusStage01Prize.BARRELS_ROW_2,BonusStage01Prize.BARRELS_ROW_2,BonusStage01Prize.BARRELS_ROW_2,BonusStage01Prize.BARRELS_ROW_3,BonusStage01Prize.BARRELS_ROW_3,BonusStage01Prize.BARRELS_ROW_3,BonusStage01Prize.BARRELS_ROW_4,BonusStage01Prize.BARRELS_ROW_4,BonusStage01Prize.BARRELS_ROW_5];BonusStage01Prize.TAB_BARRELS_SPRITES=["BN01_TopA","BN01_TopA","BN01_TopA","BN01_TopA","BN01_TopA","BN01_TopA","BN01_TopA","BN01_TopA","BN01_TopA","BN01_TopJ"];BonusStage01Prize.TAB_BARRELS_FRAMES=[23,23,23,23,23,23,23,23,23,50];function BonusStage01Prize(id,app_reference,parent_container){BonusStagePrize.call(this,id,app_reference,parent_container);this.Prize=new DisplayStyle(0,0,0,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:64,fontStyle:"normal",fontWeight:"bold",strokeThickness:2,fill:"white"}));this.Back=new TiledSprite("BN01_Prize",8,true,this.Container,".webp");if(this.ID==BonusStage01Prize.TAB_BARRELS_SPRITES.length-1)this.Res=new TiledSprite("JP_FX00",20,false,this.Container,".webp");else this.Res=null;this.Top=new TiledSprite(BonusStage01Prize.TAB_BARRELS_SPRITES[this.ID],BonusStage01Prize.TAB_BARRELS_FRAMES[this.ID],true,this.Container,".webp")}BonusStage01Prize.prototype=Object.create(BonusStagePrize.prototype);BonusStage01Prize.prototype.constructor=BonusStage01Prize;BonusStage01Prize.prototype.Init=function(){BonusStagePrize.prototype.Init.call(this);this.Prize.SetAreaWidth(BonusStage01Prize.BARREL_WW)};BonusStage01Prize.prototype.Mount=function(){BonusStagePrize.prototype.Mount.call(this);if(this.ID!=BonusStage01Prize.TAB_BARRELS_SPRITES.length-1)this.Top.SetButton(true);else{this.Top.SetButton(false)}};BonusStage01Prize.prototype.UnMount=function(){BonusStagePrize.prototype.UnMount.call(this)};BonusStage01Prize.prototype.SetupPrize=function(){BonusStagePrize.prototype.SetupPrize.call(this);if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_PRIZE){this.Prize.SetCaption(this.PRIZE)}if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_DEATH)this.Back.SetFrame(0);else if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_LEVELUP)this.Back.SetFrame(1);else if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_PRIZE)this.Back.SetFrame(2);else if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_JP)this.Back.SetFrame(2+this.PRIZE);this.Back.CenterBox(this.Top.ACTUAL_W(),this.Top.ACTUAL_H(),true);this.Back.Sprite.y+=0;this.Prize.CenterBox(this.Top.ACTUAL_W(),this.Top.ACTUAL_H(),true)};BonusStage01Prize.prototype.Open=function(real_prize){BonusStagePrize.prototype.Open.call(this,real_prize);this.Relink();this.Top.SetMaskFilter(TiledSprite.MASK_STAT_NONE);this.Step=1};BonusStage01Prize.prototype.PlayAction=function(){BonusStagePrize.prototype.PlayAction.call(this);switch(this.Step){case 0:{}break;case 1:{if(this.ID!=BonusStage01Prize.TAB_BARRELS_SPRITES.length-1){this.Top.SPRITE_TRANSFORMER().AnimateAbs(0,this.Top.TotFrames-1,SpriteTransformer.ANIMATION_NONE,50);this.Top.SPRITE_TRANSFORMER().ScaleAbs(1.3,1.3,this.Top.TotFrames-1,SpriteTransformer.ANIMATION_NONE,50);this.Back.Visible(true);if(this.REAL_PRIZE==false){this.Back.SetMaskFilter(TiledSprite.MASK_STAT_GRAY)}else{this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BONUS_PRIZE_OPEN,SoundGenerator.SMP_VOLUME_NORMAL)}this.Step=3}else{this.Top.SPRITE_TRANSFORMER().MoveRel(0,1e3,30,10);this.Step=2}}break;case 2:{if(this.Top.TransformOver()==true){this.Res.ResetProperties(true,1,2);this.Res.CenterBoxOnSprite(this.Top);this.Res.SPRITE_TRANSFORMER().AnimateAbs(0,this.Res.TotFrames-1,SpriteTransformer.ANIMATION_NONE,150);this.Top.SPRITE_TRANSFORMER().AnimateAbs(0,this.Top.TotFrames-1,SpriteTransformer.ANIMATION_NONE,150);this.Top.SPRITE_TRANSFORMER().FadeAbs(0,parseInt((this.Top.TotFrames-1)/2),150);this.Back.ResetProperties(true,0,1);this.Back.CenterBoxOnSprite(this.Top);this.Back.SPRITE_TRANSFORMER().FadeAbs(1,this.Top.TotFrames-1,100);this.Step=3}}break;case 3:{if(this.Top.TransformOver()==true){this.Opened();this.Step=4}}break;case 4:{if(this.Back.TransformOver()==true){if(this.Res!=null){this.Res.StopTransform();this.Res.Visible(false)}if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_JP){this.Back.SPRITE_TRANSFORMER().ScaleAndGoto(1.2,.1,10,10);this.Step=5}else{this.STATO=BonusStagePrize.STATE_OPENED;this.Step=0}}}break;case 5:{if(this.Back.TransformOver()==true){this.Back.SPRITE_TRANSFORMER().MoveRel(0,500,20,10);this.Back.SPRITE_TRANSFORMER().FadeAbs(0,20,10);this.Step=6}}break;case 6:{if(this.Back.TransformOver()==true){this.Step=0}}break;default:break}};BonusStage01Prize.prototype.Opened=function(){this.Top.Visible(false);this.Back.ResetProperties(true,1,1);this.Back.CenterBoxOnSprite(this.Top);if(this.TYPE!=BonusDescriptor.BONUS_PICK_OBJ_JP){if(this.REAL_PRIZE==true){if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_DEATH){this.Back.SPRITE_TRANSFORMER().ScaleAndBack(1.3,3,10,SpriteTransformer.MASK_BACK_TO_ORG);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BONUS_PRIZE_BAD,SoundGenerator.SMP_VOLUME_NORMAL)}else if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_LEVELUP){this.Back.SPRITE_TRANSFORMER().ScaleAndBack(1.3,3,10,SpriteTransformer.MASK_BACK_TO_ORG);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BONUS_PRIZE_GOOD,SoundGenerator.SMP_VOLUME_NORMAL)}else if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_PRIZE){this.Back.SPRITE_TRANSFORMER().LightAndBack(7,10,10);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BONUS_PRIZE_GOOD,SoundGenerator.SMP_VOLUME_NORMAL)}}if(this.TYPE==BonusDescriptor.BONUS_PICK_OBJ_PRIZE){this.Prize.Visible(true)}}else{this.Back.SPRITE_TRANSFORMER().ScaleAndBack(1.5,10,10,SpriteTransformer.MASK_BACK_TO_ORG);setTimeout(()=>{this.ApplicationRef.SLOT().BONUSSTAGE().RunningBonus.UpdatePremioDisplay()},100)}this.STATO=BonusStagePrize.STATE_OPENED};BonusStage01Prize.prototype.Reset=function(){BonusStagePrize.prototype.Reset.call(this);this.Container.x=BonusStage01Prize.TAB_BARRELS_COORDS_XX[this.ID];this.Container.y=BonusStage01Prize.TAB_BARRELS_COORDS_YY[this.ID];this.Container.alpha=1;if(this.Back!=null){this.Back.XX(0,0);this.Back.YY(0,0);this.Back.ResetProperties(false,1,1);this.Back.SetFrame(0)}if(this.Res!=null){this.Res.XX(0,0);this.Res.YY(0,0);this.Res.ResetProperties(false,1,1);this.Res.SetFrame(0);this.Res.SPRITE_TRANSFORMER().ScaleAbs(2,2,1,0,0)}this.Prize.XX(0,0);this.Prize.YY(0,0);this.Prize.ResetProperties(false,1,1);this.Top.XX(0,0);this.Top.YY(0,0);this.Top.ResetProperties(true,1,1);if(this.ID==BonusStage01Prize.TAB_BARRELS_SPRITES.length-1){this.Top.SPRITE_TRANSFORMER().ScaleAbs(2.5,2.5,1,0,0)}else{this.Top.XX(0,0);this.Top.YY(0,0);this.Top.SCALE_X(.6);this.Top.SCALE_Y(.6)}this.Top.SetFrame(0)};BonusStage01Prize.prototype.Refresh=function(ellapsed_ms){BonusStagePrize.prototype.Refresh.call(this,ellapsed_ms);if(this.Top.CheckButtStatus(TiledSprite.MASK_BUTT_PUSHED)==true){this.OnMouseClick()}if(this.Top.CheckButtStatus(TiledSprite.MASK_BUTT_OVER)==true){this.OnMouseOver()}if(this.Top.CheckButtStatus(TiledSprite.MASK_BUTT_OUT)==true){this.OnMouseOut()}};BonusStage01Prize.prototype.OnMouseClick=function(){if(BonusStagePrize_GLOBAL_ENABLE==true){if(this.STATO==BonusStagePrize.STATE_ENABLED){this.STATO=BonusStagePrize.STATE_CLICKED;this.Top.SPRITE_TRANSFORMER().LightAndBack(5,3,10)}}};BonusStage01Prize.prototype.OnMouseOver=function(){if(BonusStagePrize_GLOBAL_ENABLE==true){if(this.STATO==BonusStagePrize.STATE_ENABLED){this.Top.SetMaskFilter(TiledSprite.MASK_STAT_RED)}}};BonusStage01Prize.prototype.OnMouseOut=function(){if(BonusStagePrize_GLOBAL_ENABLE==true){if(this.STATO==BonusStagePrize.STATE_ENABLED){this.Top.SetMaskFilter(TiledSprite.MASK_STAT_NONE)}}};BonusStagePU.BONUS_TYPE_MULTI=1;BonusStagePU.BONUS_TYPE_SINGLE=2;BonusStagePU.BONUS_STEP_SET_EXIT=10;BonusStagePU.BONUS_STEP_EXIT=11;BonusStagePU.TAB_CAPTIONS=[["CLICK ON THE IMAGE TO CONTINUE","CLICCA SULL'IMMAGINE PER CONTINUARE"],["YOU WON ","HAI VINTO "]];function BonusStagePU(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=null;this.SlotReference=null;this.Container=new PIXI.Container;this.ID_BONUS=0;this.TYPE_BONUS=0;this.STEP=0;this.NUM_SENSITIVE_AREAS=0;this.NUM_PICKS=0;this.ID_PICK=0;this.PUNTI_ASSEGNATI=0;this.BigWin_Enabled=true;this.Bersagli=null;this.ID_TIMER_PAUSA=0}BonusStagePU.prototype=Object.create(SObject.prototype);BonusStagePU.prototype.constructor=BonusStagePU;BonusStagePU.prototype.Init=function(){
this.SlotReference=this.ApplicationRef.SLOT();this.MainStage=this.SlotReference.CONTAINER();if(this.Bersagli!=null){for(var i=0;i<this.Bersagli.length;i++)this.Bersagli[i].Init()}this.STEP=0};BonusStagePU.prototype.Ready=function(){for(var i=0;i<this.Bersagli.length;i++){this.Bersagli[i].Reset()}this.STEP=0;this.PUNTI_ASSEGNATI=0};BonusStagePU.prototype.WaitForPlayer=function(){var i,j;for(i=0;i<this.Bersagli.length;i++){if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_CLICKED){this.ID_PICK=i;return false}}return true};BonusStagePU.prototype.FixPremio=function(){var PREMIO;if(this.ID_PICK!=255){PREMIO=this.Bersagli[this.ID_PICK].get_PRIZE();this.ApplicationRef.SLOT().IncVincitaVideo(PREMIO)}this.ApplicationRef.CONSOLE().UpdateDisplayQueue()};BonusStagePU.prototype.Mount=function(){this.ApplicationRef.SLOT().LINER().Visible(false);this.ApplicationRef.SLOT().REEL_HOLDER().Visible(false);this.PlayMusic();this.MainStage.addChild(this.Container)};BonusStagePU.prototype.Unmount=function(){this.ApplicationRef.SLOT().REEL_STAGE().SetType(SlotStage.TEATRO_NORMAL);this.ApplicationRef.SLOT().LINER().Visible(true);this.ApplicationRef.SLOT().REEL_HOLDER().Visible(true);this.MainStage.removeChild(this.Container)};BonusStagePU.prototype.Run=function(){var i;var running=true;switch(this.STEP){case 0:{this.InitIntro();this.STEP++}break;case 1:{if(this.PlayIntro()==false){this.EndIntro();BonusStagePrize_GLOBAL_ENABLE=true;this.STEP++}}break;case 2:{if(this.WaitForPlayer()==false){this.OnPlayerSelect();this.ApplicationRef.GAMEPROXY().NOTIFY_PLAY_BONUS(this.ID_BONUS,BonusDescriptor.BS_ACTION_BONUS_PICK,this.ID_PICK);this.STEP++}}break;case 3:{if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.STEP++}}break;case 4:{if(this.ID_PICK==255){if(this.Bersagli[0].get_STATO()==BonusStagePrize.STATE_OPENING)this.STEP++}else{if(this.Bersagli[this.ID_PICK].get_STATO()==BonusStagePrize.STATE_OPENING)this.STEP++}}break;case 5:{if(this.ID_PICK==255){for(i=0,running=false;i<this.Bersagli.length;i++){this.Bersagli[i].PlayAction();if(this.Bersagli[i].get_STATO()!=BonusStagePrize.STATE_OPENED){running=true}}}else{this.Bersagli[this.ID_PICK].PlayAction();if(this.Bersagli[this.ID_PICK].get_STATO()==BonusStagePrize.STATE_OPENED){running=false}}if(running==false){if(this.Over_CHECK()==true){this.ID_TIMER_PAUSA=0;if(this.Bersagli[this.ID_PICK].get_TYPE()==BonusDescriptor.BONUS_PICK_OBJ_PRIZE){const msgParts=this.ApplicationRef.CONSOLE().Info.StaticInfo_Queue.trim().split(" ");let msg=msgParts[0];for(let i=1;i<msgParts.length;++i){if(i==msgParts.length-3){let coins=parseInt(msgParts[i]);coins=coins/this.JP_MULTY;msg=msg+" "+coins}else if(i==msgParts.length-1){const moneyStr=msgParts[i];let money=moneyStr.replace(",",".");money=money.slice(0,-1);money=parseFloat(money)/this.JP_MULTY;money=money.toString().replace(".",",")+moneyStr[moneyStr.length-1];msg=msg+" "+money}else{msg=msg+" "+msgParts[i]}}this.ApplicationRef.CONSOLE().SetStaticDisplay(msg,false)}}else{this.ID_TIMER_PAUSA=0;this.FixPremio();this.ApplicationRef.CONSOLE().SetFreezeCounters(false)}this.STEP++}}break;case 6:{if(this.ID_TIMER_PAUSA==0){this.OnOpenComplete();this.STEP=7}}break;case 7:{if(this.OnSetReady()==true){if(this.Exit_ACK()==true){if(this.BigWin_Enabled==true){this.ID_TIMER_PAUSA=this.ArmaTimer(this.ID_TIMER_PAUSA,1500);this.STEP=8}else this.STEP=8}else this.STEP=2}}break;case 8:{if(this.ID_TIMER_PAUSA==0){this.SlotReference.CONGRATULATIONS().Mount("WinUp",1,50,-20,BonusStagePU.TAB_CAPTIONS[1][window.LANG]+this.PUNTI_ASSEGNATI.toString(),560,BonusStagePU.TAB_CAPTIONS[0][window.LANG],680,this.ApplicationRef.CONTAINER(),".webp");this.OnBigWinMount();this.STEP=9}}break;case 9:{if(this.SlotReference.CONGRATULATIONS().IsMounted()==false){for(i=0;i<this.Bersagli.length;i++){this.Bersagli[i].Stop();this.Bersagli[i].UnMount()}this.OnSetExit();this.STEP=BonusStagePU.BONUS_STEP_SET_EXIT}}break;case BonusStagePU.BONUS_STEP_SET_EXIT:{this.STEP=BonusStagePU.BONUS_STEP_EXIT}break;case BonusStagePU.BONUS_STEP_EXIT:{}break;default:break}};BonusStagePU.prototype.UpdatePremioDisplay=function(){this.FixPremio();this.ApplicationRef.CONSOLE().SetFreezeCounters(false)};BonusStagePU.prototype.IsOver=function(){if(this.STEP==BonusStagePU.BONUS_STEP_EXIT)return true;return false};BonusStagePU.prototype.PlayMusic=function(){};BonusStagePU.prototype.InitIntro=function(){};BonusStagePU.prototype.PlayIntro=function(){return false};BonusStagePU.prototype.EndIntro=function(){};BonusStagePU.prototype.OnPlayerSelect=function(){BonusStagePrize_ID_PICK_SELECTED=this.ID_PICK;for(var i=0;i<this.Bersagli.length;i++){this.Bersagli[i].GlobalEnable(false)}this.ApplicationRef.CONSOLE().SetFreezeCounters(true)};BonusStagePU.prototype.OnOpenComplete=function(){for(var i=0;i<this.Bersagli.length;i++){this.Bersagli[i].GlobalEnable(true)}};BonusStagePU.prototype.OnSetReady=function(){var running=false;if(running==true||this.ID_TIMER_PAUSA!=0)return false;return true};BonusStagePU.prototype.Exit_ACK=function(){if(this.TYPE_BONUS==BonusStagePU.BONUS_TYPE_SINGLE)return true;for(var i=0;i<this.Bersagli.length;i++){if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_ENABLED)return false}return true};BonusStagePU.prototype.Over_CHECK=function(){if(this.TYPE_BONUS!=BonusStagePU.BONUS_TYPE_SINGLE){if(this.ID_PICK==255){return true}else{if(this.Bersagli[this.ID_PICK].get_PRIZE()==0)return true;return false}}return true};BonusStagePU.prototype.OnBigWinMount=function(){};BonusStagePU.prototype.OnSetExit=function(){};BonusStagePU.prototype.Refresh=function(ellapsed_ms){this.ID_TIMER_PAUSA=this.TimerDec(this.ID_TIMER_PAUSA,ellapsed_ms);if(this.Bersagli!=null){for(var i=0;i<this.Bersagli.length;i++){this.Bersagli[i].Refresh(ellapsed_ms)}}};BonusStagePU.prototype.Parse_BONUS_STATUS=function(chunk_to_parse){var i,pick_status,pick_value;this.ParseServer_Init(chunk_to_parse);this.PUNTI_ASSEGNATI=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_PICK_WIN);this.NUM_PICKS=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_PICK_NUM);this.ApplicationRef.SLOT().SetVincitaVideo(this.PUNTI_ASSEGNATI);if(this.ParseServer_SEEK(BonusDescriptor.BS_OFFSET_PICK_STATUS)==false)return false;for(i=0;i<this.Bersagli.length;i++){pick_status=this.ParseServer_Dump_UINT(-1);pick_value=this.ParseServer_Dump_UINT(-1);this.Bersagli[i].set_PRIZE(pick_value);if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_ENABLED&&pick_status==BonusDescriptor.BONUS_PICK_OPENED){this.Bersagli[i].Disable();this.Bersagli[i].Visible(false)}else if(pick_status==BonusDescriptor.BONUS_PICK_OPENING_REAL){this.Bersagli[i].set_PRIZE(pick_value);this.Bersagli[i].SetupPrize();this.Bersagli[i].Open(true)}else if(pick_status==BonusDescriptor.BONUS_PICK_OPENING_FAKE){this.Bersagli[i].set_PRIZE(pick_value);this.Bersagli[i].SetupPrize();this.Bersagli[i].Open(false)}}return true};BonusStage01.MAX_PICKS=5;BonusStage01.TAB_FLOOR_YY=[BonusStage01Prize.BARRELS_ROW_2,BonusStage01Prize.BARRELS_ROW_3,BonusStage01Prize.BARRELS_ROW_4,BonusStage01Prize.BARRELS_ROW_5];BonusStage01.TAB_PICKS_FLOOR=[[0,1,2,3,255],[4,5,6,255,255],[7,8,255,255,255],[9,255,255,255,255]];BonusStage01.TAB_CAPTIONS=[["CLICK ON THE IMAGE TO CONTINUE","CLICCA SULL'IMMAGINE PER CONTINUARE"],["LIVES LEFT:","VITE RIMASTE:"],["YOU WON ","HAI VINTO "],[" PICKS!"," PICKS!"],["CHOOSE A STATUE!","SCEGLI UNA STATUA!"]];function BonusStage01(app_reference,endCallback){BonusStagePU.call(this,app_reference);this.ID_BONUS=BonusDescriptor.ID_BONUS_PICK;this.TYPE_BONUS=BonusStagePU.BONUS_TYPE_MULTI;this.NUM_SENSITIVE_AREAS=10;this.Bersagli=new Array(this.NUM_SENSITIVE_AREAS);for(let i=0;i<this.Bersagli.length;i++){this.Bersagli[i]=new BonusStage01Prize(i,app_reference,this.Container)}this.BackGround=new TiledSprite("BN01_Stage",1,true,this.Container,".webp");this.FloorIndicatorSX=new TiledSprite("BN01_FloorSX",1,true,this.Container,".webp");this.FloorIndicatorDX=new TiledSprite("BN01_FloorDX",1,true,this.Container,".webp");this.TimesDisplay=new DisplayStyle(0,0,16,"center",this.Container,new PIXI.TextStyle({fontFamily:"Game_Font",fontSize:64,fontStyle:"normal",fontWeight:"bold",strokeThickness:2,fill:"white"}));this.StepIntro=0;this.TimeIntro=0;this.FallStageAcelerator=0;this.CurFloor=0;this.CUR_FLOOR=0;this.JP_MULTY=0;this.JP_Play=false;this.BigWin_Enabled==true;this.LoadResources(endCallback)}BonusStage01.prototype=Object.create(BonusStagePU.prototype);BonusStage01.prototype.constructor=BonusStage01;BonusStage01.prototype.LoadResources=function(endCallback){const loader=this.ApplicationRef.LOADER();loader.add("TEX_BonusCongrat","resources/BonusCongratulations/BonusCongratulation.json");loader.add("TEX_BonusStage","resources/BonusStage/BonusStage.json");loader.add("TEX_BonusStage2","resources/BonusStage/BN_Stage.json");loader.add("TEX_BonusPrizeTop0","resources/BonusPrize/BonusPrizeTop-0.json");loader.add("TEX_BonusPrizeTop1","resources/BonusPrize/BonusPrizeTop-1.json");loader.add("TEX_BonusJPFX","resources/BonusPrize/BonusJPFX.json");loader.once("complete",endCallback);loader.load()};BonusStage01.prototype.Init=function(){this.BackGround.Setup();BonusStagePU.prototype.Init.call(this);this.FloorIndicatorSX.Setup();this.FloorIndicatorDX.Setup();this.TimesDisplay.Init();this.TimesDisplay.SetAreaWidth(window.VIDEO_WIDTH);this.TimesDisplay.Visible(true)};BonusStage01.prototype.PlayMusic=function(){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.GAME_LOOP);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BONUS_LOOP,SoundGenerator.SMP_VOLUME_NORMAL|SoundGenerator.SMP_LOOP,true)};BonusStage01.prototype.Mount=function(){this.ApplicationRef.SLOT().REEL_STAGE().SetType(SlotStage.TEATRO_BONUS);this.ApplicationRef.CONSOLE().Disable();for(let i=0;i<this.Bersagli.length;i++){this.Bersagli[i].Mount()}this.FloorIndicator_Off();this.Container.y=-this.Container.height;this.MainStage.addChild(this.Container);this.JP_Play=false};BonusStage01.prototype.Unmount=function(){BonusStagePU.prototype.Unmount.call(this);this.ApplicationRef.CONSOLE().Enable();this.FloorIndicator_Off()};BonusStage01.prototype.InitIntro=function(){this.TimeIntro=0;this.StepIntro=1;this.FallStageAcelerator=1;this.UpdateTimes();this.FloorUpdate();this.SlotReference.CONGRATULATIONS().Mount("BonusCongratulation",1,50,-56,BonusStage01.TAB_CAPTIONS[2][window.LANG]+this.NUM_PICKS.toString()+BonusStage01.TAB_CAPTIONS[3][window.LANG],480,BonusStage01.TAB_CAPTIONS[0][window.LANG],600,this.ApplicationRef.CONTAINER(),".webp")};BonusStage01.prototype.PlayIntro=function(){let running=true;switch(this.StepIntro){case 0:{}break;case 1:{if(this.SlotReference.CONGRATULATIONS().IsMounted()==false){this.ApplicationRef.SLOT().TerminaAnimazioneVincita();this.PlayMusic();this.StepIntro++}}break;case 2:{if(this.Container.y<0){this.Container.y+=this.DeviceInc(10+this.FallStageAcelerator);this.FallStageAcelerator<<=1;if(this.FallStageAcelerator>40)this.FallStageAcelerator=40}else{this.Container.y=0;this.FloorIndicator_On();this.UpdateTimes();running=false}}break;default:break}return running};BonusStage01.prototype.EndIntro=function(){this.ApplicationRef.SLOT().CONSOLE().SetStaticDisplay(BonusStage01.TAB_CAPTIONS[4][window.LANG],false);this.StepIntro=0};BonusStage01.prototype.OnPlayerSelect=function(){BonusStagePU.prototype.OnPlayerSelect.call(this);this.FloorIndicator_Off()};BonusStage01.prototype.FixPremio=function(){BonusStagePU.prototype.FixPremio.call(this)};BonusStage01.prototype.UpdateTimes=function(){this.TimesDisplay.SetCaption(BonusStage01.TAB_CAPTIONS[1][window.LANG]+this.NUM_PICKS)};BonusStage01.prototype.OnOpenComplete=function(){BonusStagePU.prototype.OnOpenComplete.call(this);this.FloorUpdate();this.FloorIndicator_On();this.UpdateTimes();if(this.CUR_FLOOR==BonusStage01.TAB_FLOOR_YY.length-1){this.Bersagli[this.NUM_SENSITIVE_AREAS-1].set_TYPE(BonusDescriptor.BONUS_PICK_OBJ_JP);this.Bersagli[this.NUM_SENSITIVE_AREAS-1].set_PRIZE(this.JP_MULTY);this.Bersagli[this.NUM_SENSITIVE_AREAS-1].SetupPrize();this.Bersagli[this.NUM_SENSITIVE_AREAS-1].Open(true);this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.TURBO_BGND,SoundGenerator.SMP_VOLUME_AMPLIFY);this.ID_TIMER_PAUSA=this.ArmaTimer(this.ID_TIMER_PAUSA,5*1e3);this.JP_Play=true}};BonusStage01.prototype.OnSetReady=function(){if(this.JP_Play==true){this.Bersagli[this.NUM_SENSITIVE_AREAS-1].PlayAction();if(this.Bersagli[this.NUM_SENSITIVE_AREAS-1].get_STATO()==BonusStagePrize.STATE_OPENED){return BonusStagePU.prototype.OnSetReady.call(this)}return false}return true};BonusStage01.prototype.Exit_ACK=function(){if(BonusStagePU.prototype.Exit_ACK.call(this)==false){if(this.NUM_PICKS==0)return true;if(this.CUR_FLOOR==BonusStage01.TAB_FLOOR_YY.length-1)return true;return false}return true};BonusStage01.prototype.Over_CHECK=function(){if(this.NUM_PICKS==0||this.CUR_FLOOR==BonusStage01.TAB_FLOOR_YY.length-1){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.BONUS1_LOOP);return true}return false};BonusStage01.prototype.FloorIndicator_Off=function(){this.FloorIndicatorSX.StopTransform();this.FloorIndicatorSX.ResetProperties(false,1,1);this.FloorIndicatorDX.StopTransform();this.FloorIndicatorDX.ResetProperties(false,1,1)};BonusStage01.prototype.FloorIndicator_On=function(){var i,from,to;if(this.CurFloor==BonusStage01.TAB_PICKS_FLOOR.length-1)return;from=BonusStage01.TAB_PICKS_FLOOR[this.CurFloor][0];i=0;while(BonusStage01.TAB_PICKS_FLOOR[this.CurFloor][i+1]!=255)i++;to=BonusStage01.TAB_PICKS_FLOOR[this.CurFloor][i];this.FloorIndicatorSX.XX(this.Bersagli[from].Container.x,-200);this.FloorIndicatorSX.YY(BonusStage01.TAB_FLOOR_YY[this.CurFloor],100);this.FloorIndicatorSX.Visible(true);this.FloorIndicatorSX.SPRITE_TRANSFORMER().FadeLoop(.5,10,50);this.FloorIndicatorSX.SPRITE_TRANSFORMER().MoveEx(-10,0,10,25);this.FloorIndicatorDX.XX(this.Bersagli[to].Container.x,this.Bersagli[from].Top.ACTUAL_W()+30);this.FloorIndicatorDX.YY(BonusStage01.TAB_FLOOR_YY[this.CurFloor],100);this.FloorIndicatorDX.Visible(true);this.FloorIndicatorDX.SPRITE_TRANSFORMER().FadeLoop(.5,10,50);this.FloorIndicatorDX.SPRITE_TRANSFORMER().MoveEx(10,0,10,25)};BonusStage01.prototype.FloorUpdate=function(){this.CurFloor=this.CUR_FLOOR;for(let i=0;i<this.NUM_SENSITIVE_AREAS;i++){if(i==this.NUM_SENSITIVE_AREAS-1){this.Bersagli[i].TurnOn()}else if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_DISABLED){if(i<BonusStage01.TAB_PICKS_FLOOR[this.CurFloor][0])this.Bersagli[i].TurnOff_Void();else this.Bersagli[i].TurnOff_Disabled()}else if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_ENABLED){this.Bersagli[i].TurnOn_Enabled()}else if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_OPENING){this.Bersagli[i].TurnOff_Void()}}};BonusStage01.prototype.Parse_BONUS_STATUS=function(chunk_to_parse){var i,pick_status,pick_object,pick_value;this.ParseServer_Init(chunk_to_parse);this.PUNTI_ASSEGNATI=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_PICK_WIN);this.NUM_PICKS=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_PICK_NUM);this.CUR_FLOOR=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_PICK_FLOOR);this.JP_MULTY=this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_PICK_JP);this.ApplicationRef.SLOT().SetVincitaVideo(this.PUNTI_ASSEGNATI);if(this.ParseServer_SEEK(BonusDescriptor.BS_OFFSET_PICK_STATUS)==false)return false;for(i=0;i<this.NUM_SENSITIVE_AREAS;i++){pick_status=this.ParseServer_Dump_UINT(-1);pick_object=this.ParseServer_Dump_UINT(-1);pick_value=this.ParseServer_Dump_UINT(-1);this.Bersagli[i].set_TYPE(pick_object);this.Bersagli[i].set_PRIZE(pick_value);if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_DISABLED&&pick_status==BonusDescriptor.BONUS_PICK_ENABLED){this.Bersagli[i].Enable()}else if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_ENABLED&&pick_status==BonusDescriptor.BONUS_PICK_OPENED){this.Bersagli[i].SetupPrize();this.Bersagli[i].Opened()}else if(this.Bersagli[i].get_STATO()==BonusStagePrize.STATE_ENABLED&&pick_status==BonusDescriptor.BONUS_PICK_DISABLED){this.Bersagli[i].Disable()}else if(pick_status==BonusDescriptor.BONUS_PICK_OPENING_REAL){this.Bersagli[i].SetupPrize();this.Bersagli[i].Open(true)}else if(pick_status==BonusDescriptor.BONUS_PICK_OPENING_FAKE){this.Bersagli[i].SetupPrize();this.Bersagli[i].Open(false)}}return true};BonusStage01.prototype.Refresh=function(ellapsed_ms){BonusStagePU.prototype.Refresh.call(this,ellapsed_ms);this.BackGround.Refresh(ellapsed_ms);this.FloorIndicatorSX.Refresh(ellapsed_ms);this.FloorIndicatorDX.Refresh(ellapsed_ms)};BonusStageManager.BONUS_STAT_IDLE=0;BonusStageManager.BONUS_STAT_ARMED=1;BonusStageManager.BONUS_STAT_RUNNING=2;BonusStageManager.BONUS_STAT_OVER=3;function BonusStageManager(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=this.ApplicationRef.MainStage;this.SlotReference=null;this.BonusStage01=null;this.RunningBonus=null;this.BONUS_Status=0;this.BONUS_Status_Req=0}BonusStageManager.prototype=Object.create(SObject.prototype);BonusStageManager.prototype.constructor=BonusStageManager;BonusStageManager.prototype.Init=function(){this.SlotReference=this.ApplicationRef.SLOT();this.BONUS_Status=BonusStageManager.BONUS_STAT_IDLE;this.BONUS_Status_Req=BonusStageManager.BONUS_STAT_IDLE};BonusStageManager.prototype.SelectedStage_Mount=function(){this.RunningBonus.Mount()};BonusStageManager.prototype.SelectedStage_Unmount=function(){this.RunningBonus.Unmount();this.RunningBonus=null};BonusStageManager.prototype.SelectedStage_Run=function(){this.RunningBonus.Run()};BonusStageManager.prototype.SelectedStage_IsOver=function(){return this.RunningBonus.IsOver()};BonusStageManager.prototype.Refresh=function(ellapsed_ms){if(this.RunningBonus!=null)this.RunningBonus.Refresh(ellapsed_ms)};BonusStageManager.prototype.Parse_BONUS_STATUS=function(chunk_to_parse){if(this.RunningBonus==null){this.ParseServer_Init(chunk_to_parse);return this.Parse_BONUS_ACTIVATE(this.ParseServer_Dump_UINT(BonusDescriptor.BS_OFFSET_ID_BONUS),()=>{this.RunningBonus.Parse_BONUS_STATUS(chunk_to_parse)})}else{return this.RunningBonus.Parse_BONUS_STATUS(chunk_to_parse)}};BonusStageManager.prototype.Parse_BONUS_ACTIVATE=function(bonus_id,bonusLoadCallback){if(bonus_id<BonusDescriptor.ID_BONUS_PICK)return false;this.SelectedStage_Ready(bonus_id-BonusDescriptor.ID_BONUS_PICK,bonusLoadCallback);return true};BonusStageManager.prototype.SelectedStage_Ready=function(p_ID_Bonus,bonusLoadCallback){if(this.BonusStage01==null){this.BonusStage01=new BonusStage01(this.ApplicationRef,()=>{this.BonusStage01.Init();this.RunningBonus=this.BonusStage01;this.RunningBonus.Ready();this.BONUS_Status=BonusStageManager.BONUS_STAT_IDLE;this.BONUS_Status_Req=BonusStageManager.BONUS_STAT_ARMED;bonusLoadCallback()})}else{this.RunningBonus=this.BonusStage01;this.RunningBonus.Ready();this.BONUS_Status=BonusStageManager.BONUS_STAT_IDLE;this.BONUS_Status_Req=BonusStageManager.BONUS_STAT_ARMED;bonusLoadCallback()}};BonusStageManager.prototype.ActionPending=function(){return this.BONUS_Status!=this.BONUS_Status_Req};BonusStageManager.prototype.RunAction=function(){if(this.BONUS_Status==BonusStageManager.BONUS_STAT_IDLE&&this.BONUS_Status_Req==BonusStageManager.BONUS_STAT_ARMED){this.SelectedStage_Mount();this.BONUS_Status=BonusStageManager.BONUS_STAT_ARMED;this.BONUS_Status_Req=BonusStageManager.BONUS_STAT_RUNNING}else if(this.BONUS_Status==BonusStageManager.BONUS_STAT_ARMED&&this.BONUS_Status_Req==BonusStageManager.BONUS_STAT_RUNNING){this.SelectedStage_Run();if(this.SelectedStage_IsOver()==true){this.SelectedStage_Unmount();this.BONUS_Status=BonusStageManager.BONUS_STAT_IDLE;this.BONUS_Status_Req=BonusStageManager.BONUS_STAT_IDLE}}};Slot.DEBUG_SPRITE=0;Slot.DEBUG_BONUS=0;Slot.ID_FSM_SLOT_0=0;Slot.ID_FSM_SLOT_1=1;Slot.ID_FSM_SLOT_2=2;Slot.ID_FSM_SLOT_3=3;Slot.ID_FSM_SLOT_4=4;Slot.ID_FSM_SLOT_5=5;Slot.ID_FSM_SLOT_6=6;Slot.ID_FSM_SLOT_7=7;Slot.ID_FSM_SLOT_STOP=10;function Slot(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=this.ApplicationRef.MainStage;this.MainRenderer=this.ApplicationRef.Renderer;this.SlotCombo=new SlotCombo(this.ApplicationRef,this);this.Container=null;this.SlotStage=null;this.SlotFrame=null;this.ReelHolder=null;this.SlotConsoleRef=null;this.SlotLiner=null;this.FreeSpinStage=null;this.BonusStage=null;this.BigWin=null;this.Congratulations=null;this.PayTable=null;this.LongWild=null;this.Dummy=null;this.Linee=window.NUM_LINEE;this.Power=1;this.VincitaVideo_Coins=0;this.VincitaVideo_Divisa=0;this.ValoreVincitaAssegnata=0;this.StepAccredito=0;this.ID_TIMER_ACCREDITO=0;this.ID_TIMER_WAIT_FOR_ACCREDITO=0;this.StepAnimazione=0;this.AccreditoVincita_ACK=false;this.DefinitiveAnimazioneVincitaCompletata=false;this.PremutoSTART=false;this.Initialized=false;this.StepFSM=0;this.SimboliEstratti=new Array(window.NUM_RULLI);this.DEBUG_LOG("Slot constructed.")}Slot.prototype=Object.create(SObject.prototype);Slot.prototype.constructor=Slot;Slot.prototype.Init=function(){this.SlotCombo.Init();this.Container=new PIXI.Container;this.DEBUG_LOG("Container created for Slot ");this.SlotStage=new SlotStage(this.Container,this.ApplicationRef);this.ReelHolder=new ReelHolder(this.Container,this.MainRenderer,this.ApplicationRef);this.LongWild=new LongWild(this.Container,this.ApplicationRef);this.SlotFrame=new SlotFrame(this.Container,this.ApplicationRef);this.SlotConsoleRef=this.ApplicationRef.CONSOLE();this.SlotLiner=new SlotLiner(this.ApplicationRef.CONSOLE().Container,this.ApplicationRef);this.FreeSpinStage=new FreeSpinStage(this.ApplicationRef);this.BonusStage=new BonusStageManager(this.ApplicationRef);this.Congratulations=new Congratulation(this.ApplicationRef);this.PayTable=new PayTable(this.ApplicationRef);this.SlotStage.Init();this.ReelHolder.Init(this.SimboliEstratti);this.LongWild.Init();this.SlotFrame.Init();this.SlotLiner.Init();if(this.BonusStage!=null)this.BonusStage.Init();if(this.FreeSpinStage!=null){this.FreeSpinStage.Reset();this.FreeSpinStage.Init()}this.Congratulations.Init();this.PayTable.Init();this.Container.visible=false;this.MainStage.addChild(this.Container);this.DEBUG_LOG("Slot initialized.");if(Slot.DEBUG_SPRITE==1)this.DummyTest_Init()};Slot.prototype.Reset=function(){this.SlotCombo.Reset();this.DefinitiveAnimazioneVincitaCompletata=true};Slot.prototype.Splash=function(){this.ReelHolder.Splash();this.Container.visible=true};Slot.prototype.SpinInit=function(){if(Slot.DEBUG_SPRITE==1)this.DummyTest_SpinInit();else if(Slot.DEBUG_BONUS==1)this.BonusTest_SpinInit();else{this.SlotCombo.ResetWinPattern();this.LongWild.AniClear();this.StepFSM=Slot.ID_FSM_SLOT_1;this.PremutoSTART=false;this.StopPlayingMusicaWin();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.SPIN,SoundGenerator.SMP_VOLUME_NORMAL);this.DEBUG_LOG("Slot spin init.")}};Slot.prototype.SpinRun=function(){if(this.PremutoSTART==false)this.PremutoSTART=this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_START);switch(this.StepFSM){case Slot.ID_FSM_SLOT_0:{}break;case Slot.ID_FSM_SLOT_1:{if(this.FREESPIN_IsRunning()==true){this.FreeSpinStage.SpinStart();this.ApplicationRef.GAMEPROXY().NOTIFY_PLAY_FREESPIN(BonusDescriptor.ID_BONUS_FREESPIN,BonusDescriptor.BS_ACTION_FREESPIN_SPIN)}else{if(this.IsAutoPlay()==true)this.SlotConsoleRef.SetStaticDisplay(this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().ON_AUTOSPIN_MESSAGE()+this.ApplicationRef.PLAYER().AUTO_SPINS_GET(),false);else this.SlotConsoleRef.SetStaticDisplay(this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().ON_SPIN_MESSAGE(),false);this.ApplicationRef.GAMEPROXY().NOTIFY_PLAY_BET()}this.ReelHolder.SpinInit();this.SlotConsoleRef.SetFreezeCounters(true);this.StepFSM=Slot.ID_FSM_SLOT_2;this.DEBUG_LOG("Slot spin run "+this.StepFSM)}break;case Slot.ID_FSM_SLOT_2:{this.ReelHolder.SpinRun(false,false);if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){if(window.CONNECT2SERVER==false){for(var i=0;i<window.NUM_RULLI;i++)this.SimboliEstratti[i]=window.ID_SIMBOLO_0+Lib.Rand(window.NUM_SIMBOLI-1);this.StepFSM=Slot.ID_FSM_SLOT_3}else{this.LongWild.Elabora();this.StepFSM=Slot.ID_FSM_SLOT_4}this.DEBUG_LOG("Slot: Server PlayBet answer received.")}}break;case Slot.ID_FSM_SLOT_3:{this.ReelHolder.ChassisFix();this.ReelHolder.SpinRun(false,false);this.StepFSM=Slot.ID_FSM_SLOT_4;this.DEBUG_LOG("Slot: chassis symbols fixed.")}break;case Slot.ID_FSM_SLOT_4:{this.ReelHolder.SpinRun(this.PremutoSTART,true);if(this.ReelHolder.IsSpinOver()==true){this.DEBUG_LOG("Slot: Spin Over");this.LongWild.SostituzioneSimboli();this.CalcolaValoreVincita();if(this.FREESPIN_IsRunning()==true)this.FreeSpinStage.SpinOver(this.ValoreVincitaAssegnata);this.SlotConsoleRef.SetFreezeCounters(false);this.SlotConsoleRef.UpdateDisplayQueue();this.InizializzaAnimazioneVincita();this.StepFSM=Slot.ID_FSM_SLOT_5}}break;case Slot.ID_FSM_SLOT_5:{this.GestioneAnimazioneVincita();if(this.DefinitiveAnimazioneVincitaCompletata==true){this.OnAnimazioneVincitaCompletata()}else if(this.IsAnimazioneVincitaInterrompibile()==true){this.OnAnimazioneVincitaInterrompibile()}}break;default:break}};Slot.prototype.IsSpinOver=function(){return this.StepFSM==Slot.ID_FSM_SLOT_STOP};Slot.prototype.BET_LINE=function(){return this.Power};Slot.prototype.LINES=function(){return this.Linee};Slot.prototype.SetPower=function(p_Power,p_Lines){this.Power=p_Power;this.Linee=p_Lines};Slot.prototype.TOTAL_BET=function(){return this.Power*this.Linee};Slot.prototype.GetVincitaVideo=function(){return this.VincitaVideo_Coins};Slot.prototype.GetVincitaVideo_Divisa=function(){return this.VincitaVideo_Divisa};Slot.prototype.SetVincitaVideo=function(val){this.VincitaVideo_Coins=val;this.VincitaVideo_Divisa=this.ApplicationRef.PLAYER().Coins2Divisa(this.VincitaVideo_Coins)};Slot.prototype.IncVincitaVideo=function(val){this.VincitaVideo_Coins+=val;this.VincitaVideo_Divisa=this.ApplicationRef.PLAYER().Coins2Divisa(this.VincitaVideo_Coins)};Slot.prototype.GetSimboliEstratti=function(){return this.SimboliEstratti};Slot.prototype.RefreshComponents=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms);this.ID_TIMER_ACCREDITO=this.TimerDec(this.ID_TIMER_ACCREDITO,ellapsed_ms);this.ID_TIMER_WAIT_FOR_ACCREDITO=this.TimerDec(this.ID_TIMER_WAIT_FOR_ACCREDITO,ellapsed_ms);this.SlotStage.Refresh(ellapsed_ms);this.SlotFrame.Refresh(ellapsed_ms);this.ReelHolder.Refresh(ellapsed_ms);this.SlotLiner.Refresh(ellapsed_ms);if(this.FreeSpinStage!=null)this.FreeSpinStage.Refresh(ellapsed_ms);if(this.BonusStage!=null)this.BonusStage.Refresh(ellapsed_ms);if(this.BigWin!=null)this.BigWin.Refresh(ellapsed_ms);if(this.Congratulations!=null)this.Congratulations.Refresh(ellapsed_ms);this.PayTable.Refresh(ellapsed_ms);if(this.LongWild!=null)this.LongWild.AniRefresh(ellapsed_ms);if(Slot.DEBUG_SPRITE==1)this.DummyTest_Refresh(ellapsed_ms);else if(Slot.DEBUG_BONUS==1)this.RunAction()};Slot.prototype.CalcolaValoreVincita=function(){this.ValoreVincitaAssegnata=this.SlotCombo.GetVincitaAssegnata();if(this.REEL_HOLDER().SET_Auto_BreakAtFeature==1&&this.SlotCombo.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_FREESPIN|SlotCombo.MASK_WIN_BONUS_TOPLAY)!=0){this.BreakAutoPlay()}else if(this.REEL_HOLDER().SET_Auto_BreakAtWin==1&&this.ValoreVincitaAssegnata!=0){this.BreakAutoPlay()}};Slot.prototype.FREESPIN_IsRunning=function(){if(this.FreeSpinStage!=null)return this.FreeSpinStage.IsRunning();return false};Slot.prototype.FREESPIN_IsStarted=function(){if(this.FreeSpinStage!=null)return this.FreeSpinStage.IsStarted();return false};Slot.prototype.Notify_EnableAutoPlay=function(){};Slot.prototype.Notify_BreakAutoPlay=function(){if(this.ApplicationRef.PROGRAMMA().GetFaseCorrente()==Program.ID_FASE_AVVIO&&this.ApplicationRef.PLAYER().CREDITI_GET()!=0)this.EnableButtons();else this.DisableButtons()};Slot.prototype.BreakAutoPlay=function(){this.ApplicationRef.PROGRAMMA().GetSPIN_SET().BreakAutoPlay()};Slot.prototype.IsAutoPlay=function(){return this.ApplicationRef.PROGRAMMA().GetSPIN_SET().IsAutoPlay()};Slot.prototype.EnableButtons=function(){this.SlotConsoleRef.Enable()};Slot.prototype.DisableButtons=function(){this.SlotConsoleRef.Disable()};Slot.prototype.InizializzaHelp=function(){this.PayTable.Mount(this.Container)};Slot.prototype.VisualizzaHelp=function(){if(this.PayTable.IsMounted()==false)return 1;return 0};Slot.prototype.IsAnimazioneVincitaRunnable=function(){if(this.ValoreVincitaAssegnata!=0||this.SlotCombo.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_BONUS_TOPLAY)!=0||this.SlotCombo.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_FREESPIN)!=0)return true;return false};Slot.prototype.ReloadAnimazioneVincita=function(){this.DefinitiveAnimazioneVincitaCompletata=false;this.StepAnimazione=8};Slot.prototype.InizializzaAnimazioneVincita=function(){this.StepAnimazione=0;this.AccreditoVincita_ACK=false;this.PremutoSTART=false;if(this.IsAnimazioneVincitaRunnable()==true){this.ReelHolder.InizializzaAnimazioneVincita();this.DefinitiveAnimazioneVincitaCompletata=false}else{if(this.FREESPIN_IsRunning()==true)this.DefinitiveAnimazioneVincitaCompletata=false;else this.DefinitiveAnimazioneVincitaCompletata=true}};Slot.prototype.GestioneAnimazioneVincita=function(){var i,j,time;if(this.DefinitiveAnimazioneVincitaCompletata==true)return;switch(this.StepAnimazione){case 0:{this.OnInitAnimazioneVincita()}break;case 1:{this.OnPreAnimazioneVincita()}break;case 2:{if(this.GPTimer==0)this.DefinitiveAnimazioneVincitaCompletata=true}break;case 7:{this.InitAccreditoVincita();if(this.ValoreVincitaAssegnata!=0||this.FREESPIN_IsRunning()==true||this.SlotCombo.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_BONUS_TOPLAY|SlotCombo.MASK_WIN_FREESPIN)!=0){this.StepAnimazione=8}else{this.ReelHolder.TerminaAnimazioneVincita();this.StepAnimazione=13}}break;case 8:{this.ReelHolder.GestioneAnimazioneVincita();if(this.ReelHolder.IsAnimazioneVincitaInterrompibile()==true||this.PremutoSTART==true){this.PremutoSTART=false;this.StepAnimazione=15;if(this.FREESPIN_IsRunning()==true){this.StepAnimazione=9}}}break;case 9:{this.FreeSpinStage.SimboliMagici_Init();if(this.FreeSpinStage.SimboliMagici_Play()==true){this.StepAnimazione=10}else{this.StepAnimazione=14}}break;case 10:{if(this.FreeSpinStage.SimboliMagici_Play()==false){this.ValoreVincitaAssegnata=this.SlotCombo.GetVincitaAssegnata();this.SlotConsoleRef.UpdateDisplayQueue();if(this.ValoreVincitaAssegnata!=0){this.ReelHolder.InizializzaAnimazioneVincita();this.StepAnimazione=11}else this.StepAnimazione=14}}break;case 11:{this.ReelHolder.GestioneAnimazioneVincita();if(this.ReelHolder.IsAnimazioneVincitaInterrompibile()==true){this.StepAnimazione=14}else if(this.PremutoSTART==true){this.ReelHolder.TerminaAnimazioneVincita();this.StepAnimazione=14}}break;case 14:{this.FreeSpinStage.SpinOver(this.ValoreVincitaAssegnata);this.StepAnimazione=15}break;default:{this.ReelHolder.GestioneAnimazioneVincita()}break}if(this.AccreditoVincita()==0){if(this.ReelHolder.IsAnimazioneVincitaInterrompibile()==true){this.OnAccreditoVincitaCompletato()}}};Slot.prototype.TerminaAnimazioneVincita=function(){this.ReelHolder.TerminaAnimazioneVincita();this.SlotCombo.MaskEventoVincita=0;this.DefinitiveAnimazioneVincitaCompletata=true};Slot.prototype.IsAnimazioneVincitaInterrompibile=function(){return this.ReelHolder.IsAnimazioneVincitaInterrompibile()&&(this.DefinitiveAnimazioneVincitaCompletata==true||this.StepAnimazione>=15)};Slot.prototype.ActionPending=function(){if(this.BonusStage!=null){if(this.BonusStage.ActionPending()==true)return true}if(this.FreeSpinStage!=null){if(this.FreeSpinStage.ActionPending()==true)return true}return false};Slot.prototype.RunAction=function(){if(this.FreeSpinStage!=null){if(this.FreeSpinStage.ActionPending()==true){this.FreeSpinStage.RunAction();return}}if(this.BonusStage!=null){if(this.BonusStage.ActionPending()==true){this.BonusStage.RunAction();return}}};Slot.prototype.PlayMusic=function(){this.SlotStage.PlayMusic()};Slot.prototype.OnInitAnimazioneVincita=function(){if(this.FREESPIN_IsRunning()==true){this.StepAnimazione=7}else if(this.LongWild!=null){
if(this.LongWild.get_STATO()==LongWild.WILD_STAT_INNESCATA){this.LongWild.AniStart();this.StepAnimazione=1}else{this.StepAnimazione=7}}else this.StepAnimazione=7};Slot.prototype.OnPreAnimazioneVincita=function(){if(this.LongWild!=null){this.LongWild.AniRun();if(this.LongWild.IntroRunning()==false)this.StepAnimazione=7}};Slot.prototype.OnAccreditoVincitaCompletato=function(){};Slot.prototype.OnAnimazioneVincitaInterrompibile=function(){this.StepFSM=Slot.ID_FSM_SLOT_STOP};Slot.prototype.OnAnimazioneVincitaCompletata=function(){this.StepFSM=Slot.ID_FSM_SLOT_STOP};Slot.prototype.InitAccreditoVincita=function(){this.SetVincitaVideo(0);if(this.ValoreVincitaAssegnata!=0||this.SlotCombo.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_BONUS_TOPLAY|SlotCombo.MASK_WIN_FREESPIN)!=0){this.StepAccredito=this.ValoreVincitaAssegnata;this.ID_TIMER_WAIT_FOR_ACCREDITO=this.ArmaTimer(this.ID_TIMER_WAIT_FOR_ACCREDITO,this.GetDurataMusicaWin());this.ID_TIMER_ACCREDITO=0}this.AccreditoVincita_ACK=true};Slot.prototype.AccreditoVincita=function(){if(this.AccreditoVincita_ACK==false)return 1;if(this.GetVincitaVideo()<this.ValoreVincitaAssegnata){if(this.ID_TIMER_WAIT_FOR_ACCREDITO==0){if(this.ID_TIMER_ACCREDITO==0){this.IncVincitaVideo(this.StepAccredito);if(this.GetVincitaVideo()>=this.ValoreVincitaAssegnata){this.SetVincitaVideo(this.ValoreVincitaAssegnata);this.ValoreVincitaAssegnata=0}this.ID_TIMER_ACCREDITO=this.ArmaTimer(this.ID_TIMER_ACCREDITO,10)}}return 1}return 0};Slot.prototype.IsPlayingMusicaWin=function(){if(this.ApplicationRef.SOUNDGENERATOR().IsPlaying(SoundGenerator.WIN_HI)==true)return true;if(this.ApplicationRef.SOUNDGENERATOR().IsPlaying(SoundGenerator.WIN_MID)==true)return true;if(this.ApplicationRef.SOUNDGENERATOR().IsPlaying(SoundGenerator.WIN_LO)==true)return true;return false};Slot.prototype.GetSampleMusicaWin=function(){if(this.SlotCombo.MaskEventoVincita_CHECK(SlotCombo.MASK_WIN_BONUS_TOPLAY)!=0)return SoundGenerator.WIN_BONUS;if(this.ValoreVincitaAssegnata>=100*this.BET_LINE())return SoundGenerator.WIN_HI;if(this.ValoreVincitaAssegnata>=10*this.BET_LINE())return SoundGenerator.WIN_MID;return SoundGenerator.WIN_LO};Slot.prototype.StopPlayingMusicaWin=function(){this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.WIN_HI);this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.WIN_MID);this.ApplicationRef.SOUNDGENERATOR().StopChannelByBrano(SoundGenerator.WIN_LO)};Slot.prototype.GetDurataMusicaWin=function(){return 0};Slot.prototype.Parse_REEL_STATUS=function(chunk_to_parse){var esito=false;var i=0;if(this.ParseServer_Init(chunk_to_parse)==true){for(i=0,esito=true;i<window.NUM_RULLI;i++){this.SimboliEstratti[i]=this.ParseServer_Dump_UINT(-1);if(this.SimboliEstratti[i]>window.NUM_SIMBOLI){esito=false;break}}if(esito==true){this.ReelHolder.ChassisFix();this.Initialized=true}}return esito};Slot.prototype.Parse_BONUS_STATUS=function(chunk_to_parse){var esito=false;if(this.ParseServer_Init(chunk_to_parse)==true){var bonus_type=this.ParseServer_Dump_UINT(-1);if(bonus_type==BonusDescriptor.ID_BONUS_PICK)esito=this.BonusStage.Parse_BONUS_STATUS(chunk_to_parse);else if(bonus_type==BonusDescriptor.ID_BONUS_FREESPIN)esito=this.FreeSpinStage.Parse_FREESPIN_STATUS(chunk_to_parse);else esito=false}return esito};Slot.prototype.TrembleInit=function(max_x,max_y,count){this.CountFX=count;this.FX_x=0;this.FX_y=0;this.FX_max_x=max_x;this.FX_max_y=max_y};Slot.prototype.TrembleOver=function(){var rnd;if(this.CountFX==0)return true;if(this.FX_x==0&&this.FX_y==0){this.FX_x=this.FX_max_x;this.FX_y=this.FX_max_y;rnd=Lib.Rand(2);if(rnd==0)this.FX_x*=-1;else this.FX_x*=1;rnd=Lib.Rand(2);if(rnd==0)this.FX_y*=-1;else this.FX_y*=1;this.Container.x+=this.FX_x;this.Container.y+=this.FX_y}else{this.FX_x*=-1;this.FX_y*=-1;this.Container.x+=this.FX_x;this.Container.y+=this.FX_y;this.FX_x=0;this.FX_y=0;if(this.FX_max_x>=2)this.FX_max_x-=2;if(this.FX_max_y>=2)this.FX_max_y-=2;this.CountFX--}return false};Slot.prototype.BonusTest_SpinInit=function(){this.BonusStage.Parse_BONUS_ACTIVATE(BonusDescriptor.ID_BONUS_PICK)};Slot.prototype.DummyTest_Init=function(){};Slot.prototype.DummyTest_SpinInit=function(){};Slot.prototype.DummyTest_Refresh=function(ellapsed_ms){};Slot.prototype.REEL_STAGE=function(){return this.SlotStage};Slot.prototype.FREESPIN=function(){return this.FreeSpinStage};Slot.prototype.REEL_FRAME=function(){return this.SlotFrame};Slot.prototype.CONTAINER=function(){return this.Container};Slot.prototype.CONSOLE=function(){return this.SlotConsoleRef};Slot.prototype.SLOT_COMBO=function(){return this.SlotCombo};Slot.prototype.REEL_HOLDER=function(){return this.ReelHolder};Slot.prototype.REEL=function(id_reel){return this.ReelHolder.GetRullo(id_reel)};Slot.prototype.LINER=function(){return this.SlotLiner};Slot.prototype.BIG_WIN=function(){return this.BigWin};Slot.prototype.CONGRATULATIONS=function(){return this.Congratulations};Slot.prototype.BONUSSTAGE=function(){return this.BonusStage};Slot.prototype.PAYTABLE=function(){return this.PayTable};Slot.prototype.SLOT_WILD=function(){return this.LongWild};ProgramState.STEP_FASE_INIT=0;ProgramState.STEP_FASE_BODY=1;ProgramState.STEP_FASE_EXIT=2;ProgramState.ID_SOTTOSTEP_0=0;ProgramState.ID_SOTTOSTEP_1=1;ProgramState.ID_SOTTOSTEP_2=2;ProgramState.ID_SOTTOSTEP_3=3;ProgramState.ID_SOTTOSTEP_4=4;ProgramState.ID_SOTTOSTEP_5=5;ProgramState.ID_SOTTOSTEP_6=6;ProgramState.ID_SOTTOSTEP_7=7;ProgramState.ID_SOTTOSTEP_8=8;ProgramState.ID_SOTTOSTEP_9=9;ProgramState.ID_SOTTOSTEP_10=10;function ProgramState(app_reference,slot_ref){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=this.ApplicationRef.MainStage;this.MainRenderer=this.ApplicationRef.Renderer;this.SlotReference=slot_ref;this.PopUp=null;this.Step=ProgramState.STEP_FASE_INIT;this.SottoStep=0;this.FaseConclusa=true;this.BackGround=new PIXI.Graphics;this.BackGround.beginFill(0,.7);this.BackGround.drawRect(0,0,window.VIDEO_WIDTH,window.VIDEO_HEIGHT);this.BackGround.endFill()}ProgramState.prototype=Object.create(SObject.prototype);ProgramState.prototype.constructor=ProgramState;ProgramState.prototype.Restart=function(){this.Step=ProgramState.STEP_FASE_INIT;this.SottoStep=0;this.FaseConclusa=false};ProgramState.prototype.Reset=function(){this.Restart();this.FaseConclusa=true};ProgramState.prototype.IsFaseConclusa=function(){return this.FaseConclusa};ProgramState.prototype.Init=function(){if(this.PopUp==null){this.PopUp=new DialogBox(this.ApplicationRef,this.MainStage);this.PopUp.Init()}this.StateInit()};ProgramState.prototype.StateInit=function(){this.Restart();this.Step=ProgramState.STEP_FASE_BODY;this.DEBUG_LOG("Program state init")};ProgramState.prototype.Body=function(ellapsed_ms){this.StateBody(ellapsed_ms)};ProgramState.prototype.StateBody=function(ellapsed_ms){this.TimerRefresh(ellapsed_ms)};ProgramState.prototype.Exit=function(){this.StateExit()};ProgramState.prototype.StateExit=function(){this.FaseConclusa=true};ProgramState.prototype.Run=function(ellapsed_ms){if(this.IsFaseConclusa()==true)return;switch(this.Step){case ProgramState.STEP_FASE_INIT:{this.Init()}break;case ProgramState.STEP_FASE_BODY:{this.Body(ellapsed_ms)}break;case ProgramState.STEP_FASE_EXIT:{this.Exit()}break;default:break}};ProgramState.prototype.PopUp_Render=function(popup_message,modal){this.PopUp.Render(popup_message,modal)};ProgramState.prototype.PopUp_Mount=function(){if(this.MainStage.children.indexOf(this.BackGround)==-1)this.MainStage.addChild(this.BackGround);this.PopUp.Mount()};ProgramState.prototype.PopUp_Refresh=function(){return this.PopUp.Refresh()};ProgramState.prototype.PopUp_Unmount=function(){if(this.MainStage.children.indexOf(this.BackGround)!=-1)this.MainStage.removeChild(this.BackGround);this.PopUp.Unmount()};function StateBoot(app_reference,slot_ref){ProgramState.call(this,app_reference,slot_ref);this.Setup=true;this.Loading=true}StateBoot.prototype=Object.create(ProgramState.prototype);StateBoot.prototype.constructor=StateBoot;StateBoot.prototype.StateInit=function(){ProgramState.prototype.StateInit.call(this);this.DEBUG_LOG("- Boot state - init")};StateBoot.prototype.StateBody=function(ellapsed_ms){ProgramState.prototype.StateBody.call(this,ellapsed_ms);if(this.ApplicationRef.GAMEPROXY().IsIdle()==true)this.Step=ProgramState.STEP_FASE_EXIT};StateBoot.prototype.StateExit=function(){ProgramState.prototype.StateExit.call(this)};function StateGameOver(app_reference,slot_ref){ProgramState.call(this,app_reference,slot_ref)}StateGameOver.prototype=Object.create(ProgramState.prototype);StateGameOver.prototype.constructor=StateGameOver;StateGameOver.prototype.StateInit=function(){ProgramState.prototype.StateInit.call(this);this.DEBUG_LOG("- GameOver state - init")};StateGameOver.prototype.StateBody=function(ellapsed_ms){ProgramState.prototype.StateBody.call(this,ellapsed_ms);this.SlotReference.Splash();this.Step=ProgramState.STEP_FASE_EXIT};StateGameOver.prototype.StateExit=function(){ProgramState.prototype.StateExit.call(this)};function StateSpinSet(app_reference,slot_ref){ProgramState.call(this,app_reference,slot_ref);this.OldBet=0;this.OldLines=0;this.BetPerLinea=0;this.Lines=0;this.LinesRequest=0;this.BetTarget=0;this.LinesTarget=0;this.CurrentLine=0;this.ID_TIMER_POLL_CREDITS=0;this.BetSet=false;this.AutoPlay=false}StateSpinSet.prototype=Object.create(ProgramState.prototype);StateSpinSet.prototype.constructor=StateSpinSet;StateSpinSet.prototype.Reset=function(){ProgramState.prototype.Reset.call(this);this.ResetBet();this.Lines=window.DEFAULT_LINES;this.OldBet=DEFAULT_LINES.DEFAULT_LINES;this.OldLines=DEFAULT_LINES.DEFAULT_LINES};StateSpinSet.prototype.StateInit=function(){ProgramState.prototype.StateInit.call(this);this.BetSet=false;this.LinesRequest=255;this.SlotReference.GestioneAnimazioneVincita();this.DEBUG_LOG("- Spin Set - state init")};StateSpinSet.prototype.StateBody=function(ellapsed_ms){ProgramState.prototype.StateBody.call(this,ellapsed_ms);this.ID_TIMER_POLL_CREDITS=this.TimerDec(this.ID_TIMER_POLL_CREDITS,ellapsed_ms);this.SlotReference.GestioneAnimazioneVincita();if(this.SlotReference.ActionPending()==true){this.SlotReference.RunAction()}else{switch(this.SottoStep){case ProgramState.ID_SOTTOSTEP_0:{this.SottoStep_0()}break;case ProgramState.ID_SOTTOSTEP_1:{this.SottoStep_1()}break;case ProgramState.ID_SOTTOSTEP_2:{this.SottoStep_2()}break;case ProgramState.ID_SOTTOSTEP_3:{this.SottoStep_3()}break;case ProgramState.ID_SOTTOSTEP_4:{this.SottoStep_4()}break;case ProgramState.ID_SOTTOSTEP_5:{this.SottoStep_5()}break;case ProgramState.ID_SOTTOSTEP_6:{this.SottoStep_6()}break;case ProgramState.ID_SOTTOSTEP_7:{this.SottoStep_7()}break;case ProgramState.ID_SOTTOSTEP_8:{this.SottoStep_8()}break;default:break}}};StateSpinSet.prototype.StateExit=function(){ProgramState.prototype.StateExit.call(this);this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.CONSOLE().SpinSet(false);if(this.RichiestaGameOver==true){this.ApplicationRef.SOUNDGENERATOR().Stop()}};StateSpinSet.prototype.ResetBet=function(){this.BetPerLinea=1;this.Lines=1};StateSpinSet.prototype.Recover=function(){var bet,lines;bet=this.ApplicationRef.PLAYER().BET_LINE();lines=this.ApplicationRef.PLAYER().LINES();this.BetPerLinea=bet;this.Lines=lines;this.OldLines=lines;this.OldBet=lines*bet;this.SlotReference.SetPower(bet,lines)};StateSpinSet.prototype.SottoStep_0=function(){if(this.AutoPlay==true){if(this.ApplicationRef.PLAYER().AUTO_SPINS_GET()==0)this.BreakAutoPlay()}if(this.SlotReference.FREESPIN_IsRunning()==true)this.GPTimer=this.ArmaTimer(this.GPTimer,1e3);this.ApplicationRef.CONSOLE().SpinSet(true);this.SottoStep++};StateSpinSet.prototype.SottoStep_1=function(){if(this.SlotReference.FREESPIN_IsRunning()==true){if(this.SlotReference.REEL_HOLDER().IsAnimazioneVincitaInterrompibile()==true){this.SottoStep=ProgramState.ID_SOTTOSTEP_5}return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_DEMO_FEATURE_1)==true){this.ApplicationRef.GAMEPROXY().DEMO_FEATURE_SET(1);this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_DEMO_FEATURE_2)==true){this.ApplicationRef.GAMEPROXY().DEMO_FEATURE_SET(2);this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_DEMO_FEATURE_3)==true){this.ApplicationRef.GAMEPROXY().DEMO_FEATURE_SET(3);this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_EXIT)==true){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.PopUp_Render(this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().ON_EXIT_MESSAGE(),DialogBox.DIALOG_MODAL_OK_CANCEL);this.PopUp_Mount();this.SottoStep=ProgramState.ID_SOTTOSTEP_7;return}}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_HELP)==true){this.SaveOldBet();this.SlotReference.InizializzaHelp();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.SottoStep=ProgramState.ID_SOTTOSTEP_2;return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_START)==true||this.IsAutoPlay()==true||this.SlotReference.FREESPIN_IsRunning()==true&&this.GPTimer==0){if(this.BetSet==false){if(this.SlotReference.FREESPIN_IsRunning()==false){this.ResetBet();this.Lines=this.OldLines;this.BetPerLinea=this.OldBet/this.OldLines;this.ApplicaIncrementoBet(this.OldBet)}}this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_ALLBET_INC)==true){if(this.IncBet_Enabled()==true)this.IncBet();else if(this.ApplicationRef.PLAYER().COIN_VALUE_INC_ENABLED()==true)this.ApplicationRef.PLAYER().COIN_VALUE_INC();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_ALLBET_DEC)==true){if(this.DecBet_Enabled()==true)this.DecBet();else if(this.ApplicationRef.PLAYER().COIN_VALUE_DEC_ENABLED()==true)this.ApplicationRef.PLAYER().COIN_VALUE_DEC();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_BET_INC)==true){this.IncBet();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_BET_DEC)==true){this.DecBet();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_LINES_INC)==true){this.IncLines();this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET_LINES,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_LINES_DEC)==true){this.DecLines();this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET_LINES);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_MAXBET)==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.MAX_BET,SoundGenerator.SMP_VOLUME_NORMAL);this.SlotReference.TerminaAnimazioneVincita();this.SetMaxBet();this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_COINLEVEL_INC)==true){this.ApplicationRef.PLAYER().COIN_VALUE_INC();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK1,SoundGenerator.SMP_VOLUME_NORMAL)}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_COINLEVEL_DEC)==true){this.ApplicationRef.PLAYER().COIN_VALUE_DEC();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK1,SoundGenerator.SMP_VOLUME_NORMAL)}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_AUTO)==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK2,SoundGenerator.SMP_VOLUME_NORMAL);if(this.AutoPlay==false){this.ApplicationRef.PLAYER().AUTO_SPINS_INC()}else this.BreakAutoPlay()}else if(this.LinesRequest!=255){this.SetLinesByClick();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET_LINES,SoundGenerator.SMP_VOLUME_NORMAL);this.LinesRequest=255}if(this.ID_TIMER_POLL_CREDITS==0){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.ApplicationRef.GAMEPROXY().CMD_CREDIT_STATUS();this.SottoStep=ProgramState.ID_SOTTOSTEP_3}}};StateSpinSet.prototype.SottoStep_2=function(){if(this.SlotReference.VisualizzaHelp()==1)this.Step=ProgramState.STEP_FASE_INIT};StateSpinSet.prototype.SottoStep_3=function(){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.ID_TIMER_POLL_CREDITS=3*1e3;this.SottoStep=ProgramState.ID_SOTTOSTEP_1}};StateSpinSet.prototype.SottoStep_4=function(){if(this.GPTimer==0)this.SottoStep=ProgramState.ID_SOTTOSTEP_5};StateSpinSet.prototype.SottoStep_5=function(){this.DEBUG_LOG("SpinSet - Step 5");if(this.ApplicationRef.PLAYER().COINS_PLAYABLES(this.GetBet())==false&&this.SlotReference.FREESPIN_IsRunning()==false&&this.ApplicationRef.GAMEPROXY().DEMO_FEATURE_GET()==-1){this.BreakAutoPlay();this.SaveOldBet();this.ApplicationRef.GAMEPROXY().CMD_USER_BET_VALIDATE(this.GetBet());this.SottoStep=ProgramState.ID_SOTTOSTEP_6}else{this.PreparaAvvioPartita();this.Step=ProgramState.STEP_FASE_EXIT}};StateSpinSet.prototype.SottoStep_6=function(){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){if(this.ApplicationRef.PROGRAMMA().GetVERSAMENTO_CASSA().ActionPending()==true)this.Step=ProgramState.STEP_FASE_INIT;else this.SottoStep=ProgramState.ID_SOTTOSTEP_5}};StateSpinSet.prototype.SottoStep_7=function(){var dlg;if((dlg=this.PopUp_Refresh())!=DialogBox.DIALOG_EXIT_NONE){this.PopUp_Unmount();if(dlg==DialogBox.DIALOG_EXIT_OK){this.ApplicationRef.GAMEPROXY().CMD_LOGOUT();this.SottoStep++}else this.Step=ProgramState.STEP_FASE_INIT}};StateSpinSet.prototype.SottoStep_8=function(){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.Step=ProgramState.STEP_FASE_INIT}};StateSpinSet.prototype.IncBet_Enabled=function(){if(this.IsBetOverflow(this.Lines,false)==false)return true;return false};StateSpinSet.prototype.DecBet_Enabled=function(){return this.BetPerLinea>1};StateSpinSet.prototype.IncBet=function(){var temp;if(this.IsBetOverflow(this.Lines,false)==false){this.BetPerLinea++;this.ApplicaIncrementoBet(this.Lines)}};StateSpinSet.prototype.DecBet=function(){if(this.BetPerLinea>1){this.BetPerLinea--;this.ApplicaIncrementoBet(this.Lines)}};StateSpinSet.prototype.IncLines=function(){var temp;if(this.IsBetOverflow(this.BetPerLinea,true)==false){this.Lines++;this.ApplicaIncrementoBet(this.BetPerLinea)}else{temp=this.BetPerLinea;this.ResetBet();this.BetPerLinea=temp;this.ApplicaIncrementoBet(this.Lines)}};StateSpinSet.prototype.DecLines=function(){if(this.Lines>1){this.Lines--;this.ApplicaIncrementoBet(this.BetPerLinea)}};StateSpinSet.prototype.SetMaxBet=function(){var bet_linea;this.BetTarget=window.MAX_TOT_BET;this.LinesTarget=window.NUM_LINEE;bet_linea=window.MAX_BET;while(this.BetTarget>this.ApplicationRef.PLAYER().CREDITI_GET()&&bet_linea>1){this.BetTarget-=window.NUM_LINEE;bet_linea--}this.Lines=this.LinesTarget;this.BetPerLinea=bet_linea;this.ApplicaIncrementoBet(this.BetTarget)};StateSpinSet.prototype.IsBetOverflow=function(p_IncBet,p_Lines){var l_OverflowLines=false;var temp;if(p_Lines==true){if(this.Lines>=window.NUM_LINEE)l_OverflowLines=true}else{if(this.Lines!=0&&l_OverflowLines==false){temp=parseInt(p_IncBet/this.Lines);if(this.BetPerLinea+temp>window.MAX_BET){return true}}}if(this.GetBet()+p_IncBet>window.MAX_TOT_BET||l_OverflowLines){return true}return false};StateSpinSet.prototype.ApplicaIncrementoBet=function(p_Incremento){this.SlotReference.SetPower(this.BetPerLinea,this.Lines)};StateSpinSet.prototype.SaveOldBet=function(){this.OldBet=this.GetBet();this.OldLines=this.Lines};StateSpinSet.prototype.SetOldBet=function(){var l_Temp;if(this.OldBet!=0){l_Temp=this.OldBet;if(this.OldBet>window.MAX_TOT_BET)this.OldBet=window.MAX_TOT_BET;if(this.ApplicationRef.PLAYER().CREDITI_GET()<this.OldBet)this.OldBet=this.ApplicationRef.PLAYER().CREDITI_GET();if(this.OldBet==l_Temp){this.ResetBet();this.Lines=this.OldLines;this.BetPerLinea=this.OldBet/this.OldLines;this.ApplicaIncrementoBet(this.OldBet)}else{this.RicalcolaBet(this.OldBet);return false}}return true};StateSpinSet.prototype.RicalcolaBet=function(p_BetTarget){this.Lines=0;this.BetPerLinea=1;this.BetTarget=p_BetTarget;if(this.OldLines>this.BetTarget)this.LinesTarget=this.BetTarget;else this.LinesTarget=this.OldLines;this.CurrentLine=0};StateSpinSet.prototype.GetBet=function(){return this.Lines*this.BetPerLinea};StateSpinSet.prototype.CheckBreakAutoPlay=function(){if(this.AutoPlay==true){if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_AUTO)==true){this.BreakAutoPlay()}}};StateSpinSet.prototype.IsAutoPlay=function(){return this.AutoPlay};StateSpinSet.prototype.BreakAutoPlay=function(){this.AutoPlay=false;this.SlotReference.Notify_BreakAutoPlay();this.ApplicationRef.PLAYER().AUTO_SPINS_SET(0)};StateSpinSet.prototype.EnableAutoPlay=function(){this.AutoPlay=true;this.SlotReference.Notify_EnableAutoPlay()};StateSpinSet.prototype.PreparaAvvioPartita=function(){if(this.SlotReference.FREESPIN_IsRunning()==false){this.ApplicationRef.PLAYER().COINS_PLAYED(this.GetBet());if(this.ApplicationRef.PLAYER().AUTO_SPINS_GET()!=0){this.EnableAutoPlay();this.ApplicationRef.PLAYER().AUTO_SPINS_DEC()}}this.SlotReference.SetVincitaVideo(0);this.SlotReference.TerminaAnimazioneVincita();this.SaveOldBet();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.SPIN,SoundGenerator.SMP_VOLUME_REDUCE)};StateSpinSet.prototype.SetLinesByClick=function(){var temp;temp=this.BetPerLinea;this.ResetBet();this.BetPerLinea=temp;this.Lines=0;while(this.IsBetOverflow(this.BetPerLinea,true)==false){this.Lines++;this.ApplicaIncrementoBet(this.BetPerLinea);if(this.Lines==this.LinesRequest)break}this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true};StateSpinSet.prototype.NotifyClickOnLine=function(p_Line){this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL)};function StateSpinRun(app_reference,slot_ref){ProgramState.call(this,app_reference,slot_ref)}StateSpinRun.prototype=Object.create(ProgramState.prototype);StateSpinRun.prototype.constructor=StateSpinRun;StateSpinRun.prototype.StateInit=function(){ProgramState.prototype.StateInit.call(this);this.DEBUG_LOG("- Spin Run - state init")};StateSpinRun.prototype.StateBody=function(ellapsed_ms){ProgramState.prototype.StateBody.call(this,ellapsed_ms);switch(this.SottoStep){case ProgramState.ID_SOTTOSTEP_0:{this.SlotReference.SpinInit();this.SottoStep++}break;case ProgramState.ID_SOTTOSTEP_1:{this.SlotReference.SpinRun();if(this.SlotReference.IsSpinOver()==true){this.Step=ProgramState.STEP_FASE_EXIT}}break;default:break}};StateSpinRun.prototype.StateExit=function(){ProgramState.prototype.StateExit.call(this)};function StateSpinSet(app_reference,slot_ref){ProgramState.call(this,app_reference,slot_ref);this.OldBet=0;this.OldLines=0;this.BetPerLinea=0;this.Lines=0;this.LinesRequest=0;this.BetTarget=0;this.LinesTarget=0;this.CurrentLine=0;this.ID_TIMER_POLL_CREDITS=0;this.BetSet=false;this.AutoPlay=false}StateSpinSet.prototype=Object.create(ProgramState.prototype);StateSpinSet.prototype.constructor=StateSpinSet;StateSpinSet.prototype.Reset=function(){ProgramState.prototype.Reset.call(this);this.ResetBet();this.Lines=window.DEFAULT_LINES;this.OldBet=DEFAULT_LINES.DEFAULT_LINES;this.OldLines=DEFAULT_LINES.DEFAULT_LINES};StateSpinSet.prototype.StateInit=function(){ProgramState.prototype.StateInit.call(this);this.BetSet=false;this.LinesRequest=255;this.SlotReference.GestioneAnimazioneVincita();this.DEBUG_LOG("- Spin Set - state init")};StateSpinSet.prototype.StateBody=function(ellapsed_ms){ProgramState.prototype.StateBody.call(this,ellapsed_ms);this.ID_TIMER_POLL_CREDITS=this.TimerDec(this.ID_TIMER_POLL_CREDITS,ellapsed_ms);this.SlotReference.GestioneAnimazioneVincita();if(this.SlotReference.ActionPending()==true){this.SlotReference.RunAction()}else{switch(this.SottoStep){case ProgramState.ID_SOTTOSTEP_0:{this.SottoStep_0()}break;case ProgramState.ID_SOTTOSTEP_1:{this.SottoStep_1()}break;case ProgramState.ID_SOTTOSTEP_2:{this.SottoStep_2()}break;case ProgramState.ID_SOTTOSTEP_3:{this.SottoStep_3()}break;case ProgramState.ID_SOTTOSTEP_4:{this.SottoStep_4()}break;case ProgramState.ID_SOTTOSTEP_5:{this.SottoStep_5()}break;case ProgramState.ID_SOTTOSTEP_6:{this.SottoStep_6()}break;case ProgramState.ID_SOTTOSTEP_7:{this.SottoStep_7()}break;case ProgramState.ID_SOTTOSTEP_8:{this.SottoStep_8()}break;default:break}}};StateSpinSet.prototype.StateExit=function(){ProgramState.prototype.StateExit.call(this);this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.CONSOLE().SpinSet(false);if(this.RichiestaGameOver==true){this.ApplicationRef.SOUNDGENERATOR().Stop()}};StateSpinSet.prototype.ResetBet=function(){this.BetPerLinea=1;this.Lines=1};StateSpinSet.prototype.Recover=function(){var bet,lines;bet=this.ApplicationRef.PLAYER().BET_LINE();lines=this.ApplicationRef.PLAYER().LINES();this.BetPerLinea=bet;this.Lines=lines;this.OldLines=lines;this.OldBet=lines*bet;this.SlotReference.SetPower(bet,lines)};StateSpinSet.prototype.SottoStep_0=function(){if(this.AutoPlay==true){if(this.ApplicationRef.PLAYER().AUTO_SPINS_GET()==0)this.BreakAutoPlay()}if(this.SlotReference.FREESPIN_IsRunning()==true)this.GPTimer=this.ArmaTimer(this.GPTimer,1e3);this.ApplicationRef.CONSOLE().SpinSet(true);this.SottoStep++};StateSpinSet.prototype.SottoStep_1=function(){if(this.SlotReference.FREESPIN_IsRunning()==true){if(this.SlotReference.REEL_HOLDER().IsAnimazioneVincitaInterrompibile()==true){this.SottoStep=ProgramState.ID_SOTTOSTEP_5}return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_DEMO_FEATURE_1)==true){this.ApplicationRef.GAMEPROXY().DEMO_FEATURE_SET(1);this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_DEMO_FEATURE_2)==true){this.ApplicationRef.GAMEPROXY().DEMO_FEATURE_SET(2);this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_DEMO_FEATURE_3)==true){this.ApplicationRef.GAMEPROXY().DEMO_FEATURE_SET(3);this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_EXIT)==true){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.PopUp_Render(this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().ON_EXIT_MESSAGE(),DialogBox.DIALOG_MODAL_OK_CANCEL);this.PopUp_Mount();this.SottoStep=ProgramState.ID_SOTTOSTEP_7;return}}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_HELP)==true){this.SaveOldBet();this.SlotReference.InizializzaHelp();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK0,SoundGenerator.SMP_VOLUME_NORMAL);this.SottoStep=ProgramState.ID_SOTTOSTEP_2;return}if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_START)==true||this.IsAutoPlay()==true||this.SlotReference.FREESPIN_IsRunning()==true&&this.GPTimer==0){if(this.BetSet==false){if(this.SlotReference.FREESPIN_IsRunning()==false){this.ResetBet();this.Lines=this.OldLines;this.BetPerLinea=this.OldBet/this.OldLines;this.ApplicaIncrementoBet(this.OldBet)}}this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_ALLBET_INC)==true){if(this.IncBet_Enabled()==true)this.IncBet();else if(this.ApplicationRef.PLAYER().COIN_VALUE_INC_ENABLED()==true)this.ApplicationRef.PLAYER().COIN_VALUE_INC();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_ALLBET_DEC)==true){if(this.DecBet_Enabled()==true)this.DecBet();else if(this.ApplicationRef.PLAYER().COIN_VALUE_DEC_ENABLED()==true)this.ApplicationRef.PLAYER().COIN_VALUE_DEC();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_BET_INC)==true){this.IncBet();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_BET_DEC)==true){this.DecBet();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_LINES_INC)==true){this.IncLines();this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET_LINES,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_LINES_DEC)==true){this.DecLines();this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET_LINES);this.BetSet=true}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_MAXBET)==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.MAX_BET,SoundGenerator.SMP_VOLUME_NORMAL);this.SlotReference.TerminaAnimazioneVincita();this.SetMaxBet();this.SottoStep=ProgramState.ID_SOTTOSTEP_5;return}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_COINLEVEL_INC)==true){this.ApplicationRef.PLAYER().COIN_VALUE_INC();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK1,SoundGenerator.SMP_VOLUME_NORMAL)}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_COINLEVEL_DEC)==true){this.ApplicationRef.PLAYER().COIN_VALUE_DEC();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK1,SoundGenerator.SMP_VOLUME_NORMAL)}else if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_AUTO)==true){this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.CLICK2,SoundGenerator.SMP_VOLUME_NORMAL);if(this.AutoPlay==false){this.ApplicationRef.PLAYER().AUTO_SPINS_INC()}else this.BreakAutoPlay()}else if(this.LinesRequest!=255){this.SetLinesByClick();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET_LINES,SoundGenerator.SMP_VOLUME_NORMAL);this.LinesRequest=255}if(this.ID_TIMER_POLL_CREDITS==0){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.ApplicationRef.GAMEPROXY().CMD_CREDIT_STATUS();this.SottoStep=ProgramState.ID_SOTTOSTEP_3}}};StateSpinSet.prototype.SottoStep_2=function(){if(this.SlotReference.VisualizzaHelp()==1)this.Step=ProgramState.STEP_FASE_INIT};StateSpinSet.prototype.SottoStep_3=function(){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.ID_TIMER_POLL_CREDITS=3*1e3;this.SottoStep=ProgramState.ID_SOTTOSTEP_1}};StateSpinSet.prototype.SottoStep_4=function(){if(this.GPTimer==0)this.SottoStep=ProgramState.ID_SOTTOSTEP_5};StateSpinSet.prototype.SottoStep_5=function(){this.DEBUG_LOG("SpinSet - Step 5");if(this.ApplicationRef.PLAYER().COINS_PLAYABLES(this.GetBet())==false&&this.SlotReference.FREESPIN_IsRunning()==false&&this.ApplicationRef.GAMEPROXY().DEMO_FEATURE_GET()==-1){this.BreakAutoPlay();this.SaveOldBet();this.ApplicationRef.GAMEPROXY().CMD_USER_BET_VALIDATE(this.GetBet());this.SottoStep=ProgramState.ID_SOTTOSTEP_6}else{this.PreparaAvvioPartita();this.Step=ProgramState.STEP_FASE_EXIT}}
;StateSpinSet.prototype.SottoStep_6=function(){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){if(this.ApplicationRef.PROGRAMMA().GetVERSAMENTO_CASSA().ActionPending()==true)this.Step=ProgramState.STEP_FASE_INIT;else this.SottoStep=ProgramState.ID_SOTTOSTEP_5}};StateSpinSet.prototype.SottoStep_7=function(){var dlg;if((dlg=this.PopUp_Refresh())!=DialogBox.DIALOG_EXIT_NONE){this.PopUp_Unmount();if(dlg==DialogBox.DIALOG_EXIT_OK){this.ApplicationRef.GAMEPROXY().CMD_LOGOUT();this.SottoStep++}else this.Step=ProgramState.STEP_FASE_INIT}};StateSpinSet.prototype.SottoStep_8=function(){if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.Step=ProgramState.STEP_FASE_INIT}};StateSpinSet.prototype.IncBet_Enabled=function(){if(this.IsBetOverflow(this.Lines,false)==false)return true;return false};StateSpinSet.prototype.DecBet_Enabled=function(){return this.BetPerLinea>1};StateSpinSet.prototype.IncBet=function(){var temp;if(this.IsBetOverflow(this.Lines,false)==false){this.BetPerLinea++;this.ApplicaIncrementoBet(this.Lines)}};StateSpinSet.prototype.DecBet=function(){if(this.BetPerLinea>1){this.BetPerLinea--;this.ApplicaIncrementoBet(this.Lines)}};StateSpinSet.prototype.IncLines=function(){var temp;if(this.IsBetOverflow(this.BetPerLinea,true)==false){this.Lines++;this.ApplicaIncrementoBet(this.BetPerLinea)}else{temp=this.BetPerLinea;this.ResetBet();this.BetPerLinea=temp;this.ApplicaIncrementoBet(this.Lines)}};StateSpinSet.prototype.DecLines=function(){if(this.Lines>1){this.Lines--;this.ApplicaIncrementoBet(this.BetPerLinea)}};StateSpinSet.prototype.SetMaxBet=function(){var bet_linea;this.BetTarget=window.MAX_TOT_BET;this.LinesTarget=window.NUM_LINEE;bet_linea=window.MAX_BET;while(this.BetTarget>this.ApplicationRef.PLAYER().CREDITI_GET()&&bet_linea>1){this.BetTarget-=window.NUM_LINEE;bet_linea--}this.Lines=this.LinesTarget;this.BetPerLinea=bet_linea;this.ApplicaIncrementoBet(this.BetTarget)};StateSpinSet.prototype.IsBetOverflow=function(p_IncBet,p_Lines){var l_OverflowLines=false;var temp;if(p_Lines==true){if(this.Lines>=window.NUM_LINEE)l_OverflowLines=true}else{if(this.Lines!=0&&l_OverflowLines==false){temp=parseInt(p_IncBet/this.Lines);if(this.BetPerLinea+temp>window.MAX_BET){return true}}}if(this.GetBet()+p_IncBet>window.MAX_TOT_BET||l_OverflowLines){return true}return false};StateSpinSet.prototype.ApplicaIncrementoBet=function(p_Incremento){this.SlotReference.SetPower(this.BetPerLinea,this.Lines)};StateSpinSet.prototype.SaveOldBet=function(){this.OldBet=this.GetBet();this.OldLines=this.Lines};StateSpinSet.prototype.SetOldBet=function(){var l_Temp;if(this.OldBet!=0){l_Temp=this.OldBet;if(this.OldBet>window.MAX_TOT_BET)this.OldBet=window.MAX_TOT_BET;if(this.ApplicationRef.PLAYER().CREDITI_GET()<this.OldBet)this.OldBet=this.ApplicationRef.PLAYER().CREDITI_GET();if(this.OldBet==l_Temp){this.ResetBet();this.Lines=this.OldLines;this.BetPerLinea=this.OldBet/this.OldLines;this.ApplicaIncrementoBet(this.OldBet)}else{this.RicalcolaBet(this.OldBet);return false}}return true};StateSpinSet.prototype.RicalcolaBet=function(p_BetTarget){this.Lines=0;this.BetPerLinea=1;this.BetTarget=p_BetTarget;if(this.OldLines>this.BetTarget)this.LinesTarget=this.BetTarget;else this.LinesTarget=this.OldLines;this.CurrentLine=0};StateSpinSet.prototype.GetBet=function(){return this.Lines*this.BetPerLinea};StateSpinSet.prototype.CheckBreakAutoPlay=function(){if(this.AutoPlay==true){if(this.ApplicationRef.BUTTON_MANAGER().IsPushed(ButtonManager.BUTT_AUTO)==true){this.BreakAutoPlay()}}};StateSpinSet.prototype.IsAutoPlay=function(){return this.AutoPlay};StateSpinSet.prototype.BreakAutoPlay=function(){this.AutoPlay=false;this.SlotReference.Notify_BreakAutoPlay();this.ApplicationRef.PLAYER().AUTO_SPINS_SET(0)};StateSpinSet.prototype.EnableAutoPlay=function(){this.AutoPlay=true;this.SlotReference.Notify_EnableAutoPlay()};StateSpinSet.prototype.PreparaAvvioPartita=function(){if(this.SlotReference.FREESPIN_IsRunning()==false){this.ApplicationRef.PLAYER().COINS_PLAYED(this.GetBet());if(this.ApplicationRef.PLAYER().AUTO_SPINS_GET()!=0){this.EnableAutoPlay();this.ApplicationRef.PLAYER().AUTO_SPINS_DEC()}}this.SlotReference.SetVincitaVideo(0);this.SlotReference.TerminaAnimazioneVincita();this.SaveOldBet();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.SPIN,SoundGenerator.SMP_VOLUME_REDUCE)};StateSpinSet.prototype.SetLinesByClick=function(){var temp;temp=this.BetPerLinea;this.ResetBet();this.BetPerLinea=temp;this.Lines=0;while(this.IsBetOverflow(this.BetPerLinea,true)==false){this.Lines++;this.ApplicaIncrementoBet(this.BetPerLinea);if(this.Lines==this.LinesRequest)break}this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL);this.BetSet=true};StateSpinSet.prototype.NotifyClickOnLine=function(p_Line){this.SlotReference.TerminaAnimazioneVincita();this.ApplicationRef.SOUNDGENERATOR().PlayBrano(SoundGenerator.BET,SoundGenerator.SMP_VOLUME_NORMAL)};StateAlarm.ID_ALARM_NONE=0;StateAlarm.ID_ALARM_SERVER_TIMEOUT=1;StateAlarm.ID_ALARM_SESSION_CLOSED=2;StateAlarm.ID_ALARM_SERVER_PARSER=3;StateAlarm.ID_ALARM_IO_ERROR=4;StateAlarm.ID_ALARM_COMM_ERROR=5;StateAlarm.ID_ALARM_SERVER_CLOSE_COMM=6;StateAlarm.ID_ALARM_CONNECTION_ERROR=8;StateAlarm.ID_ALARM_PARAMETERS=9;StateAlarm.ID_ALARM_SECURITY_FOR_LOCAL=10;StateAlarm.ID_ALARM_TIME_OUT=11;StateAlarm.ID_ALARM_EXIT=12;StateAlarm.ID_ALARM_PORTRAIT=13;StateAlarm.ID_ALARM_FROM_SERVER=14;function StateAlarm(app_reference,slot_ref){ProgramState.call(this,app_reference,slot_ref);this.AlarmID=StateAlarm.ID_ALARM_NONE;this.ExitInvoked=false;this.ServerAlarm_Text=null;this.ServerAlarm_Modal=false;this.LandscapePopup=null}StateAlarm.prototype=Object.create(ProgramState.prototype);StateAlarm.prototype.constructor=StateAlarm;StateAlarm.prototype.Reset=function(){ProgramState.prototype.Reset.call(this);this.AlarmID=StateAlarm.ID_ALARM_NONE};StateAlarm.prototype.StateInit=function(){ProgramState.prototype.StateInit.call(this);this.DEBUG_LOG("Spin set state init")};StateAlarm.prototype.StateBody=function(ellapsed_ms){var alarm_txt="";var modal=0;ProgramState.prototype.StateBody.call(this,ellapsed_ms);if(this.ExitInvoked==true){window.close();return}switch(this.SottoStep){case ProgramState.ID_SOTTOSTEP_0:{if(this.AlarmID!=0){if(this.AlarmID==StateAlarm.ID_ALARM_PORTRAIT){if(this.LandscapePopup==null){this.LandscapePopup=new TiledSprite("LandScapeBox",1,false,this.PopUp.GetContainer(),".webp");this.LandscapePopup.Setup();this.LandscapePopup.CenterBoxOnSprite(this.PopUp.GetShape())}alarm_txt=this.ApplicationRef.GAMEPROXY().GET_DATA().GET_MESSAGES().ON_PORTRAIT_MESSAGE();this.LandscapePopup.Visible(true);modal=DialogBox.DIALOG_MODAL_OK}else{alarm_txt="";if(this.AlarmID==StateAlarm.ID_ALARM_FROM_SERVER){alarm_txt+=this.ServerAlarm_Text;if(this.ServerAlarm_Modal==true)modal=DialogBox.DIALOG_MODAL_OK}else if(this.AlarmID==StateAlarm.ID_ALARM_SESSION_CLOSED){alarm_txt+="Sessione di gioco chiusa.";modal=DialogBox.DIALOG_NOT_MODAL}else{alarm_txt+="Errore di connessione";alarm_txt+=" ( "+this.AlarmID.toString()+" ).";modal=DialogBox.DIALOG_NOT_MODAL}this.ApplicationRef.SOUNDGENERATOR().Stop()}this.PopUp_Render(alarm_txt,modal);if(this.AlarmID==StateAlarm.ID_ALARM_PORTRAIT){this.PopUp.GetTextDisplay().DisplayText.y=380}this.PopUp_Mount();this.SottoStep++}}break;case ProgramState.ID_SOTTOSTEP_1:{if(this.AlarmID==StateAlarm.ID_ALARM_PORTRAIT){if(this.ApplicationRef.IsMobile()==true){if(this.ApplicationRef.IsPortrait()==false||this.PopUp_Refresh()!=DialogBox.DIALOG_EXIT_NONE){this.PopUp_Unmount();this.LandscapePopup.Visible(false);this.SottoStep++}}}else{if(this.PopUp_Refresh()!=DialogBox.DIALOG_EXIT_NONE){this.PopUp_Unmount();this.SottoStep++}}}break;case ProgramState.ID_SOTTOSTEP_2:{if(this.ApplicationRef.GAMEPROXY().IsIdle()==true){this.ApplicationRef.GAMEPROXY().CMD_PLAY_STATUS();this.SottoStep++}}break;case ProgramState.ID_SOTTOSTEP_3:{if(this.ApplicationRef.GAMEPROXY().IsIdle()==true){this.AlarmID=0;this.Step=ProgramState.STEP_FASE_EXIT}}break;default:break}};StateAlarm.prototype.StateExit=function(){ProgramState.prototype.StateExit.call(this)};StateAlarm.prototype.AddAllarme=function(alarm_id){if(this.AlarmID==0){this.AlarmID=alarm_id}};StateAlarm.prototype.AddAllarmeServer=function(txt,modal){this.AlarmID=StateAlarm.ID_ALARM_FROM_SERVER;this.ServerAlarm_Text=txt;this.ServerAlarm_Modal=modal};StateAlarm.prototype.EXIT_INVOKED_SET=function(enb){this.ExitInvoked=enb};StateAlarm.prototype.EXIT_INVOKED_GET=function(){return this.ExitInvoked};StateAlarm.prototype.IsAllarmePendente=function(){return this.AlarmID!=0};StateCashBox.CMD_VERSAMENTO_CASSA=10;StateCashBox.CFG_VERSAMENTO_CASSA=11;StateCashBox.ID_SUB_CASH_CONFIG_FORCE=1;StateCashBox.ID_SUB_CASH_CONFIG_CHOOSE=2;StateCashBox.ID_TYPE_CASH_HALT_CHOOSE=3;StateCashBox.ID_TYPE_CASH_HALT_STOP=4;StateCashBox.CFG_PLAYER_BET=20;function StateCashBox(app_reference,slot_ref){ProgramState.call(this,app_reference,slot_ref);this.Type=0;this.Title="";this.Min=0;this.Max=0;this.CreditoAttuale=0;this.CassaGiocatore=0;this.SetupRequest=false}StateCashBox.prototype=Object.create(ProgramState.prototype);StateCashBox.prototype.constructor=StateCashBox;StateCashBox.prototype.StateInit=function(){ProgramState.prototype.StateInit.call(this);this.SottoStep=ProgramState.ID_SOTTOSTEP_1;this.ApplicationRef.CONSOLE().OnSpinEvent(true);this.ApplicationRef.PROGRAMMA().GetSPIN_SET().Restart();this.SetupRequest=false};StateCashBox.prototype.StateBody=function(ellapsed_ms){var over=false;var exit_dlg=DialogBox.DIALOG_EXIT_NONE;ProgramState.prototype.StateBody.call(this,ellapsed_ms);switch(this.SottoStep){case ProgramState.ID_SOTTOSTEP_0:{}break;case ProgramState.ID_SOTTOSTEP_1:{this.CreditoAttuale=this.ApplicationRef.PLAYER().CREDITI_GET();if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){if(this.CassaConfigurabile()==true){this.ApplicationRef.GAMEPROXY().CMD_PLAY_STATUS()}this.SottoStep++}}break;case ProgramState.ID_SOTTOSTEP_2:{if(this.ApplicationRef.GAMEPROXY().Job_Done()==true){this.Render();this.SottoStep++}}break;case ProgramState.ID_SOTTOSTEP_3:{this.RenderContoGioco();if((exit_dlg=this.PopUp_Refresh())!=DialogBox.DIALOG_EXIT_NONE){over=true}else if(this.Type==StateCashBox.ID_TYPE_CASH_HALT_STOP){if(this.ApplicationRef.PLAYER().COINS_AT_MIN_COINVALUE()>=window.MIN_TOT_BET){over=true}else if(this.ApplicationRef.GAMEPROXY().Job_Done()==true&&this.GPTimer==0){this.ApplicationRef.GAMEPROXY().CMD_PLAY_STATUS();this.GPTimer=this.ArmaTimer(this.GPTimer,1e3)}}else{if(this.CassaConfigurabile()==false){if(this.ApplicationRef.PLAYER().COINS_PLAYABLES(this.ApplicationRef.PROGRAMMA().GetSPIN_SET().GetBet())==true){over=true}else if(this.ApplicationRef.GAMEPROXY().Job_Done()==true&&this.GPTimer==0){this.ApplicationRef.GAMEPROXY().CMD_PLAY_STATUS();this.GPTimer=this.ArmaTimer(this.GPTimer,1e3)}}}}break;default:break}if(over==true){this.PopUp_Unmount();this.Step=ProgramState.STEP_FASE_EXIT}};StateCashBox.prototype.ActionPending=function(){return this.SetupRequest};StateCashBox.prototype.StateExit=function(){ProgramState.prototype.StateExit.call(this);this.ApplicationRef.CONSOLE().OnSpinEvent(false)};StateCashBox.prototype.Parse_Status=function(chunk_to_parse){var esito=false;esito=this.ParseServer_Init(chunk_to_parse);if(esito==true){if(this.ParseServer_SEEK(2)==false)return false;this.Type=this.ParseServer_Dump_UINT(-1);this.Min=this.ParseServer_Dump_UINT(-1);this.Max=this.ParseServer_Dump_UINT(-1);this.Title=this.ParseServer_Dump_STRING(-1);this.SetupRequest=true}return esito};StateCashBox.prototype.Render=function(){var fields=false;if(this.Type==StateCashBox.ID_TYPE_CASH_HALT_STOP)this.PopUp_Render(this.Title,DialogBox.DIALOG_NOT_MODAL);else if(this.Type==StateCashBox.ID_TYPE_CASH_HALT_CHOOSE)this.PopUp_Render(this.Title,DialogBox.DIALOG_MODAL_OK);else if(this.Type==StateCashBox.ID_SUB_CASH_CONFIG_FORCE){this.PopUp_Render(this.Title,DialogBox.DIALOG_MODAL_OK);fields=true}else{fields=true}this.PopUp_Mount()};StateCashBox.prototype.RenderContoGioco=function(){};StateCashBox.prototype.CassaConfigurabile=function(chunk_to_parse){if(this.Type==StateCashBox.ID_SUB_CASH_CONFIG_FORCE||this.Type==StateCashBox.ID_SUB_CASH_CONFIG_CHOOSE)return true;return false};Program.NUM_FASI=5;Program.ID_FASE_ACCENSIONE=0;Program.ID_FASE_GAMEOVER=1;Program.ID_FASE_AVVIO=2;Program.ID_FASE_PARTITA=3;Program.ID_FASE_ALLARMI=4;function Program(app_reference){SObject.call(this);this.ApplicationRef=app_reference;this.MainStage=this.ApplicationRef.MainStage;this.MainRenderer=this.ApplicationRef.Renderer;this.Slot=new Slot(app_reference);this.States=new Array(Program.NUM_FASI);this.States[Program.ID_FASE_ACCENSIONE]=new StateBoot(this.ApplicationRef,this.Slot);this.States[Program.ID_FASE_GAMEOVER]=new StateGameOver(this.ApplicationRef,this.Slot);this.States[Program.ID_FASE_AVVIO]=new StateSpinSet(this.ApplicationRef,this.Slot);this.States[Program.ID_FASE_PARTITA]=new StateSpinRun(this.ApplicationRef,this.Slot);this.States[Program.ID_FASE_ALLARMI]=new StateAlarm(this.ApplicationRef,this.Slot);this.CashBoxState=new StateCashBox(this.ApplicationRef,this.Slot);this.IDFaseCorrente=Program.ID_FASE_ACCENSIONE;this.LandscapeWarning=true;this.SamplesCpuSpeed=0;this.TimeCpuBench=0;this.TimeCpuSpeed=0}Program.prototype=Object.create(SObject.prototype);Program.prototype.constructor=Program;Program.prototype.Init=function(){this.Slot.Init();this.DEBUG_LOG("Program initialized.")};Program.prototype.Reset=function(){for(var i=0;i<this.States.length;i++)this.States[i].Reset();this.CashBoxState.Reset();this.Slot.Reset();this.DEBUG_LOG("Program reset.")};Program.prototype.Recover=function(){this.States[Program.ID_FASE_AVVIO].Recover()};Program.prototype.EvaluateCpuSpeed=function(ellapsed_ms){var old_bench,new_bench,average;if(window.BENCH_ENABLE==true)if(this.SamplesCpuSpeed<100){this.TimeCpuSpeed+=ellapsed_ms;this.SamplesCpuSpeed++}else{average=this.TimeCpuSpeed/100;old_bench=window.CPU_BENCH;new_bench=average/17;window.CPU_BENCH=(old_bench+new_bench)/2;if(window.CPU_BENCH>2)window.CPU_BENCH=2;this.TimeCpuSpeed=0;this.SamplesCpuSpeed=0}};Program.prototype.Run=function(ellapsed_ms){this.EvaluateCpuSpeed(ellapsed_ms);if(this.CashBoxState.ActionPending()==true){if(this.IDFaseCorrente==Program.ID_FASE_AVVIO){this.CashBoxState.Restart()}}if(this.CashBoxState.IsFaseConclusa()==false){this.CashBoxState.Run(ellapsed_ms)}else{this.States[this.IDFaseCorrente].Run(ellapsed_ms);if(this.States[Program.ID_FASE_ALLARMI].IsAllarmePendente()==true&&this.IDFaseCorrente!=Program.ID_FASE_ALLARMI){this.IDFaseCorrente=Program.ID_FASE_ALLARMI;this.States[this.IDFaseCorrente].Restart()}else if(this.States[this.IDFaseCorrente].IsFaseConclusa()){this.SetProssimaFase();this.States[this.IDFaseCorrente].Restart()}}this.Slot.RefreshComponents(ellapsed_ms)};Program.prototype.SetProssimaFase=function(){switch(this.IDFaseCorrente){case Program.ID_FASE_ACCENSIONE:{this.IDFaseCorrente=Program.ID_FASE_GAMEOVER}break;case Program.ID_FASE_GAMEOVER:{this.IDFaseCorrente=Program.ID_FASE_AVVIO}break;case Program.ID_FASE_AVVIO:{this.IDFaseCorrente=Program.ID_FASE_PARTITA}break;case Program.ID_FASE_PARTITA:{this.IDFaseCorrente=Program.ID_FASE_AVVIO}break;case Program.ID_FASE_ALLARMI:{this.IDFaseCorrente=Program.ID_FASE_AVVIO}break;default:{}break}};Program.prototype.SLOT=function(){return this.Slot};Program.prototype.GetFaseCorrente=function(){return this.IDFaseCorrente};Program.prototype.GetSPIN_SET=function(){return this.States[Program.ID_FASE_AVVIO]};Program.prototype.GetALLARMI=function(){return this.States[Program.ID_FASE_ALLARMI]};Program.prototype.GetVERSAMENTO_CASSA=function(){return this.CashBoxState};Program.prototype.Parse_SERVER_LOGOUT=function(){return true};Program.prototype.CheckLandScapeMode=function(){if(this.IDFaseCorrente==Program.ID_FASE_AVVIO&&this.LandscapeWarning==true){if(this.ApplicationRef.IsMobile()==true){if(this.ApplicationRef.IsPortrait()==true){this.GetALLARMI().AddAllarme(StateAlarm.ID_ALARM_PORTRAIT);this.LandscapeWarning=false}}}};var g_noSleepLib=null;function Application(){var ww=1920;var hh=1080;this.Caratterizzazione(ww,hh);if(window.LOCAL_SIGNATURE==false){var query=window.location.search.substring(1);window.SIGNATURE=this.ParseURL(query)}this.ParseSIGNATURE();PIXI.utils.skipHello();this.MainStage=new PIXI.Container;this.Renderer=PIXI.autoDetectRenderer(ww,hh,{transparent:true});this.Renderer.view.style.display="block";window.Renderer=this.Renderer;document.getElementById("container").appendChild(this.Renderer.view);this.GameProxy=null;this.SoundGenerator=null;this.Player=null;this.Program=null;this.ButtonManager=null;this.Console=null;this.m_Loader=new PIXI.loaders.Loader;this.Preloader_Mount();this.Resize();window.onresize=this.Resize.bind(this);window.MOBILE=this.IsMobile();window.IOS=this.IsIOS();window.addEventListener("deviceorientation",FuncHandleOrientation,true);this.lasttime=(new Date).getTime();requestAnimationFrame(this.Refresh.bind(this));this.Setup();this.Resize()}Application.prototype=Object.create(PIXI.Container.prototype);Application.prototype.Caratterizzazione=function(ww,hh){window.CONNECT2SERVER=true;window.LOCAL_SIGNATURE=true;window.SIGNATURE=null;window.SIGNATURE_ENCRYPTION=false;window.SERVER_URL=null;window.SERVER_PORT=0;window.TOKEN=null;window.ENCRYPTION=false;window.LOCAL_TEST=true;window.DEMO_PLAY=true;window.PLAY_FOR_COINS=false;window.MOBILE=false;window.LANG=1;window.POWER_SAVE=1;window.VIDEO_WIDTH=ww;window.VIDEO_HEIGHT=hh;window.VIDEO_RATIO=window.VIDEO_WIDTH/window.VIDEO_HEIGHT;window.LARGHEZZA_SIMBOLO=260;window.ALTEZZA_SIMBOLO=260;window.NUM_LINEE=15;window.NUM_SIMBOLI=14;window.NUM_RULLI=15;window.NUM_REELS=5;window.NUM_SIMBOLI_RUOTA=3;window.PATTERN_SIMBOLI=window.NUM_RULLI;window.NUM_COMBINAZIONI_SLOT=57;window.SLICE_COMBINAZIONI_SLOT=13;window.COMBINAZIONI_SCATTER=true;window.MIN_BET=1;window.MAX_BET=10;window.PAY_BET=1;window.MAX_TOT_BET=window.MAX_BET*window.NUM_LINEE*window.PAY_BET;window.MIN_TOT_BET=window.MIN_BET*window.NUM_LINEE*window.PAY_BET;window.DEFAULT_LINES=window.NUM_LINEE;window.FULL_SCREEN=false;window.FULL_SCREEN_DONE=false;window.SCREEN_TIPPED=false;window.CPU_BENCH=1;window.BENCH_ENABLE=false;window.ID_DUMMY=0;window.ID_SIMBOLO_0=1;window.ID_SIMBOLO_1=2;window.ID_SIMBOLO_2=3;window.ID_SIMBOLO_3=4;window.ID_SIMBOLO_4=5;window.ID_SIMBOLO_5=6;window.ID_SIMBOLO_6=7;window.ID_SIMBOLO_7=8;window.ID_SIMBOLO_8=9;window.ID_SIMBOLO_9=10;window.ID_SIMBOLO_10=11;window.ID_SIMBOLO_11=12;window.ID_SIMBOLO_12=13;window.ID_SIMBOLO_JOLLY=window.ID_SIMBOLO_10;window.ID_SIMBOLO_SCATTER=window.ID_SIMBOLO_11;window.ID_SIMBOLO_BONUS=window.ID_SIMBOLO_12;window.ID_SIMBOLO_MICROFONO=window.ID_SIMBOLO_BONUS+1;window.ID_SIMBOLO_SUPER=window.ID_SIMBOLO_14;window.REEL_ROW_0=100;window.REEL_ROW_1=window.REEL_ROW_0+260;window.REEL_ROW_2=window.REEL_ROW_1+260;window.REEL_COL_0=235;window.REEL_COL_1=window.REEL_COL_0+1*297;window.REEL_COL_2=window.REEL_COL_0+2*297;window.REEL_COL_3=window.REEL_COL_0+3*297;window.REEL_COL_4=window.REEL_COL_0+4*297;window.REELS_TAB_X=[window.REEL_COL_0,window.REEL_COL_1,window.REEL_COL_2,window.REEL_COL_3,window.REEL_COL_4];window.REELS_TAB_Y=[window.REEL_ROW_0,window.REEL_ROW_1,window.REEL_ROW_2]};Application.prototype.Setup=function(){this.GameProxy=new GameProxy(this);this.m_Loader.on("load",this.onLoadCallback.bind(this));this.m_Loader.on("progress",this.onProgressCallback.bind(this));this.m_Loader.on("error",this.onErrorCallback.bind(this));this.m_Loader.once("complete",this.OnResourcesLoaded.bind(this));this.m_Loader.add("TEX_Stage","resources/Stage/Stage.json");this.m_Loader.add("TEX_StageFS","resources/Stage/StageFS.json");this.m_Loader.add("TEX_Reels","resources/Stage/Reels.json");this.m_Loader.add("TEX_Frame","resources/Stage/Frame.json");this.m_Loader.add("TEX_Symbols","resources/Symbols/Symbols.json");this.m_Loader.add("TEX_SymbolsMagic","resources/SymbolsMagic/SymbolsMagic.json");this.m_Loader.add("TEX_Console","resources/Console/Console.json");this.m_Loader.add("TEX_WinUp","resources/BigWin/WinUp.json");this.m_Loader.add("TEX_Rays","resources/BigWin/Rays.json");this.m_Loader.add("TEX_Help0","resources/Help/Help-0.json");this.m_Loader.add("TEX_Help1","resources/Help/Help-1.json");this.m_Loader.add("TEX_AniSym00","resources/SymbolsAnimation/AniSym00.json");this.m_Loader.add("TEX_AniSym01","resources/SymbolsAnimation/AniSym01.json");this.m_Loader.add("TEX_AniSym02","resources/SymbolsAnimation/AniSym02.json");this.m_Loader.add("TEX_AniSym03","resources/SymbolsAnimation/AniSym03.json");this.m_Loader.add("TEX_AniSym04","resources/SymbolsAnimation/AniSym04.json");this.m_Loader.add("TEX_AniSym05","resources/SymbolsAnimation/AniSym05.json");this.m_Loader.add("TEX_AniSym06","resources/SymbolsAnimation/AniSym06.json");this.m_Loader.add("TEX_AniSym07","resources/SymbolsAnimation/AniSym07.json");this.m_Loader.add("TEX_AniSym08","resources/SymbolsAnimation/AniSym08.json");this.m_Loader.add("TEX_AniSym09","resources/SymbolsAnimation/AniSym09.json");this.m_Loader.add("TEX_AniSym10","resources/SymbolsAnimation/AniSym10.json");this.m_Loader.add("TEX_AniSym11","resources/SymbolsAnimation/AniSym11.json");this.m_Loader.add("TEX_AniSym12","resources/SymbolsAnimation/AniSym12.json");this.m_Loader.add("TEX_AniSym13","resources/SymbolsAnimation/AniSym13.json");this.m_Loader.add("TEX_AniSym14","resources/SymbolsAnimation/AniSym14.json");this.m_Loader.add("TEX_AniFrames","resources/SymbolsAnimation/WinAnimation.json");this.m_Loader.add("TEX_GameFonts","resources/Fonts/GameFonts.json");this.m_Loader.add("TEX_LinesA","resources/Lines/WinLinesA.json");this.m_Loader.add("TEX_LinesB","resources/Lines/WinLinesB.json");this.m_Loader.add("TEX_ReelTurbo","resources/Turbo/Turbo.json");this.m_Loader.add("TEX_LongWild0","resources/LongWild/LongWild-0.json");this.m_Loader.add("TEX_LongWild1","resources/LongWild/LongWild-1.json");this.m_Loader.add("TEX_LongWild2","resources/LongWild/LongWild-2.json");this.m_Loader.add("TEX_Effects","resources/Effects/Effects.json");this.m_Loader.add("TEX_Explosion","resources/Explosion/StarExplosion.json");this.m_Loader.add("PRT_Snow","resources/Effects/Snow.json");this.m_Loader.load()};Application.prototype.loadProgress=function(loader,res){};Application.prototype.OnResourcesLoaded=function(loader){g_noSleepLib=new NoSleep;this.ControlBuilder=new ControlBuilder(this);this.ButtonManager=new ButtonManager;this.SoundGenerator=new SoundGenerator;this.Player=new Player(this);this.Console=new ConsoleContainer(this.MainStage,this);this.Program=new Program(this);this.Reset();this.GameProxy.Init();this.Program.Init();this.Console.Init();this.SoundGenerator.Init();this.Recover();this.Console.Enable();this.GameProxy.NOTIFY_LOADED_EVENT();this.BUTTON_MANAGER().NotifyStymulus(ButtonManager.BUTT_SOUND)};Application.prototype.onLoadCallback=function(loader){};Application.prototype.onProgressCallback=function(loader){var progress=loader.progress;this.PreloaderBar.scale.x=progress/100};Application.prototype.onErrorCallback=function(loader){console.log("Error loading resource")};Application.prototype.Preloader_Mount=function(){this.PreloaderTitle=PIXI.Sprite.fromImage("resources/LoadingTitle.webp");this.PreloaderTitle.x=0;this.PreloaderTitle.y=0;this.PreloaderTitle.x=window.VIDEO_WIDTH/2;this.PreloaderTitle.y=window.VIDEO_HEIGHT/2;this.PreloaderTitle.anchor.set(.5);this.MainStage.addChild(this.PreloaderTitle);this.PreloaderMark=PIXI.Sprite.fromImage("resources/LoadingLogo.webp");this.PreloaderMark.x=0;this.PreloaderMark.y=850;this.MainStage.addChild(this.PreloaderMark);this.PreloaderBarBackground=PIXI.Sprite.fromImage("resources/LoadingBarBackground.webp");this.PreloaderBarBackground.x=window.VIDEO_WIDTH/2-506/2;this.PreloaderBarBackground.y=900;this.MainStage.addChild(this.PreloaderBarBackground);this.PreloaderBar=PIXI.Sprite.fromImage("resources/LoadingBar.webp");this.PreloaderBar.x=window.VIDEO_WIDTH/2-506/2+30;this.PreloaderBar.y=900;this.PreloaderBar.scale=new PIXI.Point(.01,1);this.MainStage.addChild(this.PreloaderBar);this.PreloaderBarForeground=PIXI.Sprite.fromImage("resources/LoadingBarForeground.webp");this.PreloaderBarForeground.x=window.VIDEO_WIDTH/2-506/2;this.PreloaderBarForeground.y=900;this.MainStage.addChild(this.PreloaderBarForeground)};Application.prototype.Preloader_Unmount=function(){this.MainStage.removeChild(this.PreloaderMark);this.MainStage.removeChild(this.PreloaderTitle);this.MainStage.removeChild(this.PreloaderBar)};Application.prototype.Refresh=function(){var currtime=(new Date).getTime();var delta=currtime-this.lasttime;if(this.GameProxy!=null)this.GameProxy.Refresh(delta);if(this.Program!=null)this.Program.Run(delta);if(this.Console!=null)this.Console.Refresh(delta);this.Renderer.render(this.MainStage);requestAnimationFrame(this.Refresh.bind(this));this.lasttime=currtime};Application.prototype.Reset=function(){this.Program.Reset();this.Player.Reset();this.GameProxy.Reset()};Application.prototype.Recover=function(){this.Program.Recover()};Application.prototype.TEXTURE_DB=function(){return this.m_Loader.resources};Application.prototype.BUTTON_MANAGER=function(){return this.ButtonManager};Application.prototype.SLOT=function(){return this.Program.SLOT()};Application.prototype.PLAYER=function(){return this.Player};Application.prototype.SOUNDGENERATOR=function(){return this.SoundGenerator};Application.prototype.PROGRAMMA=function(){return this.Program};Application.prototype.GAMEPROXY=function(){return this.GameProxy};Application.prototype.CONTROL_BUILDER=function(){return this.ControlBuilder};Application.prototype.CONSOLE=function(){return this.Console};Application.prototype.CONTAINER=function(){return this.MainStage};Application.prototype.NO_SLEEP_LIB=function(){return this.noSleepLib};Application.prototype.LOADER=function(){return this.m_Loader};Application.prototype.Resize=function(event){var gameArea=document.getElementById("container");var newWidth=window.innerWidth;var newHeight=window.innerHeight;var newWidthToHeight=newWidth/newHeight;if(newWidthToHeight>window.VIDEO_RATIO){newWidth=newHeight*window.VIDEO_RATIO;this.Renderer.view.style.width=newWidth+"px";this.Renderer.view.style.height=newHeight+"px"}else{newHeight=newWidth/window.VIDEO_RATIO;this.Renderer.view.style.width=newWidth+"px";this.Renderer.view.style.height=newHeight+"px"}if(this.Console!=null)this.Console.OnResize()};function FuncResize(){var gameArea=document.getElementById("container");var newWidth=window.innerWidth;var newHeight=window.innerHeight;var newWidthToHeight=newWidth/newHeight;if(newWidthToHeight>window.VIDEO_RATIO){newWidth=newHeight*window.VIDEO_RATIO;window.Renderer.view.style.width=newWidth+"px";window.Renderer.view.style.height=newHeight+"px"}else{newHeight=newWidth/window.VIDEO_RATIO;window.Renderer.view.style.width=newWidth+"px";window.Renderer.view.style.height=newHeight+"px"}}function FuncHandleOrientation(){FuncResize()}function IsFullScreen(){var doc=window.document;var docEl=doc.documentElement;if(!doc.fullscreenElement&&!doc.mozFullScreenElement&&!doc.webkitFullscreenElement&&!doc.msFullscreenElement)return false;return true}function ToggleFullScreen(){var doc=window.document;var docEl=doc.documentElement;window.SCREEN_TIPPED=true;if(IsFullScreen()==false){window.FULL_SCREEN=true;window.FULL_SCREEN_DONE=true;var requestFullScreen=docEl.requestFullscreen||docEl.mozRequestFullScreen||docEl.webkitRequestFullScreen||docEl.msRequestFullscreen;if(requestFullScreen!=null)requestFullScreen.call(docEl)}else{window.FULL_SCREEN=false;var cancelFullScreen=doc.exitFullscreen||doc.mozCancelFullScreen||doc.webkitExitFullscreen||doc.msExitFullscreen;if(cancelFullScreen!=null)cancelFullScreen.call(doc)}FuncResize()}function ToggleNoSleep(){window.POWER_SAVE^=1;if(window.POWER_SAVE==0)g_noSleepLib.enable();else g_noSleepLib.disable()}Application.prototype.IsMobile=function(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){return true}else{return false}};Application.prototype.IsIOS=function(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/g)!=null};Application.prototype.IsPortrait=function(){if(window.matchMedia("(orientation: portrait)").matches){return true}return false};Application.prototype.ParseURL=function(query){var vars=query.split("&");var query_string={};for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");var key=decodeURIComponent(pair[0]);var value=decodeURIComponent(pair[1]);if(typeof query_string[key]==="undefined"){query_string[key]=decodeURIComponent(value)}else if(typeof query_string[key]==="string"){var arr=[query_string[key],decodeURIComponent(value)];query_string[key]=arr}else{query_string[key].push(decodeURIComponent(value))}}return query_string};Application.prototype.ParseSIGNATURE=function(){if(window.LOCAL_SIGNATURE==true)window.SIGNATURE=signature;DES_DecryptSignature(window.SIGNATURE);window.TOKEN=DES_Signature_SESSION;window.SERVER_PORT=parseInt(DES_Signature_PORT);window.SERVER_URL=DES_Signature_IP};application=new Application;